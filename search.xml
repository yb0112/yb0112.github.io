<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>HybridApp</title>
    <url>/posts/449b5459.html</url>
    <content><![CDATA[<p>ä¸ºäº†å¼€å‘Hybrid Appï¼Œåœ¨vueé¡¹ç›®ä¸­é€šè¿‡å¯¹WebViewJavaScriptBridgeç¬¬ä¸‰æ–¹åº“çš„å°è£…ï¼Œåˆ›å»ºä¸€ä¸ªæ¡¥æ¢ï¼Œå®ç°H5å’Œandroidã€iosçš„é€šä¿¡ã€‚ä¹Ÿå¯ä»¥å»githubæŸ¥çœ‹è¯¦ç»†çš„ä»‹ç»<a href="https://github.com/marcuswestin/WebViewJavascriptBridge">WebViewJavascriptBridge</a></p>
<span id="more"></span>
<h3 id="æ–°å»ºå°è£…æ–‡ä»¶"><a href="#æ–°å»ºå°è£…æ–‡ä»¶" class="headerlink" title="æ–°å»ºå°è£…æ–‡ä»¶"></a>æ–°å»ºå°è£…æ–‡ä»¶</h3><p>åˆ›å»º<code>src/utils/jsBridge.js</code>æ–‡ä»¶ï¼Œç”¨äºå°è£…<code>WebViewJavascriptBridge</code></p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title class_">App</span> = &#123;&#125;</span><br><span class="line"><span class="comment">// è®¡æ•°</span></span><br><span class="line"><span class="keyword">let</span> failNum = <span class="number">0</span>; </span><br><span class="line"></span><br><span class="line"><span class="comment">// è·å–å‹å·</span></span><br><span class="line"><span class="title class_">App</span>.<span class="property">userAgent</span> = navigator.<span class="property">userAgent</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// æ˜¯å¦åœ¨android APPä¸­è¿è¡Œ</span></span><br><span class="line"><span class="title class_">App</span>.<span class="property">isAndroidApp</span> = <span class="regexp">/application_ccicAndroid/i</span>.<span class="title function_">test</span>(<span class="title class_">App</span>.<span class="property">userAgent</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ˜¯å¦åœ¨iPhone APPä¸­è¿è¡Œ</span></span><br><span class="line"><span class="title class_">App</span>.<span class="property">isiPhoneApp</span> = <span class="regexp">/application_ccicIos/i</span>.<span class="title function_">test</span>(<span class="title class_">App</span>.<span class="property">userAgent</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// è¿™é‡Œä¸»è¦æ˜¯æ³¨å†Œ OC å°†è¦è°ƒç”¨çš„ JS æ–¹æ³•ã€‚</span></span><br><span class="line"><span class="title class_">App</span>.<span class="property">setupWebViewJavascriptBridge</span> = <span class="keyword">function</span>(<span class="params">callback</span>) &#123;</span><br><span class="line">    <span class="comment">// æ‰§è¡Œç›‘å¬ &amp;&amp; æ£€æµ‹ JSBridgeéœ€è¦ä¸€ä¸ªå¥‘æœºå»å‘Šè¯‰JSï¼Œæˆ‘å‡†å¤‡å¥½äº†ï¼Œä½ å¯ä»¥æ¥è°ƒç”¨æˆ‘çš„æ–¹æ³•äº†</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="variable language_">window</span>.<span class="property">WebViewJavascriptBridge</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="title function_">callback</span>(<span class="title class_">WebViewJavascriptBridge</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="variable language_">document</span>.<span class="title function_">addEventListener</span>(<span class="string">&#x27;WebViewJavascriptBridgeReady&#x27;</span>,<span class="keyword">function</span>(<span class="params"></span>) &#123; <span class="title function_">callback</span>(<span class="title class_">WebViewJavascriptBridge</span>);&#125;,<span class="literal">false</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable language_">window</span>.<span class="property">WebViewJavascriptBridge</span>) &#123; <span class="keyword">return</span> <span class="title function_">callback</span>(<span class="title class_">WebViewJavascriptBridge</span>); &#125;</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable language_">window</span>.<span class="property">WVJBCallbacks</span>) &#123; <span class="keyword">return</span> <span class="variable language_">window</span>.<span class="property">WVJBCallbacks</span>.<span class="title function_">push</span>(callback); &#125;</span><br><span class="line">    <span class="variable language_">window</span>.<span class="property">WVJBCallbacks</span> = [callback]; <span class="comment">// åˆ›å»ºä¸€ä¸ª WVJBCallbacks å…¨å±€å±æ€§æ•°ç»„ï¼Œå¹¶å°† callback æ’å…¥åˆ°æ•°ç»„ä¸­ã€‚</span></span><br><span class="line">    <span class="keyword">var</span> <span class="title class_">WVJBIframe</span> = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&#x27;iframe&#x27;</span>); <span class="comment">// åˆ›å»ºä¸€ä¸ª iframe å…ƒç´ </span></span><br><span class="line">    <span class="title class_">WVJBIframe</span>.<span class="property">style</span>.<span class="property">display</span> = <span class="string">&#x27;none&#x27;</span>; <span class="comment">// ä¸æ˜¾ç¤º</span></span><br><span class="line">    <span class="title class_">WVJBIframe</span>.<span class="property">src</span> = <span class="string">&#x27;wvjbscheme://__BRIDGE_LOADED__&#x27;</span>; <span class="comment">// è®¾ç½® iframe çš„ src å±æ€§</span></span><br><span class="line">    <span class="variable language_">document</span>.<span class="property">documentElement</span>.<span class="title function_">appendChild</span>(<span class="title class_">WVJBIframe</span>); <span class="comment">// æŠŠ iframe æ·»åŠ åˆ°å½“å‰æ–‡å¯¼èˆªä¸Šã€‚</span></span><br><span class="line">    <span class="built_in">setTimeout</span>(<span class="keyword">function</span>(<span class="params"></span>) &#123; <span class="variable language_">document</span>.<span class="property">documentElement</span>.<span class="title function_">removeChild</span>(<span class="title class_">WVJBIframe</span>) &#125;, <span class="number">0</span>)</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä¸åŸç”Ÿäº¤äº’æ–¹æ³•</span></span><br><span class="line"><span class="title class_">App</span>.<span class="property">callNative</span> = <span class="keyword">function</span>(<span class="params">data</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="title class_">App</span>.<span class="property">isiPhoneApp</span>) &#123;</span><br><span class="line">        <span class="title class_">App</span>.<span class="title function_">setupWebViewJavascriptBridge</span>(<span class="keyword">function</span>(<span class="params">bridge</span>) &#123;</span><br><span class="line">        <span class="comment">/* </span></span><br><span class="line"><span class="comment">        * å°è£… JS è°ƒç”¨äº† OC çš„æ–¹æ³•</span></span><br><span class="line"><span class="comment">        * data.fun  æ˜¯ä¼ é€’ç»™ OC çš„æ–¹æ³•å</span></span><br><span class="line"><span class="comment">        * data.data æ˜¯ä¼ é€’ç»™ OC çš„æ•°æ®</span></span><br><span class="line"><span class="comment">        * function  æ˜¯ JS è°ƒç”¨å®Œæ¯•ä¹‹åOCçš„å›è°ƒ</span></span><br><span class="line"><span class="comment">        * responseData æ˜¯ OC ä¼ é€’è¿‡æ¥çš„æ•°æ®.</span></span><br><span class="line"><span class="comment">        */</span></span><br><span class="line">       <span class="comment">// jsbridge.callHandleræ˜¯JSè°ƒNativeæ–¹æ³•çš„æ ¸å¿ƒ</span></span><br><span class="line">        bridge.<span class="title function_">callHandler</span>(data.<span class="property">fun</span>, data.<span class="property">data</span>, <span class="keyword">function</span> <span class="title function_">responseCallback</span>(<span class="params">responseData</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span> (<span class="keyword">typeof</span> data.<span class="property">callback</span> === <span class="string">&#x27;function&#x27;</span>) &#123; </span><br><span class="line">                data.<span class="title function_">callback</span>(responseData);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="title class_">App</span>.<span class="property">isAndroidApp</span>) &#123;</span><br><span class="line">    <span class="comment">/* </span></span><br><span class="line"><span class="comment">    *andoridä»è€ç³»ç»Ÿè¿”å›æ—¶å¶å°”æŠ¥é”™callHandlerä¸æ˜¯ä¸€ä¸ªfunctionï¼Œ</span></span><br><span class="line"><span class="comment">    *åº”è¯¥æ˜¯è¿˜æœªæ³¨å…¥åˆ°webviewï¼Œä½¿ç”¨setTimeoutåå¤è°ƒç”¨</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    <span class="keyword">if</span> ((!<span class="variable language_">window</span>.<span class="property">WebViewJavascriptBridge</span>) || (!<span class="variable language_">window</span>.<span class="property">WebViewJavascriptBridge</span>.<span class="property">callHandler</span>)) &#123;</span><br><span class="line">      failNum++;</span><br><span class="line">      <span class="keyword">if</span> (failNum &gt; <span class="number">50</span>) &#123;<span class="keyword">return</span>;&#125; <span class="comment">// è®¾ç½®å¤±è´¥è¶…è¿‡50æ¬¡ååœæ­¢</span></span><br><span class="line">      <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;<span class="title class_">App</span>.<span class="title function_">callNative</span>(data);&#125;, <span class="number">300</span>) </span><br><span class="line">      <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">    * å°è£… JS è°ƒç”¨äº†å®‰å“æ–¹æ³•</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    <span class="variable language_">window</span>.<span class="property">WebViewJavascriptBridge</span>.<span class="title function_">callHandler</span>(data.<span class="property">fun</span>, data.<span class="property">data</span>, <span class="keyword">function</span>(<span class="params">res</span>) &#123;</span><br><span class="line">      <span class="keyword">let</span> responseDataJson = &#123;&#125;;</span><br><span class="line">      <span class="keyword">if</span> (res) &#123;responseDataJson = <span class="title class_">JSON</span>.<span class="title function_">parse</span>(res);&#125;</span><br><span class="line">      <span class="keyword">if</span> (<span class="keyword">typeof</span> data.<span class="property">callback</span> === <span class="string">&#x27;function&#x27;</span>) &#123;data.<span class="title function_">callback</span>(responseDataJson);&#125;</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="title class_">App</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="è°ƒå–AppåŸç”Ÿæ–¹æ³•"><a href="#è°ƒå–AppåŸç”Ÿæ–¹æ³•" class="headerlink" title="è°ƒå–AppåŸç”Ÿæ–¹æ³•"></a>è°ƒå–AppåŸç”Ÿæ–¹æ³•</h3><p>åœ¨<code>jsBridge.js</code>ä¸­å°è£…è®¾ç½®è°ƒå–åŸç”Ÿçš„æ–¹æ³•ï¼Œä¸‹é¢çš„<code>funæ–¹æ³•å</code>æ˜¯éœ€è¦è·ŸåŸç”Ÿå°ä¼™ä¼´å•†é‡ç¡®å®šçš„ï¼Œè¿™é‡Œå°è£…çš„<code>app.æ–¹æ³•å</code>ä¹ æƒ¯æ€§çš„å’Œè°ƒå–åŸç”Ÿçš„æ–¹æ³•åä¸€è‡´ï¼Œæ–¹ä¾¿ç®¡ç†ã€‚</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line">app.<span class="keyword">fun</span>æ–¹æ³•å = function(req)&#123;</span><br><span class="line">  app.callNative(&#123;</span><br><span class="line">    <span class="function"><span class="keyword">fun</span>: &#x27;<span class="keyword">fun</span>æ–¹æ³•å&#x27;,</span></span><br><span class="line">    <span class="keyword">data</span>: &#123;</span><br><span class="line">      å‚æ•°<span class="number">1</span>: req.aaa,</span><br><span class="line">    &#125;,</span><br><span class="line">    callback: req.<span class="keyword">fun</span></span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="é¡¹ç›®ä¸­ä½¿ç”¨"><a href="#é¡¹ç›®ä¸­ä½¿ç”¨" class="headerlink" title="é¡¹ç›®ä¸­ä½¿ç”¨"></a>é¡¹ç›®ä¸­ä½¿ç”¨</h3><p>åœ¨vueé¡¹ç›®ä¸­ä½¿ç”¨ï¼Œåœ¨<code>main.js</code>ä¸­å¼•å…¥å°è£…çš„<code>jsBridge.js</code></p>
<figure class="highlight routeros"><table><tr><td class="code"><pre><span class="line">import<span class="built_in"> bridge </span><span class="keyword">from</span> <span class="string">&#x27;/utils/jsBridge&#x27;</span>;</span><br><span class="line">Vue.prototype.<span class="variable">$bridge</span> =<span class="built_in"> bridge; </span></span><br></pre></td></tr></table></figure>
<h3 id="jsè°ƒåŸç”Ÿä½¿ç”¨"><a href="#jsè°ƒåŸç”Ÿä½¿ç”¨" class="headerlink" title="jsè°ƒåŸç”Ÿä½¿ç”¨"></a>jsè°ƒåŸç”Ÿä½¿ç”¨</h3><figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line">let <span class="keyword">data</span> = &#123;</span><br><span class="line">  aaa:<span class="string">&#x27;&#x27;</span>,</span><br><span class="line">  bbb:<span class="string">&#x27;&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">this</span>.$bridge.<span class="keyword">fun</span>æ–¹æ³•å( <span class="keyword">data</span> )</span><br></pre></td></tr></table></figure>
<h3 id="OCä¸»åŠ¨è°ƒç”¨-JS-çš„æ–¹æ³•"><a href="#OCä¸»åŠ¨è°ƒç”¨-JS-çš„æ–¹æ³•" class="headerlink" title="OCä¸»åŠ¨è°ƒç”¨ JS çš„æ–¹æ³•"></a>OCä¸»åŠ¨è°ƒç”¨ JS çš„æ–¹æ³•</h3><figure class="highlight reasonml"><table><tr><td class="code"><pre><span class="line"><span class="comment">//å£°æ˜ OC éœ€è¦ä¸»åŠ¨è°ƒç”¨ JS çš„æ–¹æ³•</span></span><br><span class="line">app.setup<span class="constructor">WebViewJavascriptBridge(<span class="params">function</span>(<span class="params">bridge</span>)</span> &#123;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">* testFunï¼š æ˜¯æ³¨å…¥åˆ°æ¡¥æ¢ä¸­ JS å‡½æ•°çš„åˆ«åã€‚ä»¥ä¾› OC ç«¯è°ƒç”¨ã€‚</span></span><br><span class="line"><span class="comment">* dataï¼š    OC ç«¯ä¼ é€’è¿‡æ¥çš„æ•°æ®ã€‚</span></span><br><span class="line"><span class="comment">* responseCallbackï¼šJS è°ƒç”¨åœ¨è¢« OC è°ƒç”¨å®Œæ¯•ä¹‹åï¼Œå‘ OC ç«¯ä¼ é€’çš„æ•°æ®çš„ä¸€ä¸ªå›è°ƒã€‚</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line">    bridge.register<span class="constructor">Handler(&#x27;<span class="params">testFun</span> &#x27;, <span class="params">function</span>(<span class="params">data</span>,<span class="params">responseCallback</span>)</span>&#123;</span><br><span class="line">        testFun (data)  <span class="comment">// æ­¤å¤„ç”¨çš„æ–¹æ³•åå’Œæ¡¥æ¢ä¸­æ³¨å†Œçš„æ–¹æ³•åä¸€è‡´ï¼Œä¸ªäººä¹ æƒ¯ï¼Œä¹Ÿæ–¹ä¾¿ç®¡ç†</span></span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// å®˜æ–¹ç»™å‡ºä¸‹é¢ä¸¤ç§è°ƒç”¨æ–¹å¼ï¼Œå¯ä»¥æ ¹æ®è‡ªå·±é¡¹ç›®æƒ…å†µæ¥é€‰æ‹©åˆé€‚çš„æ–¹æ³•ï¼š</span></span><br><span class="line">bridge.register<span class="constructor">Handler(<span class="string">&quot;showAlert&quot;</span>, <span class="params">function</span>(<span class="params">data</span>)</span> &#123; alert(data) &#125;)</span><br><span class="line">bridge.register<span class="constructor">Handler(<span class="string">&quot;getCurrentPageUrl&quot;</span>, <span class="params">function</span>(<span class="params">data</span>, <span class="params">responseCallback</span>)</span> &#123;</span><br><span class="line">    response<span class="constructor">Callback(<span class="params">document</span>.<span class="params">location</span>.<span class="params">toString</span>()</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>å®Œæˆä¸Šé¢æ“ä½œåï¼Œå°±å®Œæˆäº† <code>h5</code> å’Œ <code>App</code> ä¹‹é—´æ¡¥æ¢æ‰“é€šæ“ä½œï¼Œåé¢åªéœ€è¦è·Ÿ<code>åŸç”Ÿ</code>å•†é‡æ–¹æ³•åå³å¯ã€‚</p>
]]></content>
      <categories>
        <category>webå‰ç«¯</category>
      </categories>
      <tags>
        <tag>HybridApp</tag>
      </tags>
  </entry>
  <entry>
    <title>Nextä¸»é¢˜ç¾åŒ–</title>
    <url>/posts/c2d19cb2.html</url>
    <content><![CDATA[<h3 id="å½©è‰²æ ‡ç­¾é¡µ"><a href="#å½©è‰²æ ‡ç­¾é¡µ" class="headerlink" title="å½©è‰²æ ‡ç­¾é¡µ"></a>å½©è‰²æ ‡ç­¾é¡µ</h3><h4 id="æ–°å»ºä¸ªæ€§æ–‡ä»¶"><a href="#æ–°å»ºä¸ªæ€§æ–‡ä»¶" class="headerlink" title="æ–°å»ºä¸ªæ€§æ–‡ä»¶"></a>æ–°å»ºä¸ªæ€§æ–‡ä»¶</h4><p>åœ¨ <code>themes/next/layout</code>æ–‡ä»¶å¤¹ä¸‹ï¼Œæ–°å»º<code>tag-color.swig</code>æ–‡ä»¶</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;text/javascript&quot;</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">     <span class="keyword">var</span> alltags = <span class="variable language_">document</span>.<span class="title function_">getElementsByClassName</span>(<span class="string">&#x27;tag-cloud-tags&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript">     <span class="keyword">var</span> tags = alltags[<span class="number">0</span>].<span class="title function_">getElementsByTagName</span>(<span class="string">&#x27;a&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript">     <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;11111111111111&quot;</span>)</span></span><br><span class="line"><span class="language-javascript">     <span class="keyword">for</span> (<span class="keyword">var</span> i = tags.<span class="property">length</span> - <span class="number">1</span>; i &gt;= <span class="number">0</span>; i--) &#123;</span></span><br><span class="line"><span class="language-javascript">       <span class="keyword">var</span> r=<span class="title class_">Math</span>.<span class="title function_">floor</span>(<span class="title class_">Math</span>.<span class="title function_">random</span>()*<span class="number">75</span>+<span class="number">130</span>);</span></span><br><span class="line"><span class="language-javascript">       <span class="keyword">var</span> g=<span class="title class_">Math</span>.<span class="title function_">floor</span>(<span class="title class_">Math</span>.<span class="title function_">random</span>()*<span class="number">75</span>+<span class="number">100</span>);</span></span><br><span class="line"><span class="language-javascript">       <span class="keyword">var</span> b=<span class="title class_">Math</span>.<span class="title function_">floor</span>(<span class="title class_">Math</span>.<span class="title function_">random</span>()*<span class="number">75</span>+<span class="number">80</span>);</span></span><br><span class="line"><span class="language-javascript">       tags[i].<span class="property">style</span>.<span class="property">background</span> = <span class="string">&quot;rgb(&quot;</span>+r+<span class="string">&quot;,&quot;</span>+g+<span class="string">&quot;,&quot;</span>+b+<span class="string">&quot;)&quot;</span>;</span></span><br><span class="line"><span class="language-javascript">     &#125;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css">  <span class="selector-class">.tag-cloud-tags</span>&#123;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">font-family</span>: Helvetica, Tahoma, Arial;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">font-weight</span>: <span class="number">100</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">text-align</span>: center;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">counter-reset</span>: tags;</span></span><br><span class="line"><span class="language-css">  &#125;</span></span><br><span class="line"><span class="language-css">  <span class="selector-class">.tag-cloud-tags</span> <span class="selector-tag">a</span>&#123;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">border-radius</span>: <span class="number">6px</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">padding-right</span>: <span class="number">5px</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">padding-left</span>: <span class="number">5px</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">margin</span>: <span class="number">8px</span> <span class="number">5px</span> <span class="number">0px</span> <span class="number">0px</span>;</span></span><br><span class="line"><span class="language-css">  &#125;</span></span><br><span class="line"><span class="language-css">  <span class="selector-class">.tag-cloud-tags</span> <span class="selector-tag">a</span><span class="selector-pseudo">:before</span>&#123;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">content</span>: <span class="string">&quot;ğŸ”–&quot;</span>;</span></span><br><span class="line"><span class="language-css">  &#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css">  <span class="selector-class">.tag-cloud-tags</span> <span class="selector-tag">a</span><span class="selector-pseudo">:hover</span>&#123;</span></span><br><span class="line"><span class="language-css">     <span class="attribute">box-shadow</span>: <span class="number">0px</span> <span class="number">5px</span> <span class="number">15px</span> <span class="number">0px</span> <span class="built_in">rgba</span>(<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,.<span class="number">4</span>);</span></span><br><span class="line"><span class="language-css">     <span class="attribute">transform</span>: <span class="built_in">scale</span>(<span class="number">1.1</span>);</span></span><br><span class="line"><span class="language-css">     <span class="comment">/*box-shadow: 10px 10px 15px 2px rgba(0,0,0,.12), 0 0 6px 0 rgba(104, 104, 105, 0.1);*/</span></span></span><br><span class="line"><span class="language-css">     <span class="attribute">transition-duration</span>: <span class="number">0.15s</span>;</span></span><br><span class="line"><span class="language-css">  &#125;</span></span><br><span class="line"><span class="language-css"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="å¼•å…¥æ–°å»ºæ–‡ä»¶"><a href="#å¼•å…¥æ–°å»ºæ–‡ä»¶" class="headerlink" title="å¼•å…¥æ–°å»ºæ–‡ä»¶"></a>å¼•å…¥æ–°å»ºæ–‡ä»¶</h4><p>åœ¨åŒç›®å½•ä¸‹çš„<code>page.swig</code>æ–‡ä»¶ä¸­å¼•å…¥</p>
<figure class="highlight django"><table><tr><td class="code"><pre><span class="line"><span class="template-tag">&#123;% <span class="name"><span class="name">include</span></span> &#x27;tag-color.swig&#x27; %&#125;</span></span><br></pre></td></tr></table></figure>
<p><img src="/posts/c2d19cb2/tagcolor.png" alt="tagcolor"></p>
<p>è®¾ç½®å®Œæˆå<code>hexo g  &amp;&amp; hexo s</code>å°±å¯ä»¥é¢„è§ˆæ•ˆæœäº† <a href="https://www.yubo365.cn/tags">æ ‡ç­¾é¡µåœ°å€</a></p>
<h3 id="è®¾ç½®canvasç²’å­æ—¶é’Ÿ"><a href="#è®¾ç½®canvasç²’å­æ—¶é’Ÿ" class="headerlink" title="è®¾ç½®canvasç²’å­æ—¶é’Ÿ"></a>è®¾ç½®canvasç²’å­æ—¶é’Ÿ</h3><p>é€šè¿‡è¯¥ç¯‡<a href="https://www.cnblogs.com/xiaohuochai/p/6368039.html">ç²’å­æ—¶é’Ÿ</a>å†…å®¹çš„å¼€å‘æ€æƒ³ï¼Œæ•´åˆåˆ°é¡µé¢ä¸­</p>
<h4 id="æ–°å»ºæ–‡ä»¶"><a href="#æ–°å»ºæ–‡ä»¶" class="headerlink" title="æ–°å»ºæ–‡ä»¶"></a>æ–°å»ºæ–‡ä»¶</h4><p>åœ¨<code>/themes/next/layout/_custom/</code>ç›®å½•ä¸‹æ–°å»º<code>clock.swig</code>æ–‡ä»¶,å†…å®¹ä¸‹è½½ï¼š<br><a href="https://cdn.jsdelivr.net/gh/leafjame/cdn/share/swig/clock.swig">clock.swig</a></p>
<h4 id="å¼•å…¥æ–‡ä»¶"><a href="#å¼•å…¥æ–‡ä»¶" class="headerlink" title="å¼•å…¥æ–‡ä»¶"></a>å¼•å…¥æ–‡ä»¶</h4><p>åœ¨<code>/themes/next/layout/_macro/sidebar.swig</code>æ–‡ä»¶ä¸­å¼•å…¥</p>
<figure class="highlight django"><table><tr><td class="code"><pre><span class="line"><span class="template-tag">&#123;% <span class="name"><span class="name">include</span></span> &#x27;../_custom/clock.swig&#x27; %&#125;</span></span><br></pre></td></tr></table></figure>
<p>å…·ä½“æ”¾åœ¨ä»€ä¹ˆä½ç½®ï¼Œæ ¹æ®è‡ªå·±å–œæ¬¢æ¥ã€‚</p>
<h3 id="ç½‘ç«™è¿è¡Œæ—¶é—´"><a href="#ç½‘ç«™è¿è¡Œæ—¶é—´" class="headerlink" title="ç½‘ç«™è¿è¡Œæ—¶é—´"></a>ç½‘ç«™è¿è¡Œæ—¶é—´</h3><p>åœ¨<code>/themes/next/layout/_custom/</code>ç›®å½•ä¸‹æ–°å»º<code>runtime.swig</code>æ–‡ä»¶ï¼Œç„¶åå°†ä¸‹é¢ä»£ç æ‹·è´è¿›å»ï¼š</p>
<figure class="highlight reasonml"><table><tr><td class="code"><pre><span class="line">&lt;span id=<span class="string">&quot;sitetime&quot;</span>&gt;&lt;/span&gt;</span><br><span class="line">&lt;script language=javascript&gt;</span><br><span class="line">	<span class="keyword">function</span> site<span class="constructor">Time()</span>&#123;</span><br><span class="line">		window.set<span class="constructor">Timeout(<span class="string">&quot;siteTime()&quot;</span>, 1000)</span>;</span><br><span class="line">		var seconds = <span class="number">1000</span>;</span><br><span class="line">		var minutes = seconds<span class="operator"> * </span><span class="number">60</span>;</span><br><span class="line">		var hours = minutes<span class="operator"> * </span><span class="number">60</span>;</span><br><span class="line">		var days = hours<span class="operator"> * </span><span class="number">24</span>;</span><br><span class="line">		var years = days<span class="operator"> * </span><span class="number">365</span>;</span><br><span class="line">		var today = <span class="keyword">new</span> <span class="constructor">Date()</span>;</span><br><span class="line">		var todayYear = today.get<span class="constructor">FullYear()</span>;</span><br><span class="line">		var todayMonth = today.get<span class="constructor">Month()</span>+<span class="number">1</span>;</span><br><span class="line">		var todayDate = today.get<span class="constructor">Date()</span>;</span><br><span class="line">		var todayHour = today.get<span class="constructor">Hours()</span>;</span><br><span class="line">		var todayMinute = today.get<span class="constructor">Minutes()</span>;</span><br><span class="line">		var todaySecond = today.get<span class="constructor">Seconds()</span>;</span><br><span class="line">                <span class="comment">/** </span></span><br><span class="line"><span class="comment">                * Date.UTC() -- è¿”å›dateå¯¹è±¡è·ä¸–ç•Œæ ‡å‡†æ—¶é—´(UTC)1970å¹´1æœˆ1æ—¥åˆå¤œä¹‹é—´çš„æ¯«ç§’æ•°(æ—¶é—´æˆ³)</span></span><br><span class="line"><span class="comment">                * year - ä½œä¸ºdateå¯¹è±¡çš„å¹´ä»½ï¼Œä¸º4ä½å¹´ä»½å€¼</span></span><br><span class="line"><span class="comment">                * month - 0-11ä¹‹é—´çš„æ•´æ•°ï¼Œåšä¸ºdateå¯¹è±¡çš„æœˆä»½</span></span><br><span class="line"><span class="comment">                * day - 1-31ä¹‹é—´çš„æ•´æ•°ï¼Œåšä¸ºdateå¯¹è±¡çš„å¤©æ•°</span></span><br><span class="line"><span class="comment">                * hours - 0(åˆå¤œ24ç‚¹)-23ä¹‹é—´çš„æ•´æ•°ï¼Œåšä¸ºdateå¯¹è±¡çš„å°æ—¶æ•°</span></span><br><span class="line"><span class="comment">                * minutes - 0-59ä¹‹é—´çš„æ•´æ•°ï¼Œåšä¸ºdateå¯¹è±¡çš„åˆ†é’Ÿæ•°</span></span><br><span class="line"><span class="comment">                * seconds - 0-59ä¹‹é—´çš„æ•´æ•°ï¼Œåšä¸ºdateå¯¹è±¡çš„ç§’æ•°</span></span><br><span class="line"><span class="comment">                * microseconds - 0-999ä¹‹é—´çš„æ•´æ•°ï¼Œåšä¸ºdateå¯¹è±¡çš„æ¯«ç§’æ•°</span></span><br><span class="line"><span class="comment">                **/</span></span><br><span class="line">		var t1 = Date.<span class="constructor">UTC(2020,12,09,22,00,00)</span>; <span class="comment">//åŒ—äº¬æ—¶é—´2018-2-13 00:00:00</span></span><br><span class="line">		var t2 = Date.<span class="constructor">UTC(<span class="params">todayYear</span>,<span class="params">todayMonth</span>,<span class="params">todayDate</span>,<span class="params">todayHour</span>,<span class="params">todayMinute</span>,<span class="params">todaySecond</span>)</span>;</span><br><span class="line">		var diff = t2-t1;</span><br><span class="line">		var diffYears = <span class="module-access"><span class="module"><span class="identifier">Math</span>.</span></span>floor(diff/years);</span><br><span class="line">		var diffDays = <span class="module-access"><span class="module"><span class="identifier">Math</span>.</span></span>floor((diff/days)-diffYears*<span class="number">365</span>);</span><br><span class="line">		var diffHours = <span class="module-access"><span class="module"><span class="identifier">Math</span>.</span></span>floor((diff-(diffYears*<span class="number">365</span>+diffDays)*days)/hours);</span><br><span class="line">		var diffMinutes = <span class="module-access"><span class="module"><span class="identifier">Math</span>.</span></span>floor((diff-(diffYears*<span class="number">365</span>+diffDays)*days-diffHours*hours)/minutes);</span><br><span class="line">		var diffSeconds = <span class="module-access"><span class="module"><span class="identifier">Math</span>.</span></span>floor((diff-(diffYears*<span class="number">365</span>+diffDays)*days-diffHours*hours-diffMinutes*minutes)/seconds);</span><br><span class="line">		document.get<span class="constructor">ElementById(<span class="string">&quot;sitetime&quot;</span>)</span>.innerHTML=<span class="string">&quot; å·²è¿è¡Œ&quot;</span>+<span class="comment">/*diffYears+&quot; å¹´ &quot;+*/</span>diffDays+<span class="string">&quot; å¤© &quot;</span>+diffHours+<span class="string">&quot; å°æ—¶ &quot;</span>+diffMinutes+<span class="string">&quot; åˆ†é’Ÿ &quot;</span>+diffSeconds+<span class="string">&quot; ç§’&quot;</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	site<span class="constructor">Time()</span>;</span><br></pre></td></tr></table></figure>
<p>ä¿®æ”¹BirthDayä¸ºå»ºç«™æ—¶é—´<br>åœ¨<code>/themes/next/layout/_macro/sidebar.swig</code>åŒçº§æ–‡ä»¶ç›®å½•ä¸‹å¯¼å…¥è¿è¡Œæ—¶é—´æ¨¡å—</p>
<figure class="highlight django"><table><tr><td class="code"><pre><span class="line"><span class="template-tag">&#123;% <span class="name"><span class="name">include</span></span> &#x27;../_custom/runtime.swig&#x27; %&#125;</span></span><br></pre></td></tr></table></figure>
<p>åœ¨å…¶ä»–ä½ç½®å¯¼å…¥è¿è¡Œæ—¶é—´æ¨¡å—</p>
<figure class="highlight handlebars"><table><tr><td class="code"><pre><span class="line"><span class="template-variable">&#123;&#123; <span class="name"><span class="built_in">partial</span></span>(<span class="name">&#x27;_custom/runtime.swig&#x27;</span>, &#123;&#125;, &#123;cache: theme.cache.enable&#125;) &#125;&#125;</span></span><br></pre></td></tr></table></figure>
<p>é‡æ–°æ‰“åŒ…ï¼Œè¿è¡Œï¼Œç„¶åå°±å¯ä»¥å±•ç¤ºç½‘ç«™è¿è¡Œæ—¶é—´äº†</p>
<h3 id="ç¾åŒ–urlåœ°å€ï¼ˆ-htmlåç¼€ï¼‰"><a href="#ç¾åŒ–urlåœ°å€ï¼ˆ-htmlåç¼€ï¼‰" class="headerlink" title="ç¾åŒ–urlåœ°å€ï¼ˆ.htmlåç¼€ï¼‰"></a>ç¾åŒ–urlåœ°å€ï¼ˆ.htmlåç¼€ï¼‰</h3><p>hexo-nextæ–‡ç« é“¾æ¥é»˜è®¤çš„ç”Ÿæˆè§„åˆ™æ˜¯ï¼š<code>:year/:month/:day/:title</code>ï¼Œæ˜¯æŒ‰ç…§å¹´ã€æœˆã€æ—¥ã€æ ‡é¢˜æ¥ç”Ÿæˆçš„ã€‚</p>
<p>å®‰è£…æ’ä»¶</p>
<figure class="highlight ada"><table><tr><td class="code"><pre><span class="line">npm install hexo-abbrlink <span class="comment">--save</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>æ‰§è¡Œæ­¤å‘½ä»¤å¯èƒ½ä¼šä¸æˆåŠŸï¼Œæç¤ºä½ ç¼ºå°‘ç›¸åº”çš„ä¾èµ–ï¼Œæ¯”å¦‚babel-eslintã€mini-css-extract-pluginã€webpack-cliâ€¦<br>ä½¿ç”¨npmå‘½ä»¤å®‰è£…å³å¯ï¼Œæ¯”å¦‚<code>npm install eslint@4.x babel-eslint@8 --save-dev</code></p>
</blockquote>
<p>ä¿®æ”¹æ ¹ç›®å½•ç«™ç‚¹é…ç½®æ–‡ä»¶<code>config.yml</code>ï¼Œæ”¹ä¸ºï¼š</p>
<figure class="highlight dts"><table><tr><td class="code"><pre><span class="line"><span class="symbol">permalink:</span> posts/:abbrlink.html</span><br><span class="line"><span class="symbol">abbrlink:</span></span><br><span class="line"><span class="symbol">	alg:</span> crc32   <span class="meta">#ç®—æ³•ï¼š crc16(default) and crc32</span></span><br><span class="line"><span class="symbol">	rep:</span> hex     <span class="meta">#è¿›åˆ¶ï¼š dec(default) and hex</span></span><br></pre></td></tr></table></figure>
<p>è¿™æ ·è®¾ç½®è¿‡ååœ°å€æ å¯ä»¥å±•ç¤º.htmlåç¼€æ ¼å¼çš„åœ°å€äº†ï¼Œä½†æ˜¯è¿™ä¸ªæ—¶å€™ä¼šå‡ºç°ä¸€ä¸ªé—®é¢˜ï¼Œä¹‹å‰ä½¿ç”¨<code>hexo-asset-image</code>æ’ä»¶ç”Ÿæˆçš„å›¾ç‰‡æ— æ³•æ˜¾ç¤ºäº†<br>è§£å†³æ–¹æ³•ï¼š<br>æ‰“å¼€æºæ–‡ä»¶<code>\node_modules\hexo-asset-image\index.js</code>,ä¿®æ”¹å¦‚ä¸‹ï¼š<br><img src="/posts/c2d19cb2/imgshow.png" alt="imgshow"></p>
<figure class="highlight lasso"><table><tr><td class="code"><pre><span class="line"><span class="built_in">var</span> appendLink = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line"><span class="keyword">if</span>(/.*\/index\.html$/.test(<span class="keyword">link</span>))&#123;</span><br><span class="line">	appendLink = <span class="string">&#x27;index/&#x27;</span></span><br><span class="line">	<span class="built_in">var</span> endPos = <span class="keyword">link</span>.lastIndexOf(<span class="string">&#x27;/&#x27;</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">	<span class="built_in">var</span> endPos = <span class="keyword">link</span>.length - <span class="number">5</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// var endPos = link.lastIndexOf(&#x27;/&#x27;) + 1;</span></span><br><span class="line">   <span class="comment">// link = link.substring(beginPos, endPos);</span></span><br><span class="line">   <span class="keyword">link</span> = <span class="keyword">link</span>.substring(beginPos, endPos) + <span class="string">&#x27;/&#x27;</span> + appendLink;</span><br></pre></td></tr></table></figure>
<p>é‡æ–°è¿è¡Œï¼Œå›¾ç‰‡å°±å¯ä»¥æ­£å¸¸å±•ç¤ºäº†</p>
<h3 id="æ–‡ç« åŠ å¯†è®¿é—®"><a href="#æ–‡ç« åŠ å¯†è®¿é—®" class="headerlink" title="æ–‡ç« åŠ å¯†è®¿é—®"></a>æ–‡ç« åŠ å¯†è®¿é—®</h3><p>é€šè¿‡å¼•å…¥<a href="https://github.com/D0n9X1n/hexo-blog-encrypt">hexo-blog-encrypt</a>ä¾èµ–åŒ…ï¼Œè¿›è¡ŒåŠ å¯†.</p>
<h4 id="ç‰¹æ€§"><a href="#ç‰¹æ€§" class="headerlink" title="ç‰¹æ€§"></a>ç‰¹æ€§</h4><ul>
<li>ä¸€æ—¦ä½ è¾“å…¥äº†æ­£ç¡®çš„å¯†ç , å®ƒå°†ä¼šè¢«å­˜å‚¨åœ¨æœ¬åœ°æµè§ˆå™¨çš„ localStorageä¸­. æŒ‰ä¸ªæŒ‰é’®, å¯†ç å°†ä¼šè¢«æ¸…ç©º. è‹¥åšå®¢ä¸­åˆè„šæœ¬, å®ƒå°†ä¼šè¢«æ­£ç¡®åœ°æ‰§è¡Œ.</li>
<li>æ”¯æŒæŒ‰æ ‡ç­¾åŠ å¯†.</li>
<li>æ‰€æœ‰çš„æ ¸å¿ƒåŠŸèƒ½éƒ½æ˜¯ç”±åŸç”Ÿçš„ API æ‰€æä¾›çš„. åœ¨ Node.jsä¸­, æˆ‘ä»¬ä½¿ç”¨ <a href="https://nodejs.org/dist/latest-v12.x/docs/api/crypto.html">Crypto</a>. åœ¨æµè§ˆå™¨ä¸­, æˆ‘ä»¬ä½¿ç”¨ <a href="https://developer.mozilla.org/en-US/docs/Web/API/Web_Crypto_API">Web Crypto API</a>.</li>
<li><a href="https://tools.ietf.org/html/rfc2898">PBKDF2</a>, <a href="https://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.180-4.pdf">SHA256</a> è¢«ç”¨äºåˆ†å‘å¯†é’¥, <a href="https://csrc.nist.gov/publications/detail/sp/800-38a/final">AES256-CBC</a> è¢«ç”¨äºåŠ è§£å¯†, æˆ‘ä»¬è¿˜ä½¿ç”¨ <a href="https://csrc.nist.gov/csrc/media/publications/fips/198/1/final/documents/fips-198-1_final.pdf">HMAC</a> æ¥éªŒè¯å¯†æ–‡çš„æ¥æº, å¹¶ç¡®ä¿å…¶æœªè¢«ç¯¡æ”¹.</li>
<li>æˆ‘ä»¬å¹¿æ³›åœ°ä½¿ç”¨ Promise æ¥è¿›è¡Œå¼‚æ­¥æ“ä½œ, ä»¥æ­¤ç¡®ä¿çº¿ç¨‹ä¸è¢«æœå¡.</li>
<li>åŠ å¯†é¡µé¢å¤šä¸»é¢˜æ”¯æŒ, ç°åœ¨å·²ç»æ”¯æŒçš„ä¸»é¢˜æœ‰ [default, xray], æ›´å¤šçš„ä¸»é¢˜æ­£åœ¨å¼€å‘ä¸­.</li>
<li>è¿‡æ—¶çš„æµè§ˆå™¨å°†ä¸èƒ½æ­£å¸¸æ˜¾ç¤º, å› æ­¤, è¯·å‡çº§æ‚¨çš„æµè§ˆå™¨.  </li>
</ul>
<h4 id="å®‰è£…"><a href="#å®‰è£…" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h4><figure class="highlight mipsasm"><table><tr><td class="code"><pre><span class="line">npm <span class="keyword">install </span>hexo-<span class="keyword">blog-encrypt </span>-S</span><br></pre></td></tr></table></figure>
<h4 id="ä½¿ç”¨"><a href="#ä½¿ç”¨" class="headerlink" title="ä½¿ç”¨"></a>ä½¿ç”¨</h4><ul>
<li>æ–‡ç« ä¿¡æ¯å¤´ä½¿ç”¨<br>å°†<code>password</code>å­—æ®µï¼Œæ·»åŠ åˆ°æ–‡ç« ä¿¡æ¯å¤´<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">title:</span> <span class="string">Hello</span> <span class="string">World</span></span><br><span class="line"><span class="attr">date:</span> <span class="number">2020-01-11 14:11:00</span></span><br><span class="line"><span class="attr">password:</span> <span class="string">bac123</span></span><br><span class="line"><span class="meta">---</span></span><br></pre></td></tr></table></figure></li>
<li>é«˜çº§è®¾ç½®<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">title:</span> <span class="string">Hello</span> <span class="string">World</span></span><br><span class="line"><span class="attr">tags:</span></span><br><span class="line"><span class="bullet">-</span> <span class="string">åŠ å¯†æ–‡ç« tag</span></span><br><span class="line"><span class="attr">date:</span> </span><br><span class="line"><span class="attr">password:</span> <span class="string">aabbcc</span></span><br><span class="line"><span class="attr">abstract:</span> <span class="string">è¯¥æ–‡ç« å·²åŠ å¯†,</span> <span class="string">è¯·è¾“å…¥å¯†ç æŸ¥çœ‹ã€‚</span></span><br><span class="line"><span class="attr">message:</span> <span class="string">è¯¥æ–‡ç« å·²åŠ å¯†,</span> <span class="string">è¯·è¾“å…¥å¯†ç æŸ¥çœ‹ã€‚</span></span><br><span class="line"><span class="attr">wrong_pass_message:</span> <span class="string">å¯†ç ä¸æ­£ç¡®ï¼Œè¯·é‡æ–°è¾“å…¥ï¼</span></span><br><span class="line"><span class="attr">wrong_hash_message:</span> <span class="string">æ–‡ç« ä¸èƒ½è¢«æ ¡éªŒ,</span> <span class="string">ä¸è¿‡æ‚¨è¿˜æ˜¯èƒ½çœ‹çœ‹è§£å¯†åçš„å†…å®¹ï¼</span></span><br><span class="line"><span class="meta">---</span></span><br></pre></td></tr></table></figure></li>
<li>åœ¨æ ¹ç›®å½•ä¸‹<code>_config.yml</code>ä¸­å…¨å±€è®¾ç½®<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">encrypt:</span></span><br><span class="line">  <span class="attr">abstract:</span> <span class="string">è¯¥æ–‡ç« å·²åŠ å¯†,</span> <span class="string">è¯·è¾“å…¥å¯†ç æŸ¥çœ‹.</span></span><br><span class="line">  <span class="attr">message:</span> <span class="string">è¯¥æ–‡ç« å·²åŠ å¯†,</span> <span class="string">è¯·è¾“å…¥å¯†ç æŸ¥çœ‹.</span></span><br><span class="line">  <span class="attr">tags:</span></span><br><span class="line">  <span class="bullet">-</span> &#123;<span class="attr">name:</span> <span class="string">tagName</span>, <span class="attr">password:</span> <span class="string">å¯†ç A</span>&#125;</span><br><span class="line">  <span class="bullet">-</span> &#123;<span class="attr">name:</span> <span class="string">tagName</span>, <span class="attr">password:</span> <span class="string">å¯†ç B</span>&#125;</span><br><span class="line">  <span class="attr">wrong_pass_message:</span> <span class="string">å¯†ç ä¸æ­£ç¡®ï¼Œè¯·é‡æ–°è¾“å…¥.</span></span><br><span class="line">  <span class="attr">wrong_hash_message:</span> <span class="string">æŠ±æ­‰,</span> <span class="string">è¿™ä¸ªæ–‡ç« ä¸èƒ½è¢«æ ¡éªŒ,</span> <span class="string">ä¸è¿‡æ‚¨è¿˜æ˜¯èƒ½çœ‹çœ‹è§£å¯†åçš„å†…å®¹.</span></span><br></pre></td></tr></table></figure>
æ³¨ï¼šè‹¥æ–‡ç« ä¸­é‡‡ç”¨_config.ymlä¸­çš„å…¨å±€é…ç½®ï¼Œåˆ™æ–‡ç« çš„tagsåªèƒ½æœ‰ä¸€ä¸ªï¼Œè‹¥æœ‰å¤šä¸ªtagsï¼Œåˆ™å¤±æ•ˆã€‚  </li>
</ul>
<h4 id="è®¾ç½®ä¸»é¢˜"><a href="#è®¾ç½®ä¸»é¢˜" class="headerlink" title="è®¾ç½®ä¸»é¢˜"></a>è®¾ç½®ä¸»é¢˜</h4><p>å¢åŠ ä¸€ä¸ª<code>theme</code>å­—æ®µï¼Œå¯ä»¥é€‰æ‹©çš„ä¸»é¢˜ï¼š<code>default</code>ã€<code>blink</code>ã€<code>shrink</code>ã€<code>flip</code>ã€<code>up</code>ã€<code>surge</code>ã€<code>wave</code>ã€<code>xray</code></p>
<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="comment"># Security</span></span><br><span class="line"><span class="attr">encrypt:</span> <span class="comment"># hexo-blog-encrypt</span></span><br><span class="line">  <span class="attr">abstract:</span> <span class="string">æœ‰ä¸œè¥¿è¢«åŠ å¯†äº†,</span> <span class="string">è¯·è¾“å…¥å¯†ç æŸ¥çœ‹.</span></span><br><span class="line">  <span class="attr">message:</span> <span class="string">æ‚¨å¥½,</span> <span class="string">è¿™é‡Œéœ€è¦å¯†ç .</span></span><br><span class="line">  <span class="attr">tags:</span></span><br><span class="line">  <span class="bullet">-</span> &#123;<span class="attr">name:</span> <span class="string">tagName</span>, <span class="attr">password:</span> <span class="string">å¯†ç A</span>&#125;</span><br><span class="line">  <span class="bullet">-</span> &#123;<span class="attr">name:</span> <span class="string">tagName</span>, <span class="attr">password:</span> <span class="string">å¯†ç B</span>&#125;</span><br><span class="line">  <span class="attr">theme:</span> <span class="string">xray</span></span><br><span class="line">  <span class="attr">wrong_pass_message:</span> <span class="string">æŠ±æ­‰,</span> <span class="string">è¿™ä¸ªå¯†ç çœ‹ç€ä¸å¤ªå¯¹,</span> <span class="string">è¯·å†è¯•è¯•.</span></span><br><span class="line">  <span class="attr">wrong_hash_message:</span> <span class="string">æŠ±æ­‰,</span> <span class="string">è¿™ä¸ªæ–‡ç« ä¸èƒ½è¢«æ ¡éªŒ,</span> <span class="string">ä¸è¿‡æ‚¨è¿˜æ˜¯èƒ½çœ‹çœ‹è§£å¯†åçš„å†…å®¹.</span></span><br></pre></td></tr></table></figure>
<h4 id="é…ç½®ä¼˜å…ˆçº§"><a href="#é…ç½®ä¼˜å…ˆçº§" class="headerlink" title="é…ç½®ä¼˜å…ˆçº§"></a>é…ç½®ä¼˜å…ˆçº§</h4><p>æ–‡ç« ä¿¡æ¯å¤´ <code>&gt;</code> _config.yml (ç«™ç‚¹æ ¹ç›®å½•ä¸‹çš„) <code>&gt;</code> é»˜è®¤é…ç½®  </p>
<p>ä½¿ç”¨<code>hexo clean</code> &amp;&amp; <code>hexo g</code> &amp;&amp; <code>hexo s</code>åœ¨æœ¬åœ°é¢„è§ˆåŠ å¯†çš„æ–‡ç« ã€‚</p>
]]></content>
      <categories>
        <category>Hexo</category>
      </categories>
      <tags>
        <tag>Next</tag>
      </tags>
  </entry>
  <entry>
    <title>ã€è§£å†³ã€‘æ— æ³•å°†â€œXXXâ€é¡¹è¯†åˆ«ä¸º cmdletã€å‡½æ•°ã€è„šæœ¬æ–‡ä»¶æˆ–å¯è¿è¡Œç¨‹åºçš„åç§°â€¦â€¦</title>
    <url>/posts/987e7249.html</url>
    <content><![CDATA[<h3 id="è¿›å…¥PowerShell-æ¨¡å¼"><a href="#è¿›å…¥PowerShell-æ¨¡å¼" class="headerlink" title="è¿›å…¥PowerShell æ¨¡å¼"></a>è¿›å…¥PowerShell æ¨¡å¼</h3><p>æŸ¥çœ‹å½“å‰æ‰€æœ‰ä½œç”¨åŸŸ </p>
<figure class="highlight mathematica"><table><tr><td class="code"><pre><span class="line"><span class="built_in">Get</span><span class="operator">-</span><span class="variable">ExecutionPolicy</span> <span class="operator">-</span><span class="built_in">List</span> </span><br></pre></td></tr></table></figure>
<p><img src="/posts/987e7249/1.png" alt="æŸ¥çœ‹ä½œç”¨åŸŸ"><br>ä¸Šå›¾æ˜¾ç¤ºå°±æœ€åä¸€ä¸ªä½œç”¨åŸŸæœ‰æƒé™ï¼Œå…¶ä»–ä½œç”¨åŸŸéƒ½æ²¡æœ‰æƒé™ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±éœ€è¦å»ç»™å®ƒè®¾ç½®æƒé™</p>
<h4 id="è®¾ç½®æƒé™"><a href="#è®¾ç½®æƒé™" class="headerlink" title="è®¾ç½®æƒé™"></a>è®¾ç½®æƒé™</h4><p><code>Set-ExecutionPolicy RemoteSigned -Scope &lt; scopeName &gt;</code>,è®¾ç½®å½“å‰ç”¨æˆ·ä½œç”¨åŸŸå…·å¤‡æƒé™ï¼Œå…·ä½“è®¾ç½®æ ¼</p>
<figure class="highlight coq"><table><tr><td class="code"><pre><span class="line"><span class="keyword">Set</span>-ExecutionPolicy RemoteSigned -<span class="keyword">Scope</span> CurrentUser</span><br></pre></td></tr></table></figure>
<p><img src="/posts/987e7249/2.png" alt="æŸ¥çœ‹ä½œç”¨åŸŸ"><br>æŒ‰ç…§ä¸Šé¢çš„æ ¼å¼ï¼Œæ‰§è¡Œéœ€è¦åŠ æƒé™çš„ä½œç”¨åŸŸï¼Œç„¶åå†å»å°è¯•ä¹‹å‰çš„æ–¹æ³•ï¼Œå‘ç°å°±ä¸ä¼šæŠ¥é”™æç¤ºäº†ã€‚</p>
]]></content>
      <categories>
        <category>è§£å†³é—®é¢˜</category>
      </categories>
      <tags>
        <tag>è§£å†³é—®é¢˜</tag>
      </tags>
  </entry>
  <entry>
    <title>Hexo Next ä¸»é¢˜æ·»åŠ  Valine è¯„è®ºç³»ç»Ÿ</title>
    <url>/posts/f65b37a2.html</url>
    <content><![CDATA[<h3 id="æ³¨å†Œ-LeanCloud"><a href="#æ³¨å†Œ-LeanCloud" class="headerlink" title="æ³¨å†Œ LeanCloud"></a>æ³¨å†Œ LeanCloud</h3><p>Valine æ˜¯åŸºäº LeanCloud ä½œä¸ºæ•°æ®å­˜å‚¨çš„ï¼Œæ‰€ä»¥éœ€è¦æ³¨å†Œä¸€ä¸ªè´¦å·ã€‚æ³¨å†Œå®Œæˆåï¼Œè¿›å…¥æ§åˆ¶å°</p>
<h3 id="åˆ›å»º"><a href="#åˆ›å»º" class="headerlink" title="åˆ›å»º"></a>åˆ›å»º</h3><p>åˆ›å»ºä¸€ä¸ªåº”ç”¨ -&gt; è¾“å…¥åº”ç”¨åç§° -&gt; é€‰æ‹©<code>å¼€å‘ç‰ˆ</code> -&gt; ç‚¹å‡»åˆ›å»º</p>
<h3 id="é…ç½®"><a href="#é…ç½®" class="headerlink" title="é…ç½®"></a>é…ç½®</h3><p>åˆ›å»ºå®Œæˆåï¼Œæ‰“å¼€åº”ç”¨ï¼Œç‚¹å‡»å·¦è¾¹çš„<code>å­˜å‚¨</code>å¦‚ä¸‹å›¾ï¼š<br><img src="/posts/f65b37a2/chunchu.png" alt="å­˜å‚¨"><br>æŸ¥çœ‹æ•°æ®ä¸‹é¢æœ‰æ²¡æœ‰<code>Counter</code>å’Œ<code>Comment</code>ä¸¤ä¸ªClassesï¼Œå¦‚æœæ²¡æœ‰ï¼Œç‚¹å‡»<code>åˆ›å»ºClass</code>ï¼Œè¾“å…¥å¯¹åº”çš„<code>Counter</code>å’Œ<code>Comment</code>åå­—ï¼Œé€‰æ‹©<code>æ— é™åˆ¶</code>ï¼Œç‚¹å‡»åˆ›å»ºï¼Œåˆ›å»ºå®Œæˆåï¼Œå¦‚ä¸‹ï¼š<br><img src="/posts/f65b37a2/class.png" alt="class"><br>åˆ›å»ºå®Œä¸Šé¢ä¸¤ä¸ªclassåï¼Œæ‰¾åˆ°<code>è®¾ç½®æ </code>ï¼Œç‚¹å‡»å®‰å…¨ä¸­å¿ƒï¼Œåœ¨æœåŠ¡å¼€å…³æ ä¸­ï¼Œæ‰“å¼€æ•°æ®å­˜å‚¨ï¼Œå…¶å®ƒçš„å…¨å…³æ‰ï¼Œåœ¨Webå®‰å…¨åŸŸåä¸­ï¼Œå¡«å†™åšå®¢çš„åŸŸååœ°å€ï¼š<br><img src="/posts/f65b37a2/shezhi.png" alt="è®¾ç½®"><br>åŒæ ·åœ¨<code>è®¾ç½®æ </code>ä¸‹é¢ï¼Œç‚¹å‡»<code>åº”ç”¨Key</code>ï¼Œè·å–åˆ°<code>AppID</code> å’Œ <code>Appkey</code>ï¼Œç„¶åè¿›å…¥åˆ°ä¸»é¢˜é…ç½®ä¸‹è¿›è¡Œé…ç½®ã€‚</p>
<h3 id="nextä¸»é¢˜ä¸­é…ç½®valine"><a href="#nextä¸»é¢˜ä¸­é…ç½®valine" class="headerlink" title="nextä¸»é¢˜ä¸­é…ç½®valine"></a>nextä¸»é¢˜ä¸­é…ç½®valine</h3><p>åœ¨<code>/themes/next/_config.yml</code>æ–‡ä»¶ä¸­æœç´¢<code>valine</code>ï¼Œé…ç½®ä¸Šé¢ç”Ÿæˆçš„<code>AppID</code> å’Œ <code>Appkey</code>ï¼Œlanguageä¸º<code>zh-cn</code>,<br><img src="/posts/f65b37a2/valine.png" alt="valine"><br>ä¿®æ”¹<code>valine.min.js</code>çš„cdnæ–‡ä»¶åœ°å€ï¼šç§»æ­¥åˆ°è¿™é‡Œ<a href="https://www.jsdelivr.com/package/npm/valine">valine</a> é€‰æ‹©æœ€æ–°ç‰ˆæœ¬çš„<code>Valine</code><br><img src="/posts/f65b37a2/minjs.png" alt="minjs"><br>ç„¶åå°†è·å–çš„<code>cdn</code>åœ°å€ï¼Œåˆ°ä¸»é¢˜é…ç½®æ–‡ä»¶<code>_config.yml</code>ä¸­æ·»åŠ å³å¯ã€‚</p>
<figure class="highlight awk"><table><tr><td class="code"><pre><span class="line">valine: https:<span class="regexp">//</span>cdn.jsdelivr.net<span class="regexp">/npm/</span>valine@<span class="number">1.4</span>.<span class="number">14</span><span class="regexp">/dist/</span>Valine.min.js</span><br></pre></td></tr></table></figure>
<p>ç°åœ¨å†é‡æ–°å¯åŠ¨é¡¹ç›®å°±çœ‹å¯ä»¥çœ‹åˆ°è¯„è®ºåŠŸèƒ½äº†ã€‚</p>
<h3 id="Valineè¯„è®ºåŒºä¸æ˜¾ç¤ºé—®é¢˜"><a href="#Valineè¯„è®ºåŒºä¸æ˜¾ç¤ºé—®é¢˜" class="headerlink" title="Valineè¯„è®ºåŒºä¸æ˜¾ç¤ºé—®é¢˜"></a>Valineè¯„è®ºåŒºä¸æ˜¾ç¤ºé—®é¢˜</h3><ul>
<li>å¸¸è§çš„ï¼š<ul>
<li>LeanCloud ä¸­éœ€è¦é…ç½®å®‰å…¨åŸŸå</li>
<li>LeanCloud ä¸­éœ€è¦æœ‰ Counter å’Œ Coment ä¸¤ä¸ªClass.</li>
</ul>
</li>
<li>å…¶ä»–çš„å¯ä»¥å‚è€ƒï¼š<a href="https://github.com/xCss/Valine/issues/172">https://github.com/xCss/Valine/issues/172</a></li>
</ul>
]]></content>
      <categories>
        <category>Hexo</category>
      </categories>
      <tags>
        <tag>Next</tag>
      </tags>
  </entry>
  <entry>
    <title>Vuex</title>
    <url>/posts/vuex.html</url>
    <content><![CDATA[<h3 id="å®‰è£…Vuex"><a href="#å®‰è£…Vuex" class="headerlink" title="å®‰è£…Vuex"></a>å®‰è£…Vuex</h3><figure class="highlight ada"><table><tr><td class="code"><pre><span class="line">npm install vuex <span class="comment">--save</span></span><br></pre></td></tr></table></figure>
<h3 id="æ–°å»ºæ–‡ä»¶"><a href="#æ–°å»ºæ–‡ä»¶" class="headerlink" title="æ–°å»ºæ–‡ä»¶"></a>æ–°å»ºæ–‡ä»¶</h3><p>æ–°å»ºä¸€ä¸ª<code>store</code>æ–‡ä»¶å¤¹ï¼Œåœ¨æ–‡ä»¶å¤¹ä¸‹é¢æ–°å»º<code>index.js</code>æ–‡ä»¶</p>
<figure class="highlight pf"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line">import Vue <span class="keyword">from</span> &#x27;vue&#x27;</span><br><span class="line">import Vuex <span class="keyword">from</span> &#x27;vuex&#x27;</span><br><span class="line"></span><br><span class="line">// ä½¿ç”¨vuex</span><br><span class="line">Vue.use(Vuex)</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="keyword">state</span> = &#123;</span><br><span class="line">  count:<span class="number">1</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> mutations = &#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> getters = &#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> actions = &#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> modules = &#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">// å¯¼å‡º è®©å¤–éƒ¨å¯ä»¥å¼•ç”¨</span><br><span class="line">export <span class="keyword">default</span> new Vuex.Store(&#123;</span><br><span class="line">  <span class="keyword">state</span>,</span><br><span class="line">  mutations,</span><br><span class="line">  getters,</span><br><span class="line">  actions</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<h3 id="åŸºæœ¬ä½¿ç”¨"><a href="#åŸºæœ¬ä½¿ç”¨" class="headerlink" title="åŸºæœ¬ä½¿ç”¨"></a>åŸºæœ¬ä½¿ç”¨</h3><p>åœ¨<code>main.js</code>ä¸­å¼•å…¥<code>store/index.js</code>æ–‡ä»¶</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">Vue</span> <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">App</span> <span class="keyword">from</span> <span class="string">&#x27;./App.vue&#x27;</span></span><br><span class="line"><span class="keyword">import</span> router <span class="keyword">from</span> <span class="string">&#x27;./router&#x27;</span></span><br><span class="line"><span class="keyword">import</span> store <span class="keyword">from</span> <span class="string">&#x27;./store&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="title class_">Vue</span>.<span class="property">config</span>.<span class="property">productionTip</span> = <span class="literal">false</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">new</span> <span class="title class_">Vue</span>(&#123;</span><br><span class="line">  router,</span><br><span class="line">  store,</span><br><span class="line">  <span class="attr">render</span>: <span class="function"><span class="params">h</span> =&gt;</span> <span class="title function_">h</span>(<span class="title class_">App</span>)</span><br><span class="line">&#125;).$mount(<span class="string">&#x27;#app&#x27;</span>)</span><br></pre></td></tr></table></figure>
<h3 id="æ·»åŠ ä¿®æ”¹stateä¸­å€¼çš„æ–¹æ³•"><a href="#æ·»åŠ ä¿®æ”¹stateä¸­å€¼çš„æ–¹æ³•" class="headerlink" title="æ·»åŠ ä¿®æ”¹stateä¸­å€¼çš„æ–¹æ³•"></a>æ·»åŠ ä¿®æ”¹stateä¸­å€¼çš„æ–¹æ³•</h3><p>åœ¨<code>store/index.js</code>æ–‡ä»¶ï¼Œ<code>mutations</code>æ–¹æ³•ä¸­è®¾ç½®æ–¹æ³•</p>
<figure class="highlight pf"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> mutations = &#123;</span><br><span class="line">  add(<span class="keyword">state</span>)&#123;</span><br><span class="line">    <span class="keyword">state</span>.count++</span><br><span class="line">  &#125;,</span><br><span class="line">  reduce(<span class="keyword">state</span>)&#123;</span><br><span class="line">    <span class="keyword">state</span>.count--</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>åœ¨æ¨¡æ¿ä¸­æ·»åŠ è°ƒç”¨<code>mutations</code>é‡Œé¢è®¾ç½®çš„æ–¹æ³•</p>
<figure class="highlight handlebars"><table><tr><td class="code"><pre><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;hello&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>storeå€¼ï¼š</span><span class="template-variable">&#123;&#123;<span class="name">$store.state.count</span>&#125;&#125;</span><span class="language-xml"><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">button</span> @<span class="attr">click</span>=<span class="string">&quot;$store.commit(&#x27;add&#x27;)&quot;</span>&gt;</span>åŠ <span class="tag">&lt;/<span class="name">button</span>&gt;</span> | </span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">button</span> @<span class="attr">click</span>=<span class="string">&quot;$store.commit(&#x27;reduce&#x27;)&quot;</span>&gt;</span>å‡<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span></span><br></pre></td></tr></table></figure>
<h3 id="stateè®¿é—®çŠ¶æ€å¯¹è±¡"><a href="#stateè®¿é—®çŠ¶æ€å¯¹è±¡" class="headerlink" title="stateè®¿é—®çŠ¶æ€å¯¹è±¡"></a>stateè®¿é—®çŠ¶æ€å¯¹è±¡</h3><p>è®¿é—®stateçŠ¶æ€å¯¹è±¡ä¸­çš„çš„æ–¹å¼æœ‰å¥½å‡ ç§ï¼Œ</p>
<ul>
<li>æ–¹å¼ä¸€ï¼šé€šè¿‡computedè®¿é—®<figure class="highlight pf"><table><tr><td class="code"><pre><span class="line">computed:&#123;</span><br><span class="line">  newCount() &#123;</span><br><span class="line">    return this.<span class="variable">$store</span>.<span class="keyword">state</span>.count</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li>æ–¹å¼äºŒï¼šé€šè¿‡<code>mapState</code>è®¿é—®<figure class="highlight gradle"><table><tr><td class="code"><pre><span class="line"><span class="comment">// éœ€è¦å¼•å…¥mapState</span></span><br><span class="line"><span class="keyword">import</span> &#123;mapState&#125; <span class="keyword">from</span> <span class="string">&#x27;vuex&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å†™æ³•ä¸€ï¼š</span></span><br><span class="line">computed:&#123;</span><br><span class="line">  ...mapState([<span class="string">&quot;count&quot;</span>])</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å†™æ³•äºŒï¼š</span></span><br><span class="line">computed:&#123;</span><br><span class="line">  ...mapState(&#123;</span><br><span class="line">      <span class="keyword">count</span>:state=&gt;state.<span class="keyword">count</span></span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="mutationsä¿®æ”¹çŠ¶æ€"><a href="#mutationsä¿®æ”¹çŠ¶æ€" class="headerlink" title="mutationsä¿®æ”¹çŠ¶æ€"></a>mutationsä¿®æ”¹çŠ¶æ€</h3>è·å–<code>Mutations</code>é‡Œé¢çš„æ–¹æ³•ï¼š   </li>
<li>æ–¹æ³•ä¸€ï¼šmutationsä¿®æ”¹statesä¸­çš„å€¼<figure class="highlight routeros"><table><tr><td class="code"><pre><span class="line">&lt;button @<span class="attribute">click</span>=<span class="string">&quot;<span class="variable">$store</span>.commit(&#x27;add&#x27;)&quot;</span>&gt;åŠ &lt;/button&gt; | </span><br><span class="line">&lt;button @<span class="attribute">click</span>=<span class="string">&quot;<span class="variable">$store</span>.commit(&#x27;reduce&#x27;)&quot;</span>&gt;å‡&lt;/button&gt;</span><br></pre></td></tr></table></figure>
å¦‚æœéœ€è¦ä¼ å‚æ•°ï¼Œå¯ä»¥å¦‚ä¸‹ä¼ å‚å†™æ³•<figure class="highlight routeros"><table><tr><td class="code"><pre><span class="line">&lt;button @<span class="attribute">click</span>=<span class="string">&quot;<span class="variable">$store</span>.commit(&#x27;add&#x27;, 100)&quot;</span>&gt;åŠ &lt;/button&gt; | </span><br><span class="line">&lt;button @<span class="attribute">click</span>=<span class="string">&quot;<span class="variable">$store</span>.commit(&#x27;reduce&#x27;)&quot;</span>&gt;å‡&lt;/button&gt;</span><br></pre></td></tr></table></figure>
åœ¨<code>/store/index.js</code>æ–‡ä»¶ä¸­ï¼Œ<code>data</code>å°±æ˜¯è§¦å‘æ–¹æ³•æ—¶å€™çš„å‚æ•°<figure class="highlight pf"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> mutations = &#123;</span><br><span class="line">  add(<span class="keyword">state</span>,data)&#123;</span><br><span class="line">    <span class="keyword">state</span>.count +=data</span><br><span class="line">  &#125;,</span><br><span class="line">  reduce(<span class="keyword">state</span>)&#123;</span><br><span class="line">    <span class="keyword">state</span>.count--</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li>æ–¹æ³•äºŒï¼š<br>é¦–å…ˆå¼•å…¥<code>mapMutations</code><figure class="highlight clean"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;mapState,mapMutations&#125; <span class="keyword">from</span> <span class="string">&#x27;vuex&#x27;</span>;</span><br></pre></td></tr></table></figure>
æ¨¡æ¿ä¸­å†™æ³•<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">button</span> @<span class="attr">click</span>=<span class="string">&quot;add(100)&quot;</span>&gt;</span>åŠ <span class="tag">&lt;/<span class="name">button</span>&gt;</span> | </span><br><span class="line"><span class="tag">&lt;<span class="name">button</span> @<span class="attr">click</span>=<span class="string">&quot;reduce&quot;</span>&gt;</span>å‡<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="gettersæ“ä½œ"><a href="#gettersæ“ä½œ" class="headerlink" title="gettersæ“ä½œ"></a>gettersæ“ä½œ</h3>gettersæ“ä½œæ˜¯åœ¨è·å–æ•°æ®ä¹‹å‰è¿›è¡Œçš„ä¸€ç§å†ç¼–è¾‘,ç›¸å½“äºå¯¹æ•°æ®çš„ä¸€ä¸ªè¿‡æ»¤å’ŒåŠ å·¥ï¼Œå¯ä»¥æŠŠå®ƒçœ‹ä½œ<code>index.js</code>çš„è®¡ç®—å±æ€§ã€‚<br>å†™æ³•å¦‚ä¸‹ï¼š<figure class="highlight pf"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> getters = &#123;</span><br><span class="line">    getterCount(<span class="keyword">state</span>)&#123;</span><br><span class="line">      return <span class="keyword">state</span>.count+<span class="number">10000</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
ä½¿ç”¨ï¼š<br>æ–¹æ³•ä¸€ï¼š<figure class="highlight handlebars"><table><tr><td class="code"><pre><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span><span class="template-variable">&#123;&#123;<span class="name">$store.getters.getterCount</span>&#125;&#125;</span><span class="language-xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br></pre></td></tr></table></figure>
æ–¹æ³•äºŒï¼š<figure class="highlight clean"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;mapState,mapMutations,mapGetters&#125; <span class="keyword">from</span> <span class="string">&#x27;vuex&#x27;</span>;</span><br><span class="line"></span><br><span class="line">computed:&#123;</span><br><span class="line">  ...mapGetters([<span class="string">&#x27;getterCount&#x27;</span>])</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
æ–¹æ³•ä¸‰ï¼š<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="attr">computed</span>:&#123;</span><br><span class="line">  <span class="title function_">getterCount</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">$store</span>.<span class="property">getters</span>.<span class="property">getterCount</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="actionså¼‚æ­¥ä¿®æ”¹çŠ¶æ€"><a href="#actionså¼‚æ­¥ä¿®æ”¹çŠ¶æ€" class="headerlink" title="actionså¼‚æ­¥ä¿®æ”¹çŠ¶æ€"></a>actionså¼‚æ­¥ä¿®æ”¹çŠ¶æ€</h3>å¦‚æœéœ€è¦æ‰§è¡Œå¼‚æ­¥æ“ä½œï¼Œå°±ä½¿ç”¨actionï¼Œå½“å¼‚æ­¥æ“ä½œå®Œæˆï¼Œå¦‚æœä¿®æ”¹çŠ¶æ€çŠ¶æ€ï¼Œå†è°ƒç”¨mutationsä¿®æ”¹çŠ¶æ€ï¼Œå› ä¸ºæ‰€æœ‰çš„çŠ¶æ€ä¿®æ”¹éƒ½éœ€è¦mutationsï¼Œä¸‹é¢ä¾‹å­ï¼š<br>åœ¨<code>store/index.js</code>æ–‡ä»¶ä¸­<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> actions = &#123;</span><br><span class="line">  <span class="comment">// ä¸¤ä¸ªå‚æ•°</span></span><br><span class="line">  <span class="comment">// å‚æ•°1ï¼šä¸Šä¸‹æ–‡ï¼Œæœ‰æ‰€æœ‰éœ€è¦çš„state,commit, gettersç­‰æˆå‘˜</span></span><br><span class="line">  <span class="comment">// å‚æ•°2ï¼šé¢å¤–çš„æ•°æ®ï¼Œä¼ å€¼ç”¨çš„</span></span><br><span class="line">  <span class="title function_">addAsync</span>(<span class="params">context,payload</span>)&#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(context)</span><br><span class="line">    <span class="comment">// å»¶æ—¶è°ƒç”¨mutations</span></span><br><span class="line">    <span class="built_in">setTimeout</span>(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">      context.<span class="title function_">commit</span>(<span class="string">&#x27;add&#x27;</span>,payload)</span><br><span class="line">    &#125;,<span class="number">2000</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<code>context</code>æ–‡ä¸­å†…å®¹<br><img src="/posts/vuex/1.png" alt="actionä¸Šä¸‹æ–‡"><br>æ¨¡æ¿ä¸­ä½¿ç”¨<br>æ–¹æ³•ä¸€ï¼š<figure class="highlight dart"><table><tr><td class="code"><pre><span class="line"><span class="comment">// è¿™é‡Œçš„dispatchæ˜¯actionçš„å›ºå®šç”¨æ³•ï¼Œå°±å¥½æ¯”mutationä¸­çš„commit</span></span><br><span class="line">&lt;button <span class="meta">@click</span>=<span class="string">&quot;<span class="subst">$store</span>.dispatch(&#x27;addAsync&#x27;,9999)&quot;</span>&gt;Action&lt;/button&gt;</span><br></pre></td></tr></table></figure>
æ–¹æ³•äºŒï¼š<figure class="highlight coffeescript"><table><tr><td class="code"><pre><span class="line">&lt;button @click=<span class="string">&quot;addAsync(9999)&quot;</span>&gt;Action&lt;/button&gt;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> &#123;mapState,mapMutations,mapGetters,mapActions&#125; <span class="keyword">from</span> <span class="string">&#x27;vuex&#x27;</span>;</span><br><span class="line"></span><br><span class="line">methods:&#123;</span><br><span class="line">  ...mapActions([<span class="string">&#x27;addAsync&#x27;</span>])</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="moduleæ¨¡å—"><a href="#moduleæ¨¡å—" class="headerlink" title="moduleæ¨¡å—"></a>moduleæ¨¡å—</h3>å¯ä»¥å°†å•ä¸€çŠ¶æ€æ‹†åˆ†æˆå¤šä¸ªæ¨¡å—ï¼Œæ¯ä¸ªæ¨¡å—éƒ½å¯ä»¥æœ‰è‡ªå·±çš„<code>state</code>ã€<code>mutation</code>ã€<code>action</code>ç­‰ï¼Œä¸€èˆ¬å½“çŠ¶æ€ç‰¹åˆ«å¤šçš„æ—¶å€™æ‰ä¼šç”¨ï¼Œåœ¨<code>store</code>æ–‡ä»¶å¤¹ä¸‹åˆ›å»ºä¸€ä¸ª<code>module</code>æ–‡ä»¶å¤¹ï¼Œåœ¨é‡Œé¢å»º<code>a.js</code>ã€<code>b.js</code>æ–‡ä»¶.</li>
</ul>
<figure class="highlight pf"><table><tr><td class="code"><pre><span class="line">// a.jsæ–‡ä»¶</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">state</span> = &#123;</span><br><span class="line">    a_module:<span class="number">1</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> mutations = &#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> getters = &#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> actions = &#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">export <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="keyword">state</span>,</span><br><span class="line">  mutations,</span><br><span class="line">  getters,</span><br><span class="line">  actions</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight pf"><table><tr><td class="code"><pre><span class="line">// b.js</span><br><span class="line"><span class="keyword">const</span> <span class="keyword">state</span> = &#123;</span><br><span class="line">    b_module:<span class="number">1</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> mutations = &#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> getters = &#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">const</span> actions = &#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">export <span class="keyword">default</span> &#123;</span><br><span class="line">  <span class="keyword">state</span>,</span><br><span class="line">  mutations,</span><br><span class="line">  getters,</span><br><span class="line">  actions</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>åœ¨<code>index.js</code>ä¸­å¼•å…¥æ¨¡å—</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> a <span class="keyword">from</span> <span class="string">&#x27;./module/a&#x27;</span></span><br><span class="line"><span class="keyword">import</span> b <span class="keyword">from</span> <span class="string">&#x27;./module/b&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> modules = &#123;</span><br><span class="line">  a,</span><br><span class="line">  b</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// å¯¼å‡º è®©å¤–éƒ¨å¯ä»¥å¼•ç”¨</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">new</span> <span class="title class_">Vuex</span>.<span class="title class_">Store</span>(&#123;</span><br><span class="line">  state,</span><br><span class="line">  mutations,</span><br><span class="line">  getters,</span><br><span class="line">  actions,</span><br><span class="line">  modules</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>ä½¿ç”¨ï¼š</p>
<figure class="highlight pf"><table><tr><td class="code"><pre><span class="line"><span class="variable">&lt;div&gt;</span>&#123;&#123;<span class="variable">$store</span>.<span class="keyword">state</span>.a.a_module&#125;&#125;&lt;/div&gt;</span><br></pre></td></tr></table></figure>
<p>å¼€å¯å‘½åç©ºé—´</p>
<figure class="highlight pf"><table><tr><td class="code"><pre><span class="line">// a.js å’Œ b.js</span><br><span class="line">export <span class="keyword">default</span> &#123;</span><br><span class="line">  namespaced: true,</span><br><span class="line">  <span class="keyword">state</span>,</span><br><span class="line">  mutations,</span><br><span class="line">  getters,</span><br><span class="line">  actions</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>index.jsæ³¨å†Œå¼•å…¥</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> a <span class="keyword">from</span> <span class="string">&#x27;./module/a&#x27;</span></span><br><span class="line"><span class="keyword">import</span> b <span class="keyword">from</span> <span class="string">&#x27;./module/b&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> modules = &#123;</span><br><span class="line">  a,</span><br><span class="line">  b</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// å¯¼å‡º è®©å¤–éƒ¨å¯ä»¥å¼•ç”¨</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">new</span> <span class="title class_">Vuex</span>.<span class="title class_">Store</span>(&#123;</span><br><span class="line">  state,</span><br><span class="line">  mutations,</span><br><span class="line">  getters,</span><br><span class="line">  actions,</span><br><span class="line">  modules</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>æ¨¡æ¿ä¸­ä½¿ç”¨</p>
<figure class="highlight awk"><table><tr><td class="code"><pre><span class="line">import &#123;mapState,mapMutations,mapGetters,mapActions&#125; from <span class="string">&#x27;vuex&#x27;</span>;</span><br><span class="line">computed:&#123;</span><br><span class="line">  <span class="regexp">//</span> å‚æ•°<span class="number">1</span>ï¼š å‘½åç©ºé—´åå­—ï¼Œ</span><br><span class="line">  <span class="regexp">//</span> å‚æ•°<span class="number">2</span>ï¼š çŠ¶æ€å</span><br><span class="line">  ...mapState(<span class="string">&#x27;a&#x27;</span>,[<span class="string">&#x27;a_module&#x27;</span>])</span><br><span class="line">&#125;</span><br><span class="line">methods:&#123;</span><br><span class="line">  ...mapActions(<span class="string">&#x27;å‘½åç©ºé—´å&#x27;</span>,[<span class="string">&#x27;mutationsæ–¹æ³•å&#x27;</span>])</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="Vuexæ’ä»¶"><a href="#Vuexæ’ä»¶" class="headerlink" title="Vuexæ’ä»¶"></a>Vuexæ’ä»¶</h3><ul>
<li>Vuexçš„æ’ä»¶å°±æ˜¯ä¸€ä¸ªå‡½æ•°</li>
<li>è¿™ä¸ªå‡½æ•°æ¥æ”¶ä¸€ä¸ªstoreçš„å‚æ•°</li>
</ul>
<p>Vuexæ’ä»¶ä½¿ç”¨</p>
<figure class="highlight arcade"><table><tr><td class="code"><pre><span class="line">const myPlugin = <span class="function"><span class="params">store</span> =&gt;</span> &#123;</span><br><span class="line">    <span class="comment">// store åˆå§‹åŒ–</span></span><br><span class="line">    store.subscribe( <span class="function">(<span class="params">mutation, state</span>)=&gt;</span>&#123;</span><br><span class="line">        <span class="comment">// æ¯æ¬¡mutationä¹‹åè°ƒç”¨</span></span><br><span class="line">        <span class="comment">// mutationçš„æ ¼å¼ä¸º&#123;type,payload&#125;</span></span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="variable constant_">store</span> = <span class="keyword">new</span> <span class="title class_">Vuex</span>.<span class="title function_ invoke__">Store</span>(&#123;</span><br><span class="line">    <span class="attr">plugins</span>: [myPlugin]</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<h3 id="ç®€å•æ¨¡æ‹ŸVuex"><a href="#ç®€å•æ¨¡æ‹ŸVuex" class="headerlink" title="ç®€å•æ¨¡æ‹ŸVuex"></a>ç®€å•æ¨¡æ‹ŸVuex</h3><h4 id="åŸºæœ¬æœºæ„"><a href="#åŸºæœ¬æœºæ„" class="headerlink" title="åŸºæœ¬æœºæ„"></a>åŸºæœ¬æœºæ„</h4><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> _Vue = <span class="literal">null</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Store</span> &#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">install</span>(<span class="params">Vue</span>)&#123;</span><br><span class="line">    _Vue = <span class="title class_">Vue</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">    <span class="title class_">Store</span>,</span><br><span class="line">    install</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="install"><a href="#install" class="headerlink" title="install"></a>install</h4><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> _Vue = <span class="literal">null</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Store</span> &#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">install</span>(<span class="params">Vue</span>)&#123;</span><br><span class="line">    _Vue = <span class="title class_">Vue</span></span><br><span class="line">    <span class="comment">// intallä¸­è·å–ä¸åˆ°vueæ ¹å®ä¾‹ï¼Œé€šè¿‡æ··å…¥æ¥è·å–vueå®ä¾‹</span></span><br><span class="line">    _Vue.<span class="title function_">mixin</span>(&#123;</span><br><span class="line">        <span class="title function_">beforeCreate</span>(<span class="params"></span>) &#123;</span><br><span class="line">            <span class="comment">// åˆ¤æ–­å½“å‰vueå®ä¾‹çš„$optionsä¸­æ˜¯å¦æ˜¯store,</span></span><br><span class="line">            <span class="comment">// å¦‚æœæ˜¯ç»„ä»¶å®ä¾‹ï¼Œæ²¡æœ‰storeé€‰é¡¹ï¼Œå°±ä¸éœ€è¦åšè¿™ä»¶äº‹æƒ…</span></span><br><span class="line">            <span class="keyword">if</span>(<span class="variable language_">this</span>.<span class="property">$options</span>.<span class="property">store</span>)&#123;</span><br><span class="line">                _Vue.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">$store</span> = <span class="variable language_">this</span>.<span class="property">$options</span>.<span class="property">store</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">    <span class="title class_">Store</span>,</span><br><span class="line">    install</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="store"><a href="#store" class="headerlink" title="store"></a>store</h4><figure class="highlight typescript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> _Vue = <span class="literal">null</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Store</span> &#123;</span><br><span class="line">    <span class="comment">// æ„é€ å‡½æ•°</span></span><br><span class="line">    <span class="title function_">constructor</span>(<span class="params">options</span>)&#123;</span><br><span class="line">        <span class="comment">// optionsæˆå‘˜è§£æ„å‡ºæ¥ï¼Œ</span></span><br><span class="line">        <span class="comment">// ä¸ºäº†ç”¨æˆ·åˆ›å»ºvuexæ—¶å€™ï¼Œæ²¡æœ‰ä¼ å…¥ç›¸åº”çš„é€‰é¡¹ï¼Œè®¾ç½®äº†ä¸€ä¸ªé»˜è®¤å€¼&#123;&#125;</span></span><br><span class="line">        <span class="keyword">const</span> &#123;</span><br><span class="line">            state = &#123;&#125;,</span><br><span class="line">            getters = &#123;&#125;,</span><br><span class="line">            mutations = &#123;&#125;,</span><br><span class="line">            actions = &#123;&#125;</span><br><span class="line">        &#125; = options</span><br><span class="line">        <span class="comment">// å› ä¸ºstateæ˜¯å“åº”å¼çš„ï¼Œå“åº”å¼å¤„ç†</span></span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">state</span> = _Vue.<span class="title function_">observable</span>(state)</span><br><span class="line">        <span class="comment">// gettersæ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œå¯¹è±¡ä¸­æœ‰ä¸€äº›æ–¹æ³•ï¼Œ</span></span><br><span class="line">        <span class="comment">// è¿™äº›æ–¹æ³•éƒ½éœ€è¦stateå‚æ•°ï¼Œå¹¶ä¸”éƒ½æœ‰è¿”å›å€¼ï¼Œ</span></span><br><span class="line">        <span class="comment">// ä¹Ÿå°±æ˜¯å¯¹stateåšä¸€äº›å¤„ç†ï¼Œç„¶åå°†å¤„ç†çš„ç»“æœè¿”å›</span></span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">getters</span> = <span class="title class_">Object</span>.<span class="title function_">create</span>(<span class="literal">null</span>)</span><br><span class="line">        <span class="title class_">Object</span>.<span class="title function_">keys</span>(getters).<span class="title function_">forEach</span>(<span class="function"><span class="params">key</span>=&gt;</span>&#123;</span><br><span class="line">            <span class="comment">// é€šè¿‡defineProperty è½¬æˆäº†gettersè®¿é—®å™¨ï¼Œè¿™é‡Œkeyå°±æ˜¯æ–¹æ³•çš„åå­—</span></span><br><span class="line">            <span class="title class_">Object</span>.<span class="title function_">defineProperty</span>(<span class="variable language_">this</span>.<span class="property">getters</span>,key,&#123;</span><br><span class="line">                <span class="comment">// è¿”å›keyåœ¨gettersä¸­çš„åˆ°çš„æ–¹æ³•è°ƒç”¨çš„ç»“æœ</span></span><br><span class="line">                <span class="attr">get</span>:<span class="function">()=&gt;</span>getters[key](state)</span><br><span class="line">            &#125;)</span><br><span class="line">        &#125;)</span><br><span class="line">        <span class="comment">// å°†mutations å’Œ actionså­˜åˆ°å¯¹åº”çš„å±æ€§ä¸­ï¼Œåœ¨commitå’Œdispatchä¸­è·å–</span></span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">_mutations</span> = mutations</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">_actions</span> = actions</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// å‚æ•°1ï¼š_mutationsä¸­æ–¹æ³•çš„åå­—</span></span><br><span class="line">    <span class="comment">// å‚æ•°2ï¼šè°ƒç”¨æ–¹æ³•æ—¶ä¼ å…¥çš„å‚æ•°</span></span><br><span class="line">    commit (<span class="keyword">type</span>, payload)&#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">_mutations</span>[<span class="keyword">type</span>](<span class="variable language_">this</span>.<span class="property">state</span>,payload)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// å‚æ•°1ï¼š_actionsä¸­æ–¹æ³•çš„åå­—</span></span><br><span class="line">    <span class="comment">// å‚æ•°2ï¼šè°ƒç”¨æ–¹æ³•æ—¶ä¼ å…¥çš„å‚æ•°</span></span><br><span class="line">    <span class="title function_">dispatch</span>(<span class="params"><span class="keyword">type</span>,payload</span>)&#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">_actions</span>[<span class="keyword">type</span>](<span class="variable language_">this</span>,payload)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">install</span>(<span class="params">Vue</span>)&#123;</span><br><span class="line">    _Vue = <span class="title class_">Vue</span></span><br><span class="line">    <span class="comment">// intallä¸­è·å–ä¸åˆ°vueæ ¹å®ä¾‹ï¼Œé€šè¿‡æ··å…¥æ¥è·å–vueå®ä¾‹</span></span><br><span class="line">    _Vue.<span class="title function_">mixin</span>(&#123;</span><br><span class="line">        <span class="title function_">beforeCreate</span>(<span class="params"></span>) &#123;</span><br><span class="line">            <span class="comment">// åˆ¤æ–­å½“å‰vueå®ä¾‹çš„$optionsä¸­æ˜¯å¦æ˜¯store,</span></span><br><span class="line">            <span class="comment">// å¦‚æœæ˜¯ç»„ä»¶å®ä¾‹ï¼Œæ²¡æœ‰storeé€‰é¡¹ï¼Œå°±ä¸éœ€è¦åšè¿™ä»¶äº‹æƒ…</span></span><br><span class="line">            <span class="keyword">if</span>(<span class="variable language_">this</span>.<span class="property">$options</span>.<span class="property">store</span>)&#123;</span><br><span class="line">                _Vue.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">$store</span> = <span class="variable language_">this</span>.<span class="property">$options</span>.<span class="property">store</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">    <span class="title class_">Store</span>,</span><br><span class="line">    install</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>webå‰ç«¯</category>
      </categories>
      <tags>
        <tag>Vue</tag>
        <tag>Vuex</tag>
      </tags>
  </entry>
  <entry>
    <title>å‰ç«¯çŸ¥è¯†å°å†Œçº²è¦</title>
    <url>/posts/e5b77e85.html</url>
    <content><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="å¯†ç ä¸æ­£ç¡®ï¼Œè¯·é‡æ–°è¾“å…¥." data-whm="æ–‡ç« ä¸èƒ½è¢«æ ¡éªŒ, ä¸è¿‡æ‚¨è¿˜æ˜¯èƒ½çœ‹çœ‹è§£å¯†åçš„å†…å®¹.">
  <script id="hbeData" type="hbeData" data-hmacdigest="aaa2d859933cc163d5d666a0552026aa83354ee5d40c0a3717add6fffe31153a">17722e3237e47d1ff24ecceb173bf7da94e27a41fb2bd5718bb61dd30c987daf79f6e0a94c26b0bac82a19b05ff1fab34e48ae003a6b9f4ec083e7fd9681030f7f555c264f503dc775a7b720ebf456c2494644347c8c43c62deb1c52eba8a1d45584df239dec0e5b7a5f723dda57d3d4547e3a26ce280d538e63c3de0391c68d6e631aa0a60267f051d1acf47cb36a049bf2ee41c2fb43c7c6ae829adf131c8cf96b79a43f25fd0172713e1fd6aba64772be0dbeb28d11f5419f9cc68f40a556cac08fb1470dae48cb924de190991c672eb481cd7c0b864deffb479b8f92d20233ba447f67ffab03efe3b177876264628432045840ab648269d315e13f74cee51af4c51371f0d4e047bacc5813408d6b50ab81c95f3935c2a7873c5c2c493b67f690d587abfc42db969978b029e3316da15d1e8d9d854b288388d71086316e9e9ffc62fc863feaeeca52ae140abdcce69fe801b63ce36b043e6c19e623912fd82e2c73e64b1443854410f6dd884b5faf0e9c3c76b17f9f597ccc35981941a9e279de2fca4c40a72f00c1b17a9194ad750d35e7989000024a2f87c3721c8a48578695a784f7746cfc8efcfed8b7427be9de1f434178ad5805c713c9f04d986745e5bf818bb280510ce8f6b760455f076535097c5301683260a7b79e25e207a12374ec3aa4c9e6296de7ef02d7d9ba242c6bf429ea38ca7800d9c5e0ff0149cc7fda876d57f2f718cb770c5038c8586fba0ff77bff354d4650617bcec2618bd0d2285f8709a62aef50c2b7a61ae5cdff706b2dff2b03e0647795739866502a49a6303af1e6cf30aa62abcd84d433e1b8b2da2edd1fbe83f403bd1c69c5cbcc66a2f9e5980dc58acf104522b500fb764cbdbdd146210bf5af26c54377814c3afa429c852f804b5f54f84b401e94829e59daaaeedff154c61dbbd5d1d014c3f221ef381935a12831c999a71143ebd47981839a555ba22919d77e5ff079a76eb285a61e162799b8565fc17db9e5b61fba6162ca9108d3c0d2ebe19dff3fb46b90b46f0b540e9696390b84fc860a18945fe84225127c6ade0fb987eb37bb0af00226fe3bb3f19fb5f8af21f6308e20b6c4b3472770dbbc5b8b4d11874acb2830781b4edec7be025201b15294e53ae51bba37cf1f2e8ac35a0b291220338838054d3bd9da450d17569742c1da932947db6aa9b035d4235e04776f231e4b77c5c79c6b52c20045f986ff38aabd75e48ab09203a9b93690f16dbf7abc3025f5852734e039f248cde2a27cabd48f7d2ac2fc994a0ee3422675ed6abf4a9132f3c03591f9213464f0c1952e030fe42a134988a8135e89f3a3a10e0d76230f3445277069633c4e8a6e6c4ea3229a4799ec60f8e49de31cf41a6fb1307a7dcbfa7e76f20188885389b73aa84112a87b0aea65ffa132fee5c6ad9b161d248d60844511ceeb0a02cb3cd029be452184ce377ca099ddfc4ccba77b73d476f6139b3b134f1f4cf4d3c3610fb3e1413003fae8942641cfdf5f828bfd52532852f0aebf7850608c192b6b88d696a26c15b0795af9faf7d1fb32e827f94a3900368124dd408a5c9da8dab14e40fc2b94f7c825ab6af273b46e5132bc3c4f909837ef4f099a8c18466a0c4251d38a4ded7a69b8ffea1b97fe908ab26affe2d247c203bc903e7d3e71d3ccf21c68e0016e9b1dd9aa14a1aad18c318aa04d7c6b419e72334a4a6dae9e11b1bfd7adc8186910fe2c48a6ab180508990090d8f4761af343dbcaaed364596420c1435cbb0cfa683054512c7d29b4099b4ca278dba6d546027efdc31e016bf9b8f3e097f9083c25a6980271d986fbd5cda8ad4ee9190bae0c4cc25ed29240e588fd0f0f543b2f3e2c263e4e7953c63f12d95507f75ee763ea2dbc5b7a2b4b249031333ca432655d4e99a4cedf3941e1fa5240fbdcc23497a171fee9be180fd69b832ec1f7c26ff64db1be6cc4a68d4b722485cb551d03dcf7a23572cfe607dc669f9e962b93e66af63d1c045b981007132a26c2f76f9db86c3eb028168a7c65ebb2a7e203ff957d3099d36652affe6b5a243b69d8f46d88431516362dff7d7ed7d829884a01f159e42fa71882afac40b5f437252db4e23d8617d9efb2dcbdf892aab7f5b87aa777d50cd5a2b46d9d654bb48e0b99dddea1d72b27c33c44a345c6f46e2ec17186fa65da75c5abb4eb82bb17679f2d1ed2c9084270e876f04a36ef6a92ee8cd5de1b0b9fcf862efdf5b6e2e1c4c252e26e02308169d3a1d40a858d76e632699913b94ed78a45cda913bc759434cd0ebcb9cba79869a6c4fc8319a7c85d597319d683ca885b87346e4c868d4ad7cd67224b335986db55ae354744fb5fa612a086ffdc138e5ca070bfbe37dd30ffdbcfbb9a4d44cc729cfec11f435caf3b489312631d2853b2bb8a28d3ad31b42f363949993c5308d19733c6d9b539d7337b634427cb721446f0da8adb084afeef02f3bb89f027e2ea3ecab60c917a2a296642a92f336f972ee8f70835ec4d254c7cc372ccc213621aeb07e8338d5ae97adef4bb6814e6bfbf4f56b44ff13778532015e62fcd7fd5c7288d1ecd22d1624f7eb8ef950387e220a79b951cbaab2e677ddf361643bd558b5bad65b274c1a09cf39f2b1cee5cc756d132c122c7cb512f09d2977497f5a12da5959cecd94f49a48196811edd4bbdd31459d2db3618b3d9206869231ac30d331a9130541c6a29829e878ce15dcdb821db7968ebb9786db170c9210dfaefbd90e1498a5f119827ba1d9b807e1d54d1980854cc21f4e504f5e1ff698d77d5350b1d9152565bbe13eddac6afae31c2d3b6e15214b475286c834ef6556fa18ef55a994c6036d23180f6cdda98b7c90871fd00902168df169f7f09320586eafa3f912c29f366deebd55dc79136e3576698027302f9888fb081037ebcce1ec52235e3e71831bb00024a013933a62ca328cf4bf4d9314a9d8b8822a19ba91e351b291c0b7279b0e7379d7b8a4f3591e1e1501c3fa89882704c364786997936cb7ae9b1672b5dd390942a260cbd6ce4adfc40cdb757454b5f2ff36dad76bf0557a97572ceec0e7f490a6aa1620bad848625b1f22eca50489f9887cd33c36084e60cf180fc25151049112bcbe437fcee74095498e144f927965947f719d7a9b1c5318a321a0f5b098960b691872e47da3d8b1bef57d712c24fd65cd3dfedc5f2354e2dea3e012336bf77fb4e19ce42c09a4d61cb4857e1e6ef441fe1d0a7f05c69381e89fd13179b277cad15fa096660cc6852645c5ab0100297254dfc6ecd338ac43ac8f35f608a87388a07d517a13de257cf05706a8f8b3ec0fada55b2ceda99fb01bfb79faa93fc8607b8dd10c1b0ec2462d9579038d0be05677f0393ae124b79e361d34ee0cdb008175e950a1cdbd46b4f7f0d7ed2ffb810bd9dc1d709b14e559bc3a03be6b52c93f5454774482d425d18cb52fa071b3e22a65acadd8ed12ed4f4f9f3afa183cb8eeb121d18635f0f5905e0c7837d25f09584112c0b0d2f468aa90b51819a07dceaf64eb7d6fe022797e4e4895a1b7424d4826b0ba4ed3fb30e3713c7569d5f30e8e195ef8f357a3c88e757a15812bd2ff9340bb820745ba5868b93a9a0bac13cbf83feb0f610d7fd1655181423f22c8521ae7244358f68f3d36b9c71ada098631431068d0efb5941af56151e062f9714d579ecfabf7028c322a29f5e5be61c2758ea68be01178f5f20a45675e1eff75c2b7f18c91a72f015ff3e7ca7f11ba038d3931d6128551b6b283e68cad36adb28d733fe093eb45801d7940c59bf3e1a135bf82b5c725e9a55a19fde757bad9572f1324a07a8fd64ea52dcab8259f9bc659221b0f8457036add3bd0ffef4bfa51594898a981480cb1e9a62f1a2cbfe7a9f410363317513039a9d40d098b19d526628aa08fa9030ba2a522bfb74b09ece5f4e8d911b6279392e0a0e4144420011546b087a04e54747c0c4aeefcb6d89ba0332410a7ec7e701fb2b51d41ebfcca570cb98a275e4feb461c8c898c7581dfccbb088053a27156213c017e3fd436a69a18e19df0013c062f55ab8b4b1e280aa9af7fae4d7ae7108994424149b717e084a355e3b00d2e15e77b4077b15bece5d754cef0d78703a993e9ca54360186b80a4a66f7ebde5445d659981513f2276dafb89fde8e82911244098351b001087edce6b47836c78be76769433799d3cc622e297721cc1f6cdc6646f6382619e0e865f38de1ce92c0d0c9f6cb76cb6a3895b2a11072e5c69f2c9435e3481157d120ac8441bdb886413a09d7d89fafd029a000aa1748711b42f68008ada33becb850af94a88ffc122b89d55da78646ea8a3dac3d7607951a59d0b1339ef6a51f87dee03bbd46f86107f8ad6b3306a4f4e8caf44019cfebd055c95a3e86b9c93bf58c7f1949e786d068c583a1e272545e7dbd3643289e069b370843e9902bee0b62aa79e71014b24f40c5a12f55cef9d65a5211de845f6c3da9c13a7c304f382aa298e54737fe176bf60bf3850ec63c42a2da24f9a4e8b505ab6efceca5bde360c45e52955e1e46674619ab0d59eb696a02e93ab2ca5ca964e35519af5c6bf5ada554605547d6dc9c303ce9988d72eec1e00e51090417ded5da1250e9b0d176efddec724821a924a3a56fc84492b17be1f3e4714d67661a1cf7cf875df09a2e88d323f45ceaba775c03516fb82ffeb4ecf33603941b3d2bf14369c2de3c2078ca97b190b1260d9496c68fad4b07a4d64df536d0e2bf4645c4db66c1850c2492193e80e819a464bc60b513f512b1bd8e148b05bcf443a0122988ee9ce5fb70be380d9893ce666351790ccdbba00e4e56ff2be5b3d71a622df65d00884f1af4ce228db88aa96a91beded482d5be93d9bf894164316bcb516ee0852a305aab20f314d21c6008e89e50b6401a2ac145c5cfe0ef5f17ccdd6a284919be41cccd3f08c647dd39d159b38b7ba7a6f8f96143a0a98d21367efb1c08116a8ab2dee4dfcc7e1ba82370244343d3fff13fd2996392bf7a99adb677d2b36ab8fb2945fdafe85f4262e850aff0e94f16b34fece7211674e31bcdff4f1a62538e1a1a3e2be2e8a729da403d9dfef3e99d30ebb5f4d5828a3534423c81e0b84957af23ab8b2dd0f2b886b9939883ef8533c3b3583791a4479c38623010a890e7f7f84bfb4a670c134ee9a966f7e157294c2c39631104d26ab3831e545f4d025d73dd4694ee28a19690e111790486827e7f165f51d3647a67f3fb61c56c4e7622205f954018fff01654c3ce53f6a7eb4dbf9ff29f1757d5ec453843d3bca5356fb43332be7e2c0e7051f09697c27912162e2e072d40d1c1f4404cc0a356c63cb2acabf3ccae4b6b8b69ab90e630de15325a87812af84a1db4061090ffbb624d87bf32640ac7901a6830ca99f410372cb2636a8a5c21614324a0a18dbeaa7ed930d9640b0e8e58777d0e5d427d8e832b5ae9efed0aff0546f77b5f82e8b0a2391fabc0191d242d40040294d30845a48bf7609889d699e2ea79b892585ce56fc931ad02fc5974d5ae9aa09f78665392b7acd44d0dfb7eea9672b21911ec3018d024c8e456044c987d4c7165996326b2ba40bb311377791c2e4b9de8bfed62694dc67b505fb616328861a91d0fd937072c6166d051ccc2e4c805adc85fbd5bb1c6eaab3447aa54ea26a447fb98a95d9c925e949efb8d8148053a27fd246314b14ef199ff4d7c9e7740970841ecabf16c9b854f94ddec0d4b23303e373aa38e238c0410f584314e7d254574538998335aa9eac29414d0d494a63f78a4728c69807fabc1fbd30265fefc0d973c46d819fb188c60e4ce473eff904a10269f23abea7e615f7bc2b4d626d7678229dbdb09bef09baf4373e6d5247e2871df2082401936028d9703da3c164307ab60e30842b8832e9c438c4c3fbcd9275d89b42962249a4da15736ace7d801728fd7001a19380d7299640fbce5334ebad2c17baaf917b4eb7c179e51d8a5ee677f6c708e327a78cdc62fdf7b97af1fa2700d7a1eca730db9d9de613731916de4fd68a4e871a763c08ec735ef4915fb701ca4ff2512f37a782f36bd80d71ec7220f57a8127624d9c4009050a99907ceebfd0dc8ea69605716112eb8c09a2fb8b89f655b25773b73557a07fa8ddcd930cfc969bb991b55a39af7717f21344793301f8a09f475c01aaa2831074e8e96db58b573f5a3315398133b37158f6d50d01c4c6f5f27d52a84da75c52f96f5d1c80cb80f02914c9221c98aa722f84f64ad3f840232777929c985731cf413ee7f0b10e8239a76833b51d38373c45aef8d4fd388516686365f0ad492bc3accbce1e4c85635cc174f4829b116d214001c1c1f5bbbaabc8b649809f7ed6b74b4839d388fb5d8c5065a26c065f6253dffee0ed5b990981db0131bdefdd51f164c87ea167dbe3707602a5f8475df6e05b18e02abf607e664f915cf9df8dd4aee8ec079e3c9a96a4aa1853b2f476e3ed970814eb99ee1a6c57c4385f5dc97c643dbcf18395901c7f3c13f1570d3b1575aa2bffcd41edcb7049d8cf18c825b65d135f77c4e577bc76e33ef5695e4dfed9f90da2441d220065c73c687122348df0de9629cd43ba57baceb00d3d50570297ecd5b23f265ca32fc57c9ed9b30707f23e7134784a5a0eedf1c70ac93c047c4ac6679ab9399dc0fa68b6220f9a21d014c978c717a83b20eff6c3cbb0693d4398dbd987deb7bfc9c0959fbd86799f40b473a7f63449c22f62c06c5c8fcb169ae4d422f2f3b6b4313358621df01204bafb0f97305c226163a87545e3fa85246897d0366daec00f21db4128944dc91ae0da90f5b248a33d5a6688f990370c5f5d3ede05f49cce7a0766227be5dc34589c30b6b165110bfb50dbe0a52748931e9d017c419d9b9c0b1346c240206410015cab2aa49f520762105aec06e4ddfa6dc941a29be132294fe88f37a128044a941b6e7471bf6f63d79db2e29f8e15c0060ec2c072a2f8a973aaffaee663c8f8c515afa4041abcbaba04ae8e19edabeb478a83916525efb5e664790653db70be67cbe3f675343b70c9c2e046ab817cdbd18e368a36f5e49208a44a5f1653a67c912864827fdabfaaa6054d8f700ae828d372dd9c14213b0ef4ce3fe280858ba590a9ded22ee27bf5de562d201d7cdf4f65ba7ea74c1b5b8b8668b8612c0ee6e2494bc8a2add3949981ed9e97c69109dfd8f6fc171ba0c07d93140d9b5a4712844d028ac5802f7bb76ae79cde1f4a0eb0703eee0adb7cce5e81a0d953cfe825e183e8f6f2d3eb5d66a1a2c84ccbb5dc1d884d947f6d007b825bae7f0d5e0d08aa4ffea391d3694475844e2d535056a43a45d82875f921a245452c166aaad2a192e625322a6baf0bb3d4c9ecd092b3cb4ba3fbddfabf4daa4c952fc4286977bd2bae4b74370e4fa4e7a5e453dda0ed2c3589654a204539514be1bd055dcb130077a29914fa099b1cfd721edb3d18946a4d4c90ae9af05fd1b356daa403739ba2a704829fc77df01035275bfdb0a75813c90a8096b3b416eca59c9d62c0bae5d6b4c7511ffe25d40e41d5997af2d3197b38792c8a7c52dd9212f8684f85188e234b129c290bc2ae3dd2134bd243e5ae1e4ebb1c638b2b4830604681f711c3fc289fe87f4026f30d2163f7679ab6a023952e0bb7e7d57fb26a217b58f4ab2a99b313b5c8c5821d08bbc3918f8ed1d615d855805223f356863da2b08b45d3f20e3d542d6faca5fd1a9e2a665904efa515cdee9a47351d9a432ce5b249facc898a2c452d94728d9a7b9fc52dd16cb2c39623626d99a90c405fabf3c745d90e7e41dd3b3248ce237f6a52c3719d0c1d621569baffb774b85abc031929b9b1361b7a28bac56eb5eb5395789f6030f69e662b960d0852886d096b3a0842304a12d2afa07ecdd5c27ecf3aa3bf5f496de8cc7beb260525069709f1f6f763a482cde0511e74d6045dbafdb43b9504c0dbf26c22aaa7c81f3bdf43faf832569c1c3251e4a9fccf4c26d19e4ac1dc3a3cb2c66480910d4649ecc9fc290b75b11e792aae23eb94ce8bd0035d37b95ccbf3b99041945184525bc7e7a30f0ebb787e5f70ff6fb3042d6f3ace3b6bf947eb9ac3a81d8d2c394f62a2299b39e974ab75b0b337f03d37aaef694c94f25cefea647e4dae795988a1e6a3d4f4b615e15858c012f4eb46aacdbeebeb09b9c55879db9a3a54fdbab4c25b3590d8540f1b86ba20c5a191ff5fa7b6550d3ac4ea0ce6a950f2bd7963f78cd9390d52efe4df29ae276838e23ab084edcc195b9f20cd3850b98c7e289d1f13200094802ae1b8378b8872a4afce32fbbe361e66930cf2d0fc84a4a2ee91a2b23a7f81d27172e28be90bc0e204fa7f92f583dba001c925d4eac29b2f0b8f9d7a28f5f7139b5f51d160fd72a399b984d1248605c9832c66d7e0e077f82e0adc6f1df6d8dbfd23e9a3f2ad35175fda70370b10cc099a7b8efa5bd74a755c1e98017e0aea7894bec870895ae2f3a875cc2ab639a37b2bd2d352fb65b7a35cac5c55c204ac089c27c42110e40102a67cf18b675b1bb854aae0d30b801cf73e6a6761f40cdc2339ad04afffd62fadc815d41ef331f0dde3bb25968bc3f5c5f8adced7217d693e1a7671381abca90886e140f7099fb972e7d58ba7e57e77ff04a4aa81d203b1c8a10e73c0d34cea098c711cc844cc38cd08289f09a149248e27b58d3125fc16d8a6eab49df8c083736f1fa019cf0f5563cef0fedbe3186c3e4fa6cdc394b3b2bdc2818e32b7b5e84194f50c05953974006ae8174b8fea451f28fde7a56b2d0eafd77cadf9cdace8fa6c9d735eeebbd26d6bf882ba7a6f4492d6c09a0b78bb00bceced75583de489a609ecdcb44c64bf684c056beff7bfc8e92fc0a33a4e57999a24225d5e65191a16c5557a77bc24c40e9f6a7d08608ec89ae257c2bb78cbbbeb15deed24c59e0bd6554b74fc525d5e3ab12362c495816c01dce81a76b655a38574e66b5811186bef9255e65f601e73780b8246ce68577b3a5946d298313ad303e17c14604d8f9c673d4b84288599b04a40587d03197924c428b712336c678f1c6312c31d6d211f50fa6ee41d66a0eb14b2290a52d8e8ed841a6a119277d7250b52a027a4746bb087288fe4de610c0da5d679089cfc712c2f5de565b6b12b84f1c235cbba1c67e7b1f1904bd43ecf6d45cb84fffabe85095cdfa34e9b683c872f28527ede7cada3d6a469be91d4caafce424837640a9cec008874ce162e78edc5188ad83a67aa358559a51724c77886189e269cb40bb9af7bfff073057f53cda9c217d57a14ae9abcb23ea676f3816a5a1fea2c8da735477bd6a42489971f486bc98bea0b7fc7bab2cbbf5366ec25d7b5cdd7f452d7648e3af3b7253dc679ab68ad46a75be519a299659fdf20412d0850bc09aed231d93acdf6febf08917aa523dedacc6554607de0d4a87888e0152373d27da0ba7b0a0ffc04fd5e40b0735b0de059e75f72cf5caece0cf9716eb9374ecfe7e4cb12bd6ae71b005db150888f40f6ee43d89a01212199fbde0d9baa5c442fa5e182a4d6e97451aee3842f1c99c61e01f9c303c685aaf81a12f1f4f8379fcf90cf80e5ccebde2e1eaec6ca10af523817a5bd31d4de51df0fb1590fbd6139dac6012033ac8fe05cfe6f93b104daf714aa32f7f040bc831949a27469490b56cd0260658002a2a31fb5423a026e4c76d6d3facdda5b0fbecfff903311b37a203be7d582d1988a15c67d444e56898a0d76f39a768729361044af79ef9b604e925a12b5e2567541ce1b9d8f431ef0f81381159b59ea23f2fd6f03acd40b9aea38f4d732fc7096e39bf4f37ff79f600808cfeba84d7df17a91e2bbb7a74d17d26bbf2708108a444ab9f74b08ed684a5f8c8b70a67de8d671b2cb8e785a2b568d02e3f79dc5a0702cd78760dba7d1c514aca27b3a1e1aa2e2e6bf9e386dd85d9e994be8bca6206860ecb20589b98e13d4100f85d9905e0358c147c9a39166e034e07487c2a23cf99a324e67aa736f1c28c138885393751142cc78088385961d9fba213f7b742ca132b5a95e7dfa1fad3a7402fc5407efe415168513f30124682de3ac11b366f8a5eef509ee82a0137c03cc4034598f8faa9422c8e789f5675347feaf0224c938c09456a313076e69e392ffc5dc983b4db05590a2b79c9ddac2cf42d59f5b918f06191f8a44b03fd33c35401bca2f76686289520b0a3df318b2ab0ee36ed3fdba0fc555e6cbe963b5695e79d443a838766efb92925c0ffb528cb2fa8fd665ef8b517876c8dbb0bd7a9f9c97e2629598febd9ae4c4ef344dc01c21e36dcf22fd82f6345043c99b34a6f4b195ef2accfc955b821a073896645d5452ccaa67fbe7fa25b84e50130586b228f256c3c3eb47c81d4a3a8c2b2fb2f8d25e6d86085e249e394ec6e9e7ac113c9ddb329ea9d44d016ed90c46e83b0ffa0fedd893cc8916db6d6812de5552ca6b6e31e858e8ca3a4e97a5ba76880ba778d7ef1ebcfeca2b774cb538fd5934ca5ddd57bf1903611d5424e969dc91f92fc16977e2b467d28c1f59db4882b01f9fc1b476b8ec44eb71e80d8aebbcc3141808c01ca989ba72b1041fcffc52ef852bdcea1b71e92999bdb54e227c7b42c313c8ecadbb1d838f55ade53ffd6277c641ecdf8539b32ffaaf1b62f2a82a6e85b1ddb948030fa8abf21844aa9a5e5d3865ce43b2b33257c27335bfe8080c4d9114b9f8eed8af47baf5ae4dab1d96f4649dfd0e4ec73b5c03977081711025851e08bc0f28cd5767f593fcd6f341437d8c10c8ddc706ddd4aa6d9a0b4e1d121d112ab7eb2264303c037b07c14d4e748c9acab1df55538b29926974eb991117d15c6d9abd37a48ed177083f15ba742794ce12fb56c4da906a9a2aca07eb7fed6eb9698dd5fe0a159a4207996ca41011a71aace4a6c760e69d329c54f680fd3d6e0fbc84d289013960bf4c31213d397a1ba5292fde0efa6e41eec47a89b6eec75a9ec0285f2d84acd039d02bef247d1b197d79c37fb6a6e467dc7aa0279f2f277fcb0044e1c63b3a61c7a9bda995b9ab97ef92950c8989517c3ca006e6f73708bdd4377732bd6529ef6a3a434933949d5b9d49eaf650c45f8dec1befb79c1752204668a180b1b4ed5265beac6dff7a1b5edc315400b5c385326abcf38077ddc1e394e0eb9bedb88d6564223abcb128c1b9c6d176a534e9e5f1551e516df1553eaf1ec7c685c25ab6a272c3dfaf259a560c6bb73e8a43369f57491e491c72b97f0d888224cddf7331bea2d9486dbf9dc5c8233e9446632945be19c239df3b62ec4ffa606ce00800784003a05563d31e0eb05f92d719304b1dd948733f474da043582de0a2ce2945fbbc4f5fdc768c8b14aeb6c3116462712656a842e03820be4f3f55f4134b854e3b2fc97f40e57c73e5d7cc3065d1b2c3ef9f83c536fcd21cf760ff19ad0a4a77bd07ad79e99a450290638bfa4356f8d0c6a5b73dd40784575bd89d568a893673538ab3336b0717e382f84cf413221d5c11112067e4920bfc353d8de76585982fd7229254d50725189b081e4286c2075ddd9daf8b04fff59d9bfa09e4a014fcecdce0430d6b0e91bb3f0ec16d9a39869d487862feabdadf71e0227cf67434a9e8334c132e44e19ed1a9e8bd40c7125dbd5ff1091509e8a1eb1157b7761a3185321f94bd5f3563e2ae406ed35216686372a1530ac9cca66b73c3abba0738742ee8281b6a9af5ff77501175a7c82bcecf526d2b395068ae12424f3f441371395ae20d1e693057706f23933237329f9194bfd748dc9cf7878a82bacb99676207b98f61e93d64b50349f650317be0b75d5772ba1287bd0eeb7becd9dd9c9b77466fae3b0eb99c3daf3459d1645c1ee397c86e71f84ea2822eb74f281bf6e547cdf4681a30411a1bd0bc67d0f52ba40d349f7d6238a04e1114835473a0e03fb1a5cc48b6210bc5a05cef01aaa867bc0bde163b500543eab4044cbffa2d0df603f7028678d35690f053ac9fbf8e6363646ccacd6822a89497b96c0329b2b9d9cfe2915cc21141a9f5a3c6b0177ceb44ac68b779ef3eb38155ccb0385ba503f9a7df2bf7d3a9d209157fbf095e2c2151940220a7f6290d8441144b34450550a9d6fec29a4eeef7d630f9e1bbd6a9fb304aca8963fa22ef6667973794a80f2bfb6e657bb50cece62c9d31a8c0e8650a6ece4075f87105e30fa4d39d556f8812c722579c44c26143a87750c75e5e2fc9c284cf9ca48c760a3bdb9b9b837ef44162460957ef18db7dc85ef53898e043041f9e14931142e87e5c68e256eecbef48b83124ce7068c257ff370e2e46fd24045037886efd0761b489263ce596b5c6acbc20639628ab2356a9c5e301e254b837c6f52511cc97780308a8c6f111000db5608b41804de1f7d0f09a4a03bfd6c976a55267951578886d46bc5a6067e4eafe87441dac991494b536b7d20330edf927014417fcdf892319d078f879ea6b83ad7ed2f493a5942edda5d54821c77e36d27792e02b3952bf3e83bc02c5b17deb71fa35dbeaf6dc3a8040ddc772491d948bd491f0ccd5c6d731c9904646b1f49583018e6a7262cd3b16210bf22b7e23cdd04954322827bb8c7f98b112d63d9a68b89e4a0e776303c3bfe7ea7cdc216fc69fdd6c51e6c5540434d2e597b362a8f91d748438de018ba261661864dc92e35c1a7c990b5f7a56f2b36b76521d9868b0658b31c7b45283c14b776f3e79b259c3c530e93ef419881dfdeae494ee016d708a5c110893328decfab821ae3b2b22b03f8f66c523a44721cc5901bb53f043ce44727846e46fc3445c9d02ca362661574c21a5fb175394ade9c50a083bb72782889eb653556dced2f29a3017fecebe6da0176cb97bd4b10599c46d8349b317e30ff0fbbc22955dc0997e2a5956a393420903a6a972713b396fc512e3e3adc2e2bd0034a8e6bda6ed2de785a3ac39ede62bd675cb2ddbbdbdb2450509aff8618a3152348c52444f5774e248241761c91a0f896442e58a72d022d5ad52d09132d7f3829c67dc6c031db69de00af11c7d4ec465c7541bbdbbfba75367c314e0c30c637f47fdae4ab724a494ef60a314048b2799328f39286899e02edad19fdcc7d578aea5b1593429060cea920b650928f7f83e011c8d86e088be4cbdf0590fc3485123500ad15e25fae8ada18e97fff29ae2192125d666d57bf363d120e448073fb578386295494ce0243df90f7faafeef32eb4e3e41586b9af55526801b0ba2e069d031c57cb6bec08de0b9216f9c93440e1080f55d9d001fcc26f090de1db30cb204c384ccbe7277a0550d8a951d5c118ac59bb84e77dcafab7918b5c07c6cfbeb8460189523ddcc8691c9f57975535c24775710962e2a31e2bc6a4e489f3fe0cba290c709c1d6db275b538e4288ac3926538f81cfac95baf5b64d22b32364c2bf871fca3c1be7197ccd786c2f7661880666471914e0088d33d9a61d47df6717283b0bca097b34f2109b18d0c6b4f1a91166febf15753243dc082c024ee1c46b9bec6e1f75ddda8d397d5657cb297463521fcf41e241a4af32fe7e8e50d057d8781f162e576bf47ef40870a1de8f76ef0b16e88e958b20b6ce4e485cfc661151c0dfd493e636b5032f58e6422de7133e4960b664ae0553c72102b980fd7165edd9a822ee53c3ad6304abe98b530b4b565f4395f754ec6a5e88650faf0c6e6d3dd1a9774452b2f75341c4cc36978a88c370368c6f8809fc6a7f0bafd210f97dfdcccedeac8700212a90c51f917c98110651734c3875b3ddb1b23eaea5b4001971b6765445ad9ba107fc4ff444f7865ee6f43273e105987450f7ad45e1f17f6ff0fb96248b4060e445a3ff8215492c30f24838cc5ffa17ad97c6d9b350088faab70309f57bf841ced0854135153a4b72ef152a1dd0e5a64bc2127df06ffdc989224da5bebb398846e497139a5efefb13d6d61fd4578763301de56502724365a7163e6690c482738355c809be0d9b3197530fec4540c020a9fd3ca41c0a15e372320b216309c3b722761471bce66c79</script>
  <div class="hbe hbe-content">
    <div class="hbe hbe-input hbe-input-xray">
      <input class="hbe hbe-input-field hbe-input-field-xray" type="password" id="hbePass">
      <label class="hbe hbe-input-label hbe-input-label-xray" for="hbePass">
        <span class="hbe hbe-input-label-content hbe-input-label-content-xray">è¯¥æ–‡ç« å·²åŠ å¯†, è¯·è¾“å…¥å¯†ç ç‚¹å‡»å›è½¦ï¼ˆEnterï¼‰æŸ¥çœ‹.</span>
      </label>
      <svg class="hbe hbe-graphic hbe-graphic-xray" width="300%" height="100%" viewBox="0 0 1200 60" preserveAspectRatio="none">
        <path d="M0,56.5c0,0,298.666,0,399.333,0C448.336,56.5,513.994,46,597,46c77.327,0,135,10.5,200.999,10.5c95.996,0,402.001,0,402.001,0"></path>
        <path d="M0,2.5c0,0,298.666,0,399.333,0C448.336,2.5,513.994,13,597,13c77.327,0,135-10.5,200.999-10.5c95.996,0,402.001,0,402.001,0"></path>
      </svg>
    </div>
  </div>
</div>
<script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
      <categories>
        <category>webå‰ç«¯</category>
      </categories>
  </entry>
  <entry>
    <title>fiddleræŠ“åŒ…å·¥å…·</title>
    <url>/posts/654bf45c.html</url>
    <content><![CDATA[<p><img src="/posts/654bf45c/fiddler.jpg" alt="fiddler"><br><code>Fiddler</code>æ˜¯ä¸€ä¸ªé€šè¿‡ä»£ç†çš„æ–¹å¼è¿›è¡ŒæŠ“åŒ…å·¥å…·ï¼Œå®ƒèƒ½è®°å½•æ‰€æœ‰å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨çš„<code>http</code>å’Œ<code>https</code>è¯·æ±‚ï¼Œå…è®¸ä½ ç›‘è§†ï¼Œè®¾ç½®æ–­ç‚¹ï¼Œç”šè‡³ä¿®æ”¹è¾“å…¥è¾“å‡ºæ•°æ®ï¼Œå®ƒè¿è¡Œæ—¶ä¼šåœ¨æœ¬åœ°å»ºç«‹ä¸€ä¸ªä»£ç†æœåŠ¡ï¼Œå¯ä»¥å°†ç½‘ç»œä¼ è¾“å‘é€ä¸æ¥å—çš„æ•°æ®åŒ…è¿›è¡Œ<code>æˆªè·</code>ã€<code>é‡å‘</code>ã€<code>ç¼–è¾‘</code>ã€<code>è½¬å­˜</code>ç­‰æ“ä½œï¼Œä¹Ÿå¯ä»¥ç”¨æ¥<code>æ£€æµ‹ç½‘ç»œå®‰å…¨</code>ã€‚</p>
<span id="more"></span>
<!-- ![charles](charles.png) -->

<h3 id="ä¸‹è½½"><a href="#ä¸‹è½½" class="headerlink" title="ä¸‹è½½"></a>ä¸‹è½½</h3><h4 id="windowç³»ç»Ÿå®‰è£…Fiddlerï¼ˆä¸‹é¢ä»¥windowä¸ºä¾‹ï¼‰"><a href="#windowç³»ç»Ÿå®‰è£…Fiddlerï¼ˆä¸‹é¢ä»¥windowä¸ºä¾‹ï¼‰" class="headerlink" title="windowç³»ç»Ÿå®‰è£…Fiddlerï¼ˆä¸‹é¢ä»¥windowä¸ºä¾‹ï¼‰"></a>windowç³»ç»Ÿå®‰è£…<code>Fiddler</code>ï¼ˆä¸‹é¢ä»¥windowä¸ºä¾‹ï¼‰</h4><p>ä¸‹è½½åœ°å€ï¼š <a href="https://www.telerik.com/download/fiddler">https://www.telerik.com/download/fiddler</a>  ï¼ˆéœ€è¦æ¢¯å­ï¼‰</p>
<p>ç½‘ç›˜ä¸‹è½½ï¼š <a href="https://pan.baidu.com/s/1AQ1IBhNxg8xywiTR2ow68Q">https://pan.baidu.com/s/1AQ1IBhNxg8xywiTR2ow68Q</a>  æå–ç : k2jm  ï¼ˆä¸‹è½½åˆ°æœ¬åœ°çš„ï¼‰</p>
<blockquote>
<p>æ³¨æ„ï¼šwin8ä¹‹å‰ç”¨<code>Fiidler for .NET2</code>ï¼Œwin8ä¹‹åç”¨<code>Fiddler for .NET4</code>æ¯”è¾ƒå¥½</p>
</blockquote>
<h4 id="Macç³»ç»Ÿå®‰è£…Charles"><a href="#Macç³»ç»Ÿå®‰è£…Charles" class="headerlink" title="Macç³»ç»Ÿå®‰è£…Charles"></a>Macç³»ç»Ÿå®‰è£…<code>Charles</code></h4><p>è·Ÿwindowå·®åˆ«ä¸æ˜¯å¾ˆå¤§ï¼Œè¿™é‡Œä¸ç»†è¯´äº†ï¼Œå¯ä»¥å‚è€ƒ<a href="https://www.jianshu.com/p/933d78091d90">Charlesä½¿ç”¨æ•™ç¨‹</a></p>
<h3 id="Fiddlerç®€ä»‹"><a href="#Fiddlerç®€ä»‹" class="headerlink" title="Fiddlerç®€ä»‹"></a>Fiddlerç®€ä»‹</h3><p>Fiddleræ˜¯é€šè¿‡æ”¹å†™HTTPä»£ç†ï¼Œè®©æ•°æ®ä»å®ƒé‚£é€šè¿‡ï¼Œæ¥ç›‘æ§å¹¶ä¸”æˆªå–åˆ°æ•°æ®ã€‚å½“ç„¶Fiddlerå¾ˆå±Œï¼Œåœ¨æ‰“å¼€å®ƒçš„é‚£ä¸€ç¬é—´ï¼Œå®ƒå°±å·²ç»è®¾ç½®å¥½äº†æµè§ˆå™¨çš„ä»£ç†äº†ã€‚å½“ä½ å…³é—­çš„æ—¶å€™ï¼Œå®ƒåˆå¸®ä½ æŠŠä»£ç†è¿˜åŸäº†</p>
<h4 id="Fiddlerè®¾ç½®"><a href="#Fiddlerè®¾ç½®" class="headerlink" title="Fiddlerè®¾ç½®"></a>Fiddlerè®¾ç½®</h4><p>Fiddleræƒ³è¦æŠ“åˆ°æ•°æ®åŒ…ï¼Œè¦ç¡®ä¿<code>Capture Traffic</code>æ˜¯å¼€å¯ï¼Œåœ¨<code>File</code> â€“&gt; <code>Capture Traffic</code>ã€‚å¼€å¯åå†å·¦ä¸‹è§’ä¼šæœ‰æ˜¾ç¤ºï¼Œå½“ç„¶ä¹Ÿå¯ä»¥ç›´æ¥ç‚¹å‡»å·¦ä¸‹è§’çš„å›¾æ ‡æ¥<code>å…³é—­/å¼€å¯</code>æŠ“åŒ…åŠŸèƒ½ã€‚<br><img src="/posts/654bf45c/1.jpg" alt="æŠ“åŒ…è®¾ç½®"></p>
<p>å¼€å¯<code>Capture Traffic</code>åï¼ŒFiddlerå°±å¼€å§‹å·¥ä½œäº†ï¼ŒæŠ“å–åˆ°çš„æ•°æ®åŒ…å°±ä¼šæ˜¾ç¤ºåœ¨åˆ—è¡¨é‡Œé¢äº†</p>
<p><img src="/posts/654bf45c/3.png" alt="æŠ“åŒ…å±•ç¤º"></p>
<p>æ ‡é¢˜è¡¨ç¤ºçš„å«ä¹‰</p>
<table>
<thead>
<tr>
<th align="center">åç§°</th>
<th align="left">å«ä¹‰</th>
</tr>
</thead>
<tbody><tr>
<td align="center">#</td>
<td align="left">æŠ“å–HTTP Requestçš„é¡ºåºï¼Œä»1å¼€å§‹ï¼Œä»¥æ­¤é€’å¢</td>
</tr>
<tr>
<td align="center">Result</td>
<td align="left">HTTPçŠ¶æ€ç </td>
</tr>
<tr>
<td align="center">Protocol</td>
<td align="left">è¯·æ±‚ä½¿ç”¨çš„åè®®ï¼Œå¦‚HTTP/HTTPS/FTPç­‰</td>
</tr>
<tr>
<td align="center">Host</td>
<td align="left">è¯·æ±‚åœ°å€çš„ä¸»æœºå</td>
</tr>
<tr>
<td align="center">URL</td>
<td align="left">è¯·æ±‚èµ„æºçš„ä½ç½®</td>
</tr>
<tr>
<td align="center">Body</td>
<td align="left">è¯¥è¯·æ±‚çš„å¤§å°</td>
</tr>
<tr>
<td align="center">Caching</td>
<td align="left">è¯·æ±‚çš„ç¼“å­˜è¿‡æœŸæ—¶é—´æˆ–è€…ç¼“å­˜æ§åˆ¶å€¼</td>
</tr>
<tr>
<td align="center">Content-Type</td>
<td align="left">è¯·æ±‚å“åº”çš„ç±»å‹</td>
</tr>
<tr>
<td align="center">Process</td>
<td align="left">å‘é€æ­¤è¯·æ±‚çš„è¿›ç¨‹ï¼šè¿›ç¨‹ID</td>
</tr>
<tr>
<td align="center">Comments</td>
<td align="left">å…è®¸ç”¨æˆ·ä¸ºæ­¤å›è¯æ·»åŠ å¤‡æ³¨</td>
</tr>
<tr>
<td align="center">Custom</td>
<td align="left">å…è®¸ç”¨æˆ·è®¾ç½®è‡ªå®šä¹‰å€¼</td>
</tr>
</tbody></table>
<p>å›¾æ ‡è¡¨ç¤ºçš„å«ä¹‰</p>
<table>
<thead>
<tr>
<th align="center">å›¾æ ‡</th>
<th align="left">å«ä¹‰</th>
</tr>
</thead>
<tbody><tr>
<td align="center"><img src="/posts/654bf45c/icon1.gif" alt="å›¾æ ‡"></td>
<td align="left">è¯·æ±‚å·²ç»å‘å¾€æœåŠ¡å™¨</td>
</tr>
<tr>
<td align="center"><img src="/posts/654bf45c/icon2.gif" alt="å›¾æ ‡"></td>
<td align="left">å·²ä»æœåŠ¡å™¨ä¸‹è½½å“åº”ç»“æœ</td>
</tr>
<tr>
<td align="center"><img src="/posts/654bf45c/icon3.gif" alt="å›¾æ ‡"></td>
<td align="left">è¯·æ±‚ä»æ–­ç‚¹å¤„æš‚åœ</td>
</tr>
<tr>
<td align="center"><img src="/posts/654bf45c/icon4.gif" alt="å›¾æ ‡"></td>
<td align="left">å“åº”ä»æ–­ç‚¹å¤„æš‚åœ</td>
</tr>
<tr>
<td align="center"><img src="/posts/654bf45c/icon5.gif" alt="å›¾æ ‡"></td>
<td align="left">è¯·æ±‚ä½¿ç”¨ HTTP çš„ HEAD æ–¹æ³•ï¼Œå³å“åº”æ²¡æœ‰å†…å®¹ï¼ˆBodyï¼‰</td>
</tr>
<tr>
<td align="center"><img src="/posts/654bf45c/icon6.gif" alt="å›¾æ ‡"></td>
<td align="left">è¯·æ±‚ä½¿ç”¨ HTTP çš„ POST æ–¹æ³•</td>
</tr>
<tr>
<td align="center"><img src="/posts/654bf45c/icon7.gif" alt="å›¾æ ‡"></td>
<td align="left">è¯·æ±‚ä½¿ç”¨ HTTP çš„ CONNECT æ–¹æ³•ï¼Œä½¿ç”¨ HTTPS åè®®å»ºç«‹è¿æ¥éš§é“</td>
</tr>
<tr>
<td align="center"><img src="/posts/654bf45c/icon8.gif" alt="å›¾æ ‡"></td>
<td align="left">å“åº”æ˜¯ HTML æ ¼å¼</td>
</tr>
<tr>
<td align="center"><img src="/posts/654bf45c/icon9.gif" alt="å›¾æ ‡"></td>
<td align="left">å“åº”æ˜¯ä¸€å¼ å›¾ç‰‡</td>
</tr>
<tr>
<td align="center"><img src="/posts/654bf45c/icon10.gif" alt="å›¾æ ‡"></td>
<td align="left">å“åº”æ˜¯è„šæœ¬æ ¼å¼</td>
</tr>
<tr>
<td align="center"><img src="/posts/654bf45c/icon11.gif" alt="å›¾æ ‡"></td>
<td align="left">å“åº”æ˜¯ CSS æ ¼å¼</td>
</tr>
<tr>
<td align="center"><img src="/posts/654bf45c/icon12.gif" alt="å›¾æ ‡"></td>
<td align="left">å“åº”æ˜¯ XML æ ¼å¼</td>
</tr>
<tr>
<td align="center"><img src="/posts/654bf45c/icon13.gif" alt="å›¾æ ‡"></td>
<td align="left">å“åº”æ˜¯ JSON æ ¼å¼</td>
</tr>
<tr>
<td align="center"><img src="/posts/654bf45c/icon14.gif" alt="å›¾æ ‡"></td>
<td align="left">å“åº”æ˜¯ä¸€ä¸ªéŸ³é¢‘æ–‡ä»¶</td>
</tr>
<tr>
<td align="center"><img src="/posts/654bf45c/icon15.gif" alt="å›¾æ ‡"></td>
<td align="left">å“åº”æ˜¯ä¸€ä¸ªè§†é¢‘æ–‡ä»¶</td>
</tr>
<tr>
<td align="center"><img src="/posts/654bf45c/icon16.gif" alt="å›¾æ ‡"></td>
<td align="left">å“åº”æ˜¯ä¸€ä¸ª SilverLight</td>
</tr>
<tr>
<td align="center"><img src="/posts/654bf45c/icon17.gif" alt="å›¾æ ‡"></td>
<td align="left">å“åº”æ˜¯ä¸€ä¸ª FLASH</td>
</tr>
<tr>
<td align="center"><img src="/posts/654bf45c/icon18.gif" alt="å›¾æ ‡"></td>
<td align="left">å“åº”æ˜¯ä¸€ä¸ªå­—ä½“</td>
</tr>
<tr>
<td align="center"><img src="/posts/654bf45c/icon19.gif" alt="å›¾æ ‡"></td>
<td align="left">æ™®é€šå“åº”æˆåŠŸ</td>
</tr>
<tr>
<td align="center"><img src="/posts/654bf45c/icon20.gif" alt="å›¾æ ‡"></td>
<td align="left">å“åº”æ˜¯ HTTP/300ã€301ã€302ã€303 æˆ– 307 é‡å®šå‘</td>
</tr>
<tr>
<td align="center"><img src="/posts/654bf45c/icon21.gif" alt="å›¾æ ‡"></td>
<td align="left">å“åº”æ˜¯ HTTP/304ï¼ˆæ— å˜æ›´ï¼‰ï¼šä½¿ç”¨ç¼“å­˜æ–‡ä»¶</td>
</tr>
<tr>
<td align="center"><img src="/posts/654bf45c/icon22.gif" alt="å›¾æ ‡"></td>
<td align="left">å“åº”éœ€è¦å®¢æˆ·ç«¯è¯ä¹¦éªŒè¯</td>
</tr>
<tr>
<td align="center"><img src="/posts/654bf45c/icon23.gif" alt="å›¾æ ‡"></td>
<td align="left">æœåŠ¡ç«¯é”™è¯¯</td>
</tr>
<tr>
<td align="center"><img src="/posts/654bf45c/icon24.gif" alt="å›¾æ ‡"></td>
<td align="left">ä¼šè¯è¢«å®¢æˆ·ç«¯ã€Fiddler æˆ–è€…æœåŠ¡ç«¯ç»ˆæ­¢</td>
</tr>
</tbody></table>
<h4 id="Statistics-è¯·æ±‚çš„æ€§èƒ½æ•°æ®åˆ†æ"><a href="#Statistics-è¯·æ±‚çš„æ€§èƒ½æ•°æ®åˆ†æ" class="headerlink" title="Statistics è¯·æ±‚çš„æ€§èƒ½æ•°æ®åˆ†æ"></a>Statistics è¯·æ±‚çš„æ€§èƒ½æ•°æ®åˆ†æ</h4><p>éšæ„ç‚¹å‡»ä¸€ä¸ªè¯·æ±‚ï¼Œå°±å¯ä»¥çœ‹åˆ°<code>Statistics</code>å…³äºHTTPè¯·æ±‚çš„æ€§èƒ½ä»¥åŠæ•°æ®åˆ†æäº†<br><img src="/posts/654bf45c/4.png" alt="å›¾æ ‡"> </p>
<h4 id="Inspectors-æŸ¥çœ‹æ•°æ®å†…å®¹"><a href="#Inspectors-æŸ¥çœ‹æ•°æ®å†…å®¹" class="headerlink" title="Inspectors æŸ¥çœ‹æ•°æ®å†…å®¹"></a>Inspectors æŸ¥çœ‹æ•°æ®å†…å®¹</h4><p><code>Inspectors</code>æ˜¯ç”¨äºæŸ¥çœ‹ä¼šè¯çš„å†…å®¹ï¼Œä¸ŠåŠéƒ¨åˆ†æ˜¯è¯·æ±‚çš„å†…å®¹ï¼Œä¸‹åŠéƒ¨åˆ†æ˜¯å“åº”çš„å†…å®¹<br><img src="/posts/654bf45c/5.png" alt="å›¾æ ‡"> </p>
<h4 id="AutoResponder-å…è®¸æ‹¦æˆªæŒ‡å®šè§„åˆ™çš„è¯·æ±‚"><a href="#AutoResponder-å…è®¸æ‹¦æˆªæŒ‡å®šè§„åˆ™çš„è¯·æ±‚" class="headerlink" title="AutoResponder å…è®¸æ‹¦æˆªæŒ‡å®šè§„åˆ™çš„è¯·æ±‚"></a>AutoResponder å…è®¸æ‹¦æˆªæŒ‡å®šè§„åˆ™çš„è¯·æ±‚</h4><p><code>AutoResponder</code>å…è®¸ä½ æ‹¦æˆªæŒ‡å®šè§„åˆ™çš„è¯·æ±‚ï¼Œå¹¶<code>è¿”å›æœ¬åœ°èµ„æº</code>æˆ–<code>Fiddlerèµ„æº</code>ï¼Œä»è€Œ<code>ä»£æ›¿æœåŠ¡å™¨å“åº”</code>ã€‚<br>çœ‹ä¸‹å›¾5æ­¥ï¼Œæˆ‘å°†<code>baidu</code>è¿™ä¸ªå…³é”®å­—ä¸æˆ‘ç”µè„‘<code>F:\blog\source\_posts\fiddler\fiddler.jpg</code>è¿™å¼ å›¾ç‰‡ç»‘å®šäº†ï¼Œç‚¹å‡»<code>Save</code>ä¿å­˜åå‹¾é€‰<code>Enable rules</code>ï¼Œå†è®¿é—®<code>baidu</code>ï¼Œå°±ä¼šè¢«åŠ«æŒã€‚<br><img src="/posts/654bf45c/6.png" alt="å›¾æ ‡"> </p>
<p>è®¾ç½®å¥½åŒ¹é…è§„åˆ™åï¼Œç°åœ¨å»è¯·æ±‚ï¼Œè¿”å›ä¹‹å‰è®¾ç½®çš„è®¿é—®å›¾ç‰‡çš„åœ°å€</p>
<p><img src="/posts/654bf45c/7.png" alt="å›¾æ ‡"></p>
<h4 id="Composer-è‡ªå®šä¹‰è¯·æ±‚å‘é€æœåŠ¡å™¨"><a href="#Composer-è‡ªå®šä¹‰è¯·æ±‚å‘é€æœåŠ¡å™¨" class="headerlink" title="Composer è‡ªå®šä¹‰è¯·æ±‚å‘é€æœåŠ¡å™¨"></a>Composer è‡ªå®šä¹‰è¯·æ±‚å‘é€æœåŠ¡å™¨</h4><p><code>Composer</code>å…è®¸è‡ªå®šä¹‰è¯·æ±‚å‘é€åˆ°æœåŠ¡å™¨ï¼Œå¯ä»¥æ‰‹åŠ¨åˆ›å»ºä¸€ä¸ªæ–°çš„è¯·æ±‚ï¼Œä¹Ÿå¯ä»¥åœ¨ä¼šè¯è¡¨ä¸­ï¼Œæ‹–æ‹½ä¸€ä¸ªç°æœ‰çš„è¯·æ±‚<br><code>Parsedæ¨¡å¼</code>ä¸‹ä½ åªéœ€è¦æä¾›ç®€å•çš„URLSåœ°å€å³å¯ï¼ˆå¦‚ä¸‹å›¾ï¼Œä¹Ÿå¯ä»¥åœ¨RequestBodyå®šåˆ¶ä¸€äº›å±æ€§ï¼Œå¦‚æ¨¡æ‹Ÿæµè§ˆå™¨User-Agentï¼‰<br><img src="/posts/654bf45c/8.png" alt="å›¾æ ‡"></p>
<h4 id="Filters-è¯·æ±‚è¿‡æ»¤è§„åˆ™"><a href="#Filters-è¯·æ±‚è¿‡æ»¤è§„åˆ™" class="headerlink" title="Filters è¯·æ±‚è¿‡æ»¤è§„åˆ™"></a>Filters è¯·æ±‚è¿‡æ»¤è§„åˆ™</h4><p><code>Fiters</code>æ˜¯è¿‡æ»¤è¯·æ±‚ç”¨çš„ï¼Œå·¦è¾¹çš„çª—å£ä¸æ–­çš„æ›´æ–°ï¼Œå½“ä½ æƒ³çœ‹ä½ ç³»ç»Ÿçš„è¯·æ±‚çš„æ—¶å€™ï¼Œä½ åˆ·æ–°ä¸€ä¸‹æµè§ˆå™¨ï¼Œä¸€å¤§ç‰‡ä¸çŸ¥é“å“ªæ¥è¯·æ±‚ï¼Œçœ‹ç€ç¢çœ¼ï¼Œå®ƒè¿˜ä¸€ç›´åˆ·æ–°ä½ çš„å±å¹•ã€‚è¿™ä¸ªæ—¶å€™é€šè¿‡è¿‡æ»¤è§„åˆ™æ¥è¿‡æ»¤æ‰é‚£äº›ä¸æƒ³çœ‹åˆ°çš„è¯·æ±‚ã€‚<br><img src="/posts/654bf45c/9.png" alt="å›¾æ ‡"><br>å‹¾é€‰å·¦ä¸Šè§’çš„<code>Use Filters</code>å¼€å¯è¿‡æ»¤å™¨ï¼Œè¿™é‡Œæœ‰ä¸¤ä¸ªæœ€å¸¸ç”¨çš„è¿‡æ»¤æ¡ä»¶ï¼š<code>Zone</code>å’Œ<code>Host</code></p>
<ul>
<li>Zone æŒ‡å®šåªæ˜¾ç¤º<code>å†…ç½‘ï¼ˆIntranetï¼‰</code>æˆ–<code>äº’è”ç½‘ï¼ˆInternetï¼‰</code>çš„å†…å®¹<br><img src="/posts/654bf45c/10.png" alt="å›¾æ ‡"></li>
<li>Host æŒ‡å®šæ˜¾ç¤º<code>æŸä¸ªåŸŸåä¸‹</code>çš„ä¼šè¯ï¼š<br><img src="/posts/654bf45c/11.png" alt="å›¾æ ‡"></li>
</ul>
<h4 id="Timeline-è¯·æ±‚å“åº”æ—¶é—´"><a href="#Timeline-è¯·æ±‚å“åº”æ—¶é—´" class="headerlink" title="Timeline è¯·æ±‚å“åº”æ—¶é—´"></a>Timeline è¯·æ±‚å“åº”æ—¶é—´</h4><p>åœ¨å·¦ä¾§ä¼šè¯çª—å£ç‚¹å‡»ä¸€ä¸ªæˆ–å¤šä¸ªï¼ˆåŒæ—¶æŒ‰ä¸‹ Ctrl é”®ï¼‰ï¼ŒTimeline ä¾¿ä¼šæ˜¾ç¤ºæŒ‡å®šå†…å®¹ä»æœåŠ¡ç«¯ä¼ è¾“åˆ°å®¢æˆ·ç«¯çš„æ—¶é—´ï¼š<br><img src="/posts/654bf45c/12.png" alt="å›¾æ ‡"></p>
<h3 id="Fiddlerè®¾ç½®è§£å¯†HTTPSçš„ç½‘ç»œæ•°æ®"><a href="#Fiddlerè®¾ç½®è§£å¯†HTTPSçš„ç½‘ç»œæ•°æ®" class="headerlink" title="Fiddlerè®¾ç½®è§£å¯†HTTPSçš„ç½‘ç»œæ•°æ®"></a>Fiddlerè®¾ç½®è§£å¯†HTTPSçš„ç½‘ç»œæ•°æ®</h3><p>Fiddlerå¯ä»¥é€šè¿‡ä¼ªé€ CAè¯ä¹¦æ¥æ¬ºéª—æµè§ˆå™¨å’ŒæœåŠ¡å™¨ã€‚å¤§æ¦‚åŸç†å°±æ˜¯åœ¨æµè§ˆå™¨é¢å‰Fiddlerä¼ªè£…æˆä¸€ä¸ªHTTPSæœåŠ¡å™¨ï¼Œè€Œåœ¨çœŸæ­£çš„HTTPSæœåŠ¡å™¨é¢å‰Fiddlerä¼ªè£…æˆæµè§ˆå™¨ï¼Œä»è€Œå®ç°è§£å¯†HTTPSæ•°æ®åŒ…çš„ç›®çš„ã€‚<br>è§£å¯†HTTPSéœ€è¦æ‰‹åŠ¨å¼€å¯æ­¥éª¤ï¼š<code>Tools</code> â€“&gt; <code>Options</code> â€“&gt;  <code>HTTPS</code></p>
<p><img src="/posts/654bf45c/13.jpg" alt="å›¾æ ‡"><br>ç‚¹å‡»<code>Tools</code> -&gt; é€‰æ‹©<code>Options</code>-&gt; é€‰æ‹©<code>HTTPS</code> -&gt; å‹¾é€‰<code>Decrypt HTTPS Traffic</code>å’Œ<code>Ignore servercertificate errors</code>(é¦–æ¬¡ç‚¹å‡»ä¼šå¼¹å‡ºæ˜¯å¦ä¿¡ä»»fiddlerè¯ä¹¦å’Œå®‰å…¨æç¤ºï¼Œç›´æ¥ç‚¹å‡»yeså°±è¡Œ)</p>
<p><img src="/posts/654bf45c/13.png" alt="å›¾æ ‡"></p>
<p>ç‚¹å‡»OK</p>
<p><img src="/posts/654bf45c/14.png" alt="å›¾æ ‡"></p>
<h3 id="Fiddler-æŠ“å–Iphone-Androidæ•°æ®åŒ…"><a href="#Fiddler-æŠ“å–Iphone-Androidæ•°æ®åŒ…" class="headerlink" title="Fiddler æŠ“å–Iphone / Androidæ•°æ®åŒ…"></a>Fiddler æŠ“å–Iphone / Androidæ•°æ®åŒ…</h3><p>FiddleræŠ“å–ç§»åŠ¨ç«¯è®¾å¤‡çš„æ•°æ®åŒ…ï¼Œå…¶å®å¾ˆç®€å•ï¼Œå…ˆæ¥è¯´è¯´ç§»åŠ¨è®¾å¤‡æ€ä¹ˆå»è®¿é—®ç½‘ç»œï¼Œçœ‹äº†ä¸‹é¢è¿™å¼ å›¾ï¼š</p>
<p><img src="/posts/654bf45c/15.png" alt="å›¾æ ‡"><br>æƒ³è¦æŠ“å–æ‰‹æœºè®¿é—®çš„æ•°æ®ï¼Œè®©æ‰‹æœºå’Œç”µè„‘åœ¨åŒä¸€ä¸ªå±€åŸŸç½‘ç»œä¸‹ï¼Œæ‰“å¼€<code>Fiddler</code>å·¥å…·ï¼Œç‚¹å‡»èœå•æ ä¸­çš„ <code>Tools</code> â€“&gt; <code>Options</code> -&gt; <code>é€‰æ‹©Connections</code> -&gt; <code>è®¾ç½®ä»£ç†ç«¯å£æ˜¯8888</code> -&gt; <code>å‹¾é€‰Allow remote computers to connect</code> -&gt; <code>ç‚¹å‡»OK</code><br><img src="/posts/654bf45c/16.png" alt="å›¾æ ‡"></p>
<p>ä¸€å®šè¦é‡æ–°å¯åŠ¨fiddlerï¼Œè¿™æ—¶åœ¨ Fiddler å¯ä»¥çœ‹åˆ°è‡ªå·±æœ¬æœºæ— çº¿ç½‘å¡çš„IPäº†ï¼ˆè¦æ˜¯æ²¡æœ‰çš„è¯å¯ä»¥åœ¨<code>cmd</code>ç»ˆç«¯ä¸­<code>ipconfig</code>æ‰¾åˆ°è‡ªå·±çš„ç½‘å¡IPï¼‰<br><img src="/posts/654bf45c/17.png" alt="å›¾æ ‡"></p>
<p>åœ¨æ‰‹æœºç«¯è¿æ¥å’ŒPCç›¸åŒçš„wifiï¼Œå¹¶ä¸”è®¾ç½®ä»£ç†IPä¸ç«¯å£ï¼ˆä»£ç†IPå°±æ˜¯ä¸Šå›¾çš„IPï¼Œç«¯å£æ˜¯Fiddlerçš„ä»£ç†ç«¯å£8888ï¼‰<br><img src="/posts/654bf45c/18.png" alt="å›¾æ ‡"></p>
<p>è®¿é—®ç½‘é¡µè¾“å…¥<code>ä»£ç†IP</code>å’Œ<code>ç«¯å£</code>ï¼Œç‚¹å‡»<code>FiddlerRoot certificate</code>ï¼Œä¸‹è½½<code>Fiddlerçš„è¯ä¹¦</code>,æ³¨æ„ï¼šè‹¹æœæ‰‹æœºç”¨<code>safari</code>æ‰“å¼€<br><img src="/posts/654bf45c/19.png" alt="å›¾æ ‡"></p>
<p>å®‰è£…è¯ä¹¦</p>
<p><img src="/posts/654bf45c/20.png" alt="å›¾æ ‡"></p>
<p>å®‰è£…å®Œè¯ä¹¦ï¼Œç”¨æ‰‹æœºè®¿é—®åº”ç”¨ï¼Œå°±å¯ä»¥çœ‹åˆ°æˆªå–åˆ°çš„æ•°æ®åŒ…äº†</p>
]]></content>
      <categories>
        <category>webå‰ç«¯</category>
      </categories>
      <tags>
        <tag>æŠ“åŒ…</tag>
        <tag>fiddler</tag>
      </tags>
  </entry>
  <entry>
    <title>Hexoä½¿ç”¨</title>
    <url>/posts/3b4634fc.html</url>
    <content><![CDATA[<p>æœ¬åšå®¢é€šè¿‡ <a href="'https://hexo.io/'">Hexo</a> + <a href="'http://theme-next.iissnan.com/'">Nextä¸»é¢˜</a> + <a href="'https://pages.github.com/'">Github pages</a> + <a href="'https://coding.net/'">Coding</a> ç”¨äº†2å¤©å·¦å³æ­å»ºè€Œæˆï¼Œåœ¨æ­¤è®°å½•ä¸€ä¸‹åŸºæœ¬çš„ä½¿ç”¨å‘½ä»¤ï¼Œé˜²æ­¢ä»¥åå¿˜è®°</p>
<span id="more"></span>
<h3 id="æ–°å»ºè‰ç¨¿"><a href="#æ–°å»ºè‰ç¨¿" class="headerlink" title="æ–°å»ºè‰ç¨¿"></a>æ–°å»ºè‰ç¨¿</h3><p>æ–°å»ºçš„è‰ç¨¿æ–‡ä»¶ä¼šå­˜æ”¾åœ¨<code>/source/_drafts</code>è·¯å¾„ä¸‹</p>
<figure class="highlight haxe"><table><tr><td class="code"><pre><span class="line">hexo <span class="keyword">new</span> <span class="type">draft</span> &lt;filename&gt;</span><br></pre></td></tr></table></figure>
<p>æµ‹è¯•ï¼š</p>
<figure class="highlight routeros"><table><tr><td class="code"><pre><span class="line">Yu@DESKTOP-NNKS8QQ MINGW64 /f/blog (master)</span><br><span class="line">$ hexo new draft <span class="string">&quot;è‰ç¨¿æ–‡ç« æµ‹è¯•&quot;</span></span><br><span class="line"><span class="built_in">INFO</span>  Validating<span class="built_in"> config</span></span><br><span class="line"><span class="built_in"></span><span class="built_in">INFO</span>  Created: F:\blog\source\_drafts\è‰ç¨¿æ–‡ç« æµ‹è¯•.md</span><br></pre></td></tr></table></figure>
<h3 id="è‰ç¨¿è¿è¡Œé¢„è§ˆ"><a href="#è‰ç¨¿è¿è¡Œé¢„è§ˆ" class="headerlink" title="è‰ç¨¿è¿è¡Œé¢„è§ˆ"></a>è‰ç¨¿è¿è¡Œé¢„è§ˆ</h3><ul>
<li>å¦‚æœä½ å¸Œæœ›å¼ºè¡Œé¢„è§ˆè‰ç¨¿ï¼Œæ›´æ”¹é…ç½®æ–‡ä»¶ï¼š<figure class="highlight yaml"><table><tr><td class="code"><pre><span class="line"><span class="attr">render_drafts:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure></li>
<li>ä¹Ÿå¯ä»¥è¿™ç§æ–¹å¼å¯åŠ¨serverï¼š<figure class="highlight pgsql"><table><tr><td class="code"><pre><span class="line">hexo <span class="keyword">server</span> <span class="comment">--drafts</span></span><br></pre></td></tr></table></figure>

</li>
</ul>
<h4 id="è‰ç¨¿è½¬æ­£å¼æ–‡ç« "><a href="#è‰ç¨¿è½¬æ­£å¼æ–‡ç« " class="headerlink" title="è‰ç¨¿è½¬æ­£å¼æ–‡ç« "></a>è‰ç¨¿è½¬æ­£å¼æ–‡ç« </h4><p>å½“è‰ç¨¿å†™å®Œæˆäº†è¦å‘å¸ƒï¼Œè¾“å…¥å¦‚ä¸‹å‘½ä»¤å°†è‰ç¨¿è½¬æˆæ­£å¼æ–‡ç« ï¼Œè¯¥å‘½ä»¤ä¼šæŠŠ<code>/source/_drafts</code>ä¸‹çš„æ–‡ç« ç§»åˆ°<code>/source/_posts</code>ä¸‹</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line">hexo publish <span class="tag">&lt;<span class="name">filename</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="ç›´æ¥ç”Ÿæˆæ­£å¼æ–‡ç« "><a href="#ç›´æ¥ç”Ÿæˆæ­£å¼æ–‡ç« " class="headerlink" title="ç›´æ¥ç”Ÿæˆæ­£å¼æ–‡ç« "></a>ç›´æ¥ç”Ÿæˆæ­£å¼æ–‡ç« </h3><figure class="highlight actionscript"><table><tr><td class="code"><pre><span class="line">hexo <span class="keyword">new</span> <span class="string">&quot;æ–‡ç« åå­—&quot;</span></span><br></pre></td></tr></table></figure>
<p>ä¹‹ååœ¨<code>source/_posts</code>ç›®å½•ä¸‹é¢ï¼Œå¤šäº†ä¸€ä¸ª<code>æ–‡ç« åå­—.md</code>çš„æ–‡ä»¶  </p>
<h3 id="è®¾ç½®å¤šä¸ªæ ‡ç­¾"><a href="#è®¾ç½®å¤šä¸ªæ ‡ç­¾" class="headerlink" title="è®¾ç½®å¤šä¸ªæ ‡ç­¾"></a>è®¾ç½®å¤šä¸ªæ ‡ç­¾</h3><figure class="highlight subunit"><table><tr><td class="code"><pre><span class="line"><span class="keyword">tags:</span> [nrm,npm]</span><br></pre></td></tr></table></figure>
<h3 id="æ¸…é™¤ç¼“å­˜"><a href="#æ¸…é™¤ç¼“å­˜" class="headerlink" title="æ¸…é™¤ç¼“å­˜"></a>æ¸…é™¤ç¼“å­˜</h3><p>æ¸…é™¤ç¼“å­˜æ–‡ä»¶ (db.json) å’Œå·²ç”Ÿæˆçš„é™æ€æ–‡ä»¶ (public)ã€‚</p>
<figure class="highlight ebnf"><table><tr><td class="code"><pre><span class="line"><span class="attribute">hexo clean</span></span><br></pre></td></tr></table></figure>
<h3 id="ç”Ÿæˆé™æ€æ–‡ä»¶"><a href="#ç”Ÿæˆé™æ€æ–‡ä»¶" class="headerlink" title="ç”Ÿæˆé™æ€æ–‡ä»¶"></a>ç”Ÿæˆé™æ€æ–‡ä»¶</h3><p>ä½¿ç”¨ Hexo ç”Ÿæˆé™æ€æ–‡ä»¶</p>
<figure class="highlight verilog"><table><tr><td class="code"><pre><span class="line">hexo <span class="keyword">generate</span></span><br></pre></td></tr></table></figure>
<p>ç®€å†™ï¼š</p>
<figure class="highlight ebnf"><table><tr><td class="code"><pre><span class="line"><span class="attribute">hexo g</span></span><br></pre></td></tr></table></figure>
<h3 id="å¯åŠ¨æœåŠ¡"><a href="#å¯åŠ¨æœåŠ¡" class="headerlink" title="å¯åŠ¨æœåŠ¡"></a>å¯åŠ¨æœåŠ¡</h3><p>Hexo ä¼šç›‘è§†æ–‡ä»¶å˜åŠ¨å¹¶è‡ªåŠ¨æ›´æ–°ï¼Œæ‚¨æ— é¡»é‡å¯æœåŠ¡å™¨</p>
<figure class="highlight axapta"><table><tr><td class="code"><pre><span class="line">hexo <span class="keyword">server</span></span><br></pre></td></tr></table></figure>
<p>ç®€å†™ï¼š</p>
<figure class="highlight ebnf"><table><tr><td class="code"><pre><span class="line"><span class="attribute">hexo s</span></span><br></pre></td></tr></table></figure>
<h3 id="å‘å¸ƒç”Ÿäº§"><a href="#å‘å¸ƒç”Ÿäº§" class="headerlink" title="å‘å¸ƒç”Ÿäº§"></a>å‘å¸ƒç”Ÿäº§</h3><figure class="highlight ebnf"><table><tr><td class="code"><pre><span class="line"><span class="attribute">hexo deploy</span></span><br></pre></td></tr></table></figure>
<p>ç®€å†™ï¼š</p>
<figure class="highlight ebnf"><table><tr><td class="code"><pre><span class="line"><span class="attribute">hexo d</span></span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>Hexo</category>
      </categories>
      <tags>
        <tag>Hexo</tag>
      </tags>
  </entry>
  <entry>
    <title>è…¾è®¯äº‘æœåŠ¡å™¨nginxå®‰è£…é…ç½®</title>
    <url>/posts/a477be03.html</url>
    <content><![CDATA[<p>å¼€å§‹é…ç½®å‰ï¼Œéœ€è¦è´­ä¹°ä¸€ä¸ªæœåŠ¡å™¨ <a href="https://url.cn/NEdlZzvJ">è…¾è®¯äº‘å®˜ç½‘</a>ï¼Œè´­ä¹°è¿‡åè¿˜éœ€è¦ä½ å…ˆå»å¤‡æ¡ˆï¼Œä»æäº¤å¤‡æ¡ˆåˆ°ç®¡ç†å±€é€šè¿‡æ­£å¸¸å¤§æ¦‚ä¸€ä¸ªæ˜ŸæœŸï¼Œä¸‹é¢æ˜¯æˆ‘çš„å¤‡æ¡ˆæ“ä½œè®°å½•ï¼Œè¢«è…¾è®¯äº‘å®¢æœæ‰“ç”µè¯é©³å›ä¸€æ¬¡ï¼Œå› ä¸ºå¡«å†™çš„å¤‡ç”¨ç”µè¯æ‰“ä¸é€šï¼Œéœ€è¦æ³¨æ„ï¼šæäº¤å¤‡æ¡ˆåæ³¨æ„ä¿æŒç”µè¯ç•…é€šã€‚</p>
<span id="more"></span>

<p><img src="/posts/a477be03/1.png" alt="æˆ‘çš„å¤‡æ¡ˆæˆªå›¾"></p>
<h3 id="æˆ‘çš„ç¯å¢ƒï¼š"><a href="#æˆ‘çš„ç¯å¢ƒï¼š" class="headerlink" title="æˆ‘çš„ç¯å¢ƒï¼š"></a>æˆ‘çš„ç¯å¢ƒï¼š</h3><ul>
<li>æœåŠ¡å™¨ï¼šè…¾è®¯äº‘æœåŠ¡å™¨</li>
<li>nginxç‰ˆæœ¬ï¼šnginx/1.18.0 <a href="http://nginx.org/en/download.html">nginxä¸‹è½½åœ°å€</a></li>
<li>CentOS: CentOS Linux release 7.6.1810 (Core)</li>
</ul>
<h3 id="æŸ¥çœ‹ä½ çš„å…¬ç½‘IPå’Œç§ç½‘IP"><a href="#æŸ¥çœ‹ä½ çš„å…¬ç½‘IPå’Œç§ç½‘IP" class="headerlink" title="æŸ¥çœ‹ä½ çš„å…¬ç½‘IPå’Œç§ç½‘IP"></a>æŸ¥çœ‹ä½ çš„å…¬ç½‘IPå’Œç§ç½‘IP</h3><p><img src="/posts/a477be03/2.png" alt="æŸ¥çœ‹ip"></p>
<h3 id="è¿æ¥æœåŠ¡å™¨"><a href="#è¿æ¥æœåŠ¡å™¨" class="headerlink" title="è¿æ¥æœåŠ¡å™¨"></a>è¿æ¥æœåŠ¡å™¨</h3><p>windowsç³»ç»Ÿéœ€è¦ä¸‹è½½ä¸ªè¿æ¥æœåŠ¡å™¨çš„å®¢æˆ·ç«¯ï¼Œxshellã€xmanagerç­‰ï¼Œæ ¹æ®è‡ªå·±å–œæ¬¢çš„æ¥é€‰æ‹© <a href="https://www.netsarang.com/zh/all-downloads/">ä¸‹è½½åœ°å€</a>ï¼Œæˆ‘ç”¨çš„macç³»ç»Ÿæ“ä½œè¿™é‡Œå°±ç›´æ¥æ‰“å¼€ç»ˆç«¯ï¼Œé€‰æ‹©å·¦ä¸Šè§’çš„shellè¿›è¡Œä¸‹å›¾æ­¥éª¤æ“ä½œå°±å¯ï¼Œ<br><img src="/posts/a477be03/3.png" alt="å®˜ç½‘å›¾"><br><img src="/posts/a477be03/4.png" alt="image.png"></p>
<ul>
<li>è¿™é‡Œè¾“å…¥çš„æœåŠ¡å™¨åç§°æ˜¯è´­ä¹°æœåŠ¡å™¨æ—¶å€™ç»™ä½ å‘çš„åç§°é»˜è®¤rootï¼ŒIPåœ°å€å°±æ˜¯å…¬ç½‘çš„IPåœ°å€<br><img src="/posts/a477be03/5.png" alt="image.png"><br><img src="/posts/a477be03/6.png" alt="image.png"></li>
<li>ç‚¹å‡»è¿æ¥åï¼Œç»ˆç«¯ä¼šå¼¹å‡ºæ¥ï¼Œè®©è¾“å…¥å¯†ç <br><img src="/posts/a477be03/7.png" alt="è¾“å…¥å¯†ç "></li>
<li>è¾“å…¥å®Œå¯†ç åï¼Œç‚¹å‡»å›è½¦ï¼Œå³åˆ»è¿æ¥ä¸Šäº†</li>
</ul>
<h3 id="ç”¨yumè¿›è¡Œå®‰è£…å¿…è¦ç¨‹åºï¼Œå®‰è£…ä¸€äº›æœåŠ¡å’Œvimç¼–è¾‘å™¨"><a href="#ç”¨yumè¿›è¡Œå®‰è£…å¿…è¦ç¨‹åºï¼Œå®‰è£…ä¸€äº›æœåŠ¡å’Œvimç¼–è¾‘å™¨" class="headerlink" title="ç”¨yumè¿›è¡Œå®‰è£…å¿…è¦ç¨‹åºï¼Œå®‰è£…ä¸€äº›æœåŠ¡å’Œvimç¼–è¾‘å™¨"></a>ç”¨yumè¿›è¡Œå®‰è£…å¿…è¦ç¨‹åºï¼Œå®‰è£…ä¸€äº›æœåŠ¡å’Œvimç¼–è¾‘å™¨</h3><p>å…ˆæŸ¥çœ‹è¿æ¥çš„linuxæœåŠ¡å™¨æœ‰ä¹ˆæœ‰å®‰è£…yumï¼ˆè…¾è®¯äº‘é»˜è®¤æ˜¯å®‰è£…äº†ï¼‰</p>
<figure class="highlight vim"><table><tr><td class="code"><pre><span class="line">rpm -<span class="keyword">qa</span> | <span class="keyword">grep</span> yum</span><br></pre></td></tr></table></figure>
<p><img src="/posts/a477be03/8.png" alt="æŸ¥çœ‹æœ‰æ²¡æœ‰å®‰è£…yum"></p>
<figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line">yum -y install gcc gcc-c++ <span class="built_in">auto</span>conf pcre-devel make <span class="built_in">auto</span>make</span><br><span class="line">yum -y install wget httpd-tools vim</span><br></pre></td></tr></table></figure>
<ul>
<li>å®‰è£…å®Œæˆåï¼Œæ–°å»ºä¸€ä¸ªæ–‡ä»¶å­˜æ”¾æ–‡ä»¶çš„æ–‡ä»¶å¤¹<br><img src="/posts/a477be03/9.png" alt="æ–°å»ºæ–‡ä»¶å¤¹"></li>
<li>å†è¿›å…¥åˆ°æ–‡ä»¶å¤¹åˆ†åˆ«æ–°å»ºä¸‹é¢å‡ ä¸ªæ–‡ä»¶<br><code>app</code>  æ”¾ç¨‹åºç”¨<br><code>backup</code> æ”¾å¤‡ä»½æ–‡ä»¶<br><code>download</code> ä¸‹è½½çš„ä¸œè¥¿éƒ½æ”¾è¿™é‡Œ<br><code>logs</code> æ—¥å¿—æ”¾åœ¨è¿™é‡Œ<br><code>work</code> å·¥ä½œæ–‡æ¡£éƒ½æ”¾è¿™é‡Œ<br><img src="/posts/a477be03/10.png" alt="æ–°å»ºæ–‡ä»¶"></li>
</ul>
<h3 id="nginxä¸‹è½½"><a href="#nginxä¸‹è½½" class="headerlink" title="nginxä¸‹è½½"></a>nginxä¸‹è½½</h3><ul>
<li>ä¸‹è½½nginx <figure class="highlight cmake"><table><tr><td class="code"><pre><span class="line">yum <span class="keyword">install</span> nginx</span><br></pre></td></tr></table></figure></li>
<li>ä¸‹è½½å®Œæˆåï¼ŒæŸ¥çœ‹ä¸€ä¸‹ç‰ˆæœ¬<figure class="highlight ebnf"><table><tr><td class="code"><pre><span class="line"><span class="attribute">nginx -v</span></span><br></pre></td></tr></table></figure>

</li>
</ul>
<h3 id="nginxé…ç½®"><a href="#nginxé…ç½®" class="headerlink" title="nginxé…ç½®"></a>nginxé…ç½®</h3><p>åœ¨ä½¿ç”¨yumå®‰è£…å®ŒNginxåï¼Œéœ€è¦çŸ¥é“ç³»ç»Ÿä¸­å¤šäº†å“ªäº›æ–‡ä»¶ï¼Œå®ƒä»¬éƒ½å®‰è£…åˆ°äº†é‚£é‡Œã€‚å¯ä»¥ä½¿ç”¨ä¸‹é¢çš„å‘½ä»¤è¿›è¡ŒæŸ¥çœ‹ã€‚</p>
<ul>
<li><p>æŸ¥çœ‹Nginxçš„å®‰è£…ç›®å½•</p>
<figure class="highlight ebnf"><table><tr><td class="code"><pre><span class="line"><span class="attribute">rpm -ql nginx</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p><code>rpm</code>æ˜¯<code>linux</code>çš„<code>rpm</code>åŒ…ç®¡ç†å·¥å…·ï¼Œ<code>-q</code> ä»£è¡¨è¯¢é—®æ¨¡å¼ï¼Œ<code>-l</code> ä»£è¡¨è¿”å›åˆ—è¡¨ï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥æ‰¾åˆ°nginxçš„æ‰€æœ‰å®‰è£…ä½ç½®äº†ã€‚</p>
</blockquote>
</li>
<li><p>nginx.confæ–‡ä»¶è§£è¯»<br><code>nginx.conf</code> æ–‡ä»¶æ˜¯<code>Nginx</code>æ€»é…ç½®æ–‡ä»¶ï¼Œåœ¨æˆ‘ä»¬æ­å»ºæœåŠ¡å™¨æ—¶ç»å¸¸è°ƒæ•´çš„æ–‡ä»¶ã€‚</p>
</li>
<li><p>è¿›å…¥<code>etc/nginx</code>ç›®å½•ä¸‹ï¼Œç„¶åç”¨ <code>vim</code>è¿›è¡Œæ‰“å¼€<code>nginx.conf</code>æ–‡ä»¶</p>
<figure class="highlight vim"><table><tr><td class="code"><pre><span class="line"><span class="keyword">cd</span> /etc/nginx</span><br><span class="line"></span><br><span class="line"><span class="keyword">vim</span> nginx.<span class="keyword">conf</span></span><br></pre></td></tr></table></figure>
<figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line"><span class="comment">#è¿è¡Œç”¨æˆ·ï¼Œé»˜è®¤å³æ˜¯nginxï¼Œå¯ä»¥ä¸è¿›è¡Œè®¾ç½®</span></span><br><span class="line"><span class="attribute">user</span>  nginx;</span><br><span class="line"><span class="comment">#Nginxè¿›ç¨‹ï¼Œä¸€èˆ¬è®¾ç½®ä¸ºå’ŒCPUæ ¸æ•°ä¸€æ ·</span></span><br><span class="line"><span class="attribute">worker_processes</span>  <span class="number">1</span>; </span><br><span class="line"><span class="comment">#é”™è¯¯æ—¥å¿—å­˜æ”¾ç›®å½•</span></span><br><span class="line"><span class="attribute">error_log</span>  /var/log/nginx/<span class="literal">error</span>.log <span class="literal">warn</span>;</span><br><span class="line"><span class="comment">#è¿›ç¨‹pidå­˜æ”¾ä½ç½®</span></span><br><span class="line"><span class="attribute">pid</span>        /var/run/nginx.pid;</span><br><span class="line"><span class="section">events</span> &#123;</span><br><span class="line">    <span class="attribute">worker_connections</span>  <span class="number">1024</span>; <span class="comment"># å•ä¸ªåå°è¿›ç¨‹çš„æœ€å¤§å¹¶å‘æ•°</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="section">http</span> &#123;</span><br><span class="line">    <span class="attribute">include</span>       /etc/nginx/mime.types; <span class="comment">#æ–‡ä»¶æ‰©å±•åä¸ç±»å‹æ˜ å°„è¡¨</span></span><br><span class="line">    <span class="attribute">default_type</span>  application/octet-stream; <span class="comment">#é»˜è®¤æ–‡ä»¶ç±»å‹</span></span><br><span class="line">    <span class="comment">#è®¾ç½®æ—¥å¿—æ¨¡å¼</span></span><br><span class="line">    <span class="attribute">log_format</span>  main  <span class="string">&#x27;<span class="variable">$remote_addr</span> - <span class="variable">$remote_user</span> [<span class="variable">$time_local</span>] &quot;<span class="variable">$request</span>&quot; &#x27;</span></span><br><span class="line">                      <span class="string">&#x27;<span class="variable">$status</span> <span class="variable">$body_bytes_sent</span> &quot;<span class="variable">$http_referer</span>&quot; &#x27;</span></span><br><span class="line">                      <span class="string">&#x27;&quot;<span class="variable">$http_user_agent</span>&quot; &quot;<span class="variable">$http_x_forwarded_for</span>&quot;&#x27;</span>;</span><br><span class="line">    <span class="comment">#nginxè®¿é—®æ—¥å¿—å­˜æ”¾ä½ç½®</span></span><br><span class="line">    <span class="attribute">access_log</span>  /var/log/nginx/access.log  main;</span><br><span class="line">    <span class="comment">#å¼€å¯é«˜æ•ˆä¼ è¾“æ¨¡å¼</span></span><br><span class="line">    <span class="attribute">sendfile</span>        <span class="literal">on</span>;</span><br><span class="line">    <span class="comment">#å‡å°‘ç½‘ç»œæŠ¥æ–‡æ®µçš„æ•°é‡</span></span><br><span class="line">    <span class="comment">#tcp_nopush     on;</span></span><br><span class="line">    <span class="comment">#ä¿æŒè¿æ¥çš„æ—¶é—´ï¼Œä¹Ÿå«è¶…æ—¶æ—¶é—´</span></span><br><span class="line">    <span class="attribute">keepalive_timeout</span>  <span class="number">65</span>;</span><br><span class="line">   <span class="comment">#å¼€å¯gzipå‹ç¼©</span></span><br><span class="line">    <span class="comment">#gzip  on;</span></span><br><span class="line">    <span class="comment">#åŒ…å«çš„å­é…ç½®é¡¹ä½ç½®å’Œæ–‡ä»¶</span></span><br><span class="line">    <span class="attribute">include</span> /etc/nginx/conf.d/<span class="regexp">*.conf</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li><p>æŸ¥çœ‹åˆ°<code>nginx.conf</code>æ–‡ä»¶ä¸­æœ€åº•ä¸‹éƒ¨åˆ†æœ‰ä¸ª<code>include /etc/nginx/conf.d/*.conf;</code><br>åœ¨é€šè¿‡å‘½ä»¤è¿›å…¥åˆ°<code>/etc/nginx/conf.d</code>æ–‡ä»¶å¤¹ä¸‹é¢ï¼Œé€šè¿‡<code>vim default.conf</code>æ‰“å¼€æ–‡ä»¶</p>
<figure class="highlight awk"><table><tr><td class="code"><pre><span class="line">server &#123;</span><br><span class="line">    listen       <span class="number">80</span>;   <span class="comment">#é…ç½®ç›‘å¬ç«¯å£</span></span><br><span class="line">    server_name  localhost;  <span class="regexp">//</span>é…ç½®åŸŸå</span><br><span class="line"></span><br><span class="line">    <span class="comment">#charset koi8-r;     </span></span><br><span class="line">    <span class="comment">#access_log  /var/log/nginx/host.access.log  main;</span></span><br><span class="line"></span><br><span class="line">    location / &#123;</span><br><span class="line">        root   <span class="regexp">/usr/</span>share<span class="regexp">/nginx/</span>html;     <span class="comment">#æœåŠ¡é»˜è®¤å¯åŠ¨ç›®å½•</span></span><br><span class="line">        index  index.html index.htm;    <span class="comment">#é»˜è®¤è®¿é—®æ–‡ä»¶</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">#error_page  404              /404.html;   # é…ç½®404é¡µé¢</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># redirect server error pages to the static page /50x.html</span></span><br><span class="line">    <span class="comment">#</span></span><br><span class="line">    error_page   <span class="number">500</span> <span class="number">502</span> <span class="number">503</span> <span class="number">504</span>  /<span class="number">50</span>x.html;   <span class="comment">#é”™è¯¯çŠ¶æ€ç çš„æ˜¾ç¤ºé¡µé¢ï¼Œé…ç½®åéœ€è¦é‡å¯</span></span><br><span class="line">    location = /<span class="number">50</span>x.html &#123;</span><br><span class="line">        root   <span class="regexp">/usr/</span>share<span class="regexp">/nginx/</span>html;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment"># proxy the PHP scripts to Apache listening on 127.0.0.1:80</span></span><br><span class="line">    <span class="comment">#</span></span><br><span class="line">    <span class="comment">#location ~ \.php$ &#123;</span></span><br><span class="line">    <span class="comment">#    proxy_pass   http://127.0.0.1;</span></span><br><span class="line">    <span class="comment">#&#125;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># pass the PHP scripts to FastCGI server listening on 127.0.0.1:9000</span></span><br><span class="line">    <span class="comment">#</span></span><br><span class="line">    <span class="comment">#location ~ \.php$ &#123;</span></span><br><span class="line">    <span class="comment">#    root           html;</span></span><br><span class="line">    <span class="comment">#    fastcgi_pass   127.0.0.1:9000;</span></span><br><span class="line">    <span class="comment">#    fastcgi_index  index.php;</span></span><br><span class="line">    <span class="comment">#    fastcgi_param  SCRIPT_FILENAME  /scripts$fastcgi_script_name;</span></span><br><span class="line">    <span class="comment">#    include        fastcgi_params;</span></span><br><span class="line">    <span class="comment">#&#125;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># deny access to .htaccess files, if Apache&#x27;s document root</span></span><br><span class="line">    <span class="comment"># concurs with nginx&#x27;s one</span></span><br><span class="line">    <span class="comment">#</span></span><br><span class="line">    <span class="comment">#location ~ /\.ht &#123;</span></span><br><span class="line">    <span class="comment">#    deny  all;</span></span><br><span class="line">    <span class="comment">#&#125;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li><p>è¿™é‡Œè¡¥å……ä¸€ä¸‹<code>vim</code>è¿›è¡Œç¼–è¾‘çš„ä¸€ä¸ªç®€å•æ“ä½œ</p>
<ol>
<li>æ‰“å¼€æ–‡ä»¶ï¼Œé¦–å…ˆè¿›å…¥ å‘½ä»¤æ¨¡å¼</li>
<li>æŒ‰ä¸‹ <code>i(insert)</code> è¿›å…¥ ç¼–è¾‘æ¨¡å¼</li>
<li>æŒ‰ä¸‹ <code>esc</code>å†æŒ‰ä¸‹ <code>: </code>è¿›å…¥ æœ«è¡Œæ¨¡å¼ ï¼Œä»¥ä¸‹ä¸ºå‘½ä»¤åŠŸèƒ½è¯´æ˜</li>
</ol>
</li>
</ul>
<table>
<thead>
<tr>
<th>å‘½ä»¤</th>
<th>è‹±æ–‡</th>
<th>ä½œç”¨</th>
</tr>
</thead>
<tbody><tr>
<td><code>:w</code></td>
<td><code>write</code></td>
<td>ä¿å­˜</td>
</tr>
<tr>
<td><code>:q</code></td>
<td><code>quit</code></td>
<td>é€€å‡º</td>
</tr>
<tr>
<td><code>:q!</code></td>
<td></td>
<td>å¼ºåˆ¶é€€å‡º</td>
</tr>
<tr>
<td><code>:wq</code></td>
<td><code>write &amp; quit</code></td>
<td>å¼ºåˆ¶ä¿å­˜å¹¶é€€å‡º</td>
</tr>
<tr>
<td><code>:x</code></td>
<td></td>
<td>ä¿å­˜å¹¶é€€å‡º</td>
</tr>
</tbody></table>
<h3 id="nginxå¯åŠ¨ï¼Œå…³é—­"><a href="#nginxå¯åŠ¨ï¼Œå…³é—­" class="headerlink" title="nginxå¯åŠ¨ï¼Œå…³é—­"></a>nginxå¯åŠ¨ï¼Œå…³é—­</h3><ul>
<li>æŸ¥çœ‹nginxæœ‰æ²¡æœ‰å¯åŠ¨ï¼Œå¦‚æœå‡ºç°ä¸‰æ¡è®°å½•å°±è¯´æ˜å¼€å¯äº†<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">ps aux | grep nginx</span><br></pre></td></tr></table></figure>
<img src="/posts/a477be03/11.png" alt="æŸ¥çœ‹nginxè¿è¡ŒçŠ¶æ€"></li>
<li>å¯åŠ¨nginx<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">nginx</span><br></pre></td></tr></table></figure></li>
<li>åœæ­¢nginx<br>æ–¹æ³•ä¸€ï¼šç«‹åˆ»åœæ­¢ï¼Œæ— è®ºç¨‹åºæœ‰æ²¡æœ‰è¿è¡Œå®Œï¼Œéƒ½ç«‹åˆ»åœæ­¢<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">nginx  -s stop</span><br></pre></td></tr></table></figure>
æ–¹æ³•äºŒï¼šä»å®¹åœæ­¢ï¼Œæœ‰æœªè¿è¡Œå®Œçš„ç¨‹åºï¼Œè¿è¡Œå®Œæˆåæ‰åœæ­¢<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">nginx -s quit</span><br></pre></td></tr></table></figure></li>
<li>killall æ–¹æ³•æ€æ­»è¿›ç¨‹<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">killall nginx</span><br></pre></td></tr></table></figure></li>
<li>æŸ¥çœ‹ç«¯å£<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">netstat -tlnp</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h3 id="è‡ªå®šä¹‰é”™è¯¯é¡µé¢"><a href="#è‡ªå®šä¹‰é”™è¯¯é¡µé¢" class="headerlink" title="è‡ªå®šä¹‰é”™è¯¯é¡µé¢"></a>è‡ªå®šä¹‰é”™è¯¯é¡µé¢</h3><p>æˆ‘ä»¬åœ¨ä¸Šé¢çš„æ—¶å€™çœ‹åˆ°äº†<code>/etc/nginx/conf.d/default.conf</code>æ–‡ä»¶ä¸­</p>
<figure class="highlight awk"><table><tr><td class="code"><pre><span class="line">error_page   <span class="number">500</span> <span class="number">502</span> <span class="number">503</span> <span class="number">504</span>  /<span class="number">50</span>x.html;   <span class="comment">#é”™è¯¯çŠ¶æ€ç çš„æ˜¾ç¤ºé¡µé¢ï¼Œé…ç½®åéœ€è¦é‡å¯</span></span><br><span class="line">    location = /<span class="number">50</span>x.html &#123;</span><br><span class="line">        root   <span class="regexp">/usr/</span>share<span class="regexp">/nginx/</span>html;   <span class="regexp">//</span>å‡ºç°ä¸Šé¢çŠ¶æ€é”™è¯¯çš„æ—¶å€™ï¼Œè¿›å…¥çš„é¡µé¢</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<h3 id="ä½¿ç”¨åŸŸåè®¾ç½®è™šæ‹Ÿä¸»æœº"><a href="#ä½¿ç”¨åŸŸåè®¾ç½®è™šæ‹Ÿä¸»æœº" class="headerlink" title="ä½¿ç”¨åŸŸåè®¾ç½®è™šæ‹Ÿä¸»æœº"></a>ä½¿ç”¨åŸŸåè®¾ç½®è™šæ‹Ÿä¸»æœº</h3><p>ä¿®æ”¹<code>etc/nginx/conf.d</code>ç›®å½•ä¸‹çš„<code>default.conf</code> æ–‡ä»¶ï¼ŒæŠŠåŸæ¥çš„80ç«¯å£è™šæ‹Ÿä¸»æœºæ”¹ä¸ºä»¥åŸŸååˆ’åˆ†çš„è™šæ‹Ÿä¸»æœºã€‚ä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight pgsql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">server</span> &#123;</span><br><span class="line">    <span class="keyword">listen</span>       <span class="number">80</span>;</span><br><span class="line">    server_name  www.yubo365.cn;</span><br><span class="line">    <span class="keyword">location</span> / &#123;</span><br><span class="line">        root   /usr/<span class="keyword">share</span>/nginx/html;</span><br><span class="line">        <span class="keyword">index</span>  <span class="keyword">index</span>.html <span class="keyword">index</span>.htm;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<p>è¿™æ—¶å€™æˆ‘ä»¬å†é‡å¯æœåŠ¡ï¼Œç„¶åå±äºåŸŸåå°±å¯ä»¥çœ‹åˆ°äº†ï¼Œè¿™é‡Œæ‰¾çš„æ˜¯<code> /usr/share/nginx/html</code>æ–‡ä»¶ä¸‹é¢çš„ <code>index.html</code>æ–‡ä»¶</p>
<h3 id="è®¾ç½®åå‘ä»£ç†"><a href="#è®¾ç½®åå‘ä»£ç†" class="headerlink" title="è®¾ç½®åå‘ä»£ç†"></a>è®¾ç½®åå‘ä»£ç†</h3><p>æ­£å¸¸ä»£ç†çš„æ˜¯ipåœ°å€ï¼Œè¿™é‡Œç”¨åŸŸåä¹Ÿæ˜¯å¯ä»¥çš„</p>
<figure class="highlight crmsh"><table><tr><td class="code"><pre><span class="line">server&#123;</span><br><span class="line">        listen <span class="number">80</span>;</span><br><span class="line">        server_name www.yubo365.cn;</span><br><span class="line">        <span class="keyword">location</span> <span class="title">/ &#123;</span></span><br><span class="line"><span class="title">               proxy_pass</span> https://baidu.com;</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å…¶å®ƒåå‘ä»£ç†æŒ‡ä»¤ï¼š</p>
<ul>
<li>proxy_set_header :åœ¨å°†å®¢æˆ·ç«¯è¯·æ±‚å‘é€ç»™åç«¯æœåŠ¡å™¨ä¹‹å‰ï¼Œæ›´æ”¹æ¥è‡ªå®¢æˆ·ç«¯çš„è¯·æ±‚å¤´ä¿¡æ¯ã€‚</li>
<li>proxy_connect_timeout:é…ç½®Nginxä¸åç«¯ä»£ç†æœåŠ¡å™¨å°è¯•å»ºç«‹è¿æ¥çš„è¶…æ—¶æ—¶é—´ã€‚</li>
<li>proxy_read_timeout : é…ç½®Nginxå‘åç«¯æœåŠ¡å™¨ç»„å‘å‡ºreadè¯·æ±‚åï¼Œç­‰å¾…ç›¸åº”çš„è¶…æ—¶æ—¶é—´ã€‚</li>
<li>proxy_send_timeoutï¼šé…ç½®Nginxå‘åç«¯æœåŠ¡å™¨ç»„å‘å‡ºwriteè¯·æ±‚åï¼Œç­‰å¾…ç›¸åº”çš„è¶…æ—¶æ—¶é—´ã€‚</li>
<li>proxy_redirect :ç”¨äºä¿®æ”¹åç«¯æœåŠ¡å™¨è¿”å›çš„å“åº”å¤´ä¸­çš„Locationå’ŒRefreshã€‚</li>
</ul>
<h3 id="Nginxé€‚é…PCæˆ–ç§»åŠ¨è®¾å¤‡"><a href="#Nginxé€‚é…PCæˆ–ç§»åŠ¨è®¾å¤‡" class="headerlink" title="Nginxé€‚é…PCæˆ–ç§»åŠ¨è®¾å¤‡"></a>Nginxé€‚é…PCæˆ–ç§»åŠ¨è®¾å¤‡</h3><p>è¿™é‡Œæ˜¯åœ¨<code>/usr/share/nginx/</code>æ–‡ä»¶å¤¹ä¸‹é¢åˆ›å»º<code>pc</code>å’Œ<code>mobile</code>æ–‡ä»¶ï¼Œç„¶åé€šè¿‡<code>$http_user_agent </code>æ­£åˆ™åˆ¤æ–­æ¥é€‰æ‹©è¿›å…¥åˆ°PCè¿˜æ˜¯ç§»åŠ¨ç«¯çš„index</p>
<figure class="highlight awk"><table><tr><td class="code"><pre><span class="line">location / &#123;</span><br><span class="line">       root   <span class="regexp">/usr/</span>share<span class="regexp">/nginx/</span>pc;</span><br><span class="line">       <span class="keyword">if</span> (<span class="variable">$http_user_agent</span> ~* <span class="string">&quot;(Android|iPhone|Windows Phone|UC|Kindle)&quot;</span>)&#123;</span><br><span class="line">         root <span class="regexp">/usr/</span>share<span class="regexp">/nginx/m</span>obile;</span><br><span class="line">       &#125;</span><br><span class="line">       index  index.html;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<h3 id="å¼€å¯nginxçš„gzipå‹ç¼©"><a href="#å¼€å¯nginxçš„gzipå‹ç¼©" class="headerlink" title="å¼€å¯nginxçš„gzipå‹ç¼©"></a>å¼€å¯nginxçš„gzipå‹ç¼©</h3><p>Gzipæ˜¯ç½‘é¡µçš„ä¸€ç§ç½‘é¡µå‹ç¼©æŠ€æœ¯ï¼Œç»è¿‡gzipå‹ç¼©åï¼Œé¡µé¢å¤§å°å¯ä»¥å˜ä¸ºåŸæ¥çš„30%ç”šè‡³æ›´å°ã€‚æ›´å°çš„ç½‘é¡µä¼šè®©ç”¨æˆ·æµè§ˆçš„ä½“éªŒæ›´å¥½ï¼Œé€Ÿåº¦æ›´å¿«ï¼Œä¸‹é¢ç®€å•é…ç½®ä»£ç </p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">http &#123;</span><br><span class="line">    gzip on;</span><br><span class="line">    gzip_comp_level 8;</span><br><span class="line">    gzip_types text/plain application/javascript text/css;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="/posts/a477be03/12.png" alt="éƒ¨åˆ†ä»£ç "><br>é…ç½®å¥½ä»¥åï¼Œé‡å¯æœåŠ¡ï¼ŒæŸ¥çœ‹HTTPå“åº”å¤´ä¿¡æ¯ã€‚ä½ å¯ä»¥çœ‹è§Content-Encodingä¸ºgzipç±»å‹ã€‚<br><img src="/posts/a477be03/13.png" alt="æµè§ˆå™¨æˆªå›¾"><br>Nginxæä¾›äº†ä¸“é—¨çš„gzipæ¨¡å—ï¼Œå¹¶ä¸”æ¨¡å—ä¸­çš„æŒ‡ä»¤éå¸¸ä¸°å¯Œï¼Œä¸‹é¢å¯ä»¥æŸ¥çœ‹ï¼š</p>
<ul>
<li>gzip :  è¯¥æŒ‡ä»¤ç”¨äºå¼€å¯ï¼ˆonï¼‰æˆ– å…³é—­ï¼ˆoffï¼‰gzipæ¨¡å—ã€‚</li>
<li>gzip_buffers : è®¾ç½®ç³»ç»Ÿè·å–å‡ ä¸ªå•ä½çš„ç¼“å­˜ç”¨äºå­˜å‚¨gzipçš„å‹ç¼©ç»“æœæ•°æ®æµã€‚</li>
<li>gzip_comp_level : gzipå‹ç¼©æ¯”ï¼Œå‹ç¼©çº§åˆ«æ˜¯1-9ï¼Œ1çš„å‹ç¼©çº§åˆ«æœ€ä½ï¼Œ9çš„å‹ç¼©çº§åˆ«æœ€é«˜ã€‚å‹ç¼©çº§åˆ«è¶Šé«˜å‹ç¼©ç‡è¶Šå¤§ï¼Œå‹ç¼©æ—¶é—´è¶Šé•¿ã€‚</li>
<li>gzip_disable : å¯ä»¥é€šè¿‡è¯¥æŒ‡ä»¤å¯¹ä¸€äº›ç‰¹å®šçš„User-Agentä¸ä½¿ç”¨å‹ç¼©åŠŸèƒ½ã€‚</li>
<li>gzip_min_length:è®¾ç½®å…è®¸å‹ç¼©çš„é¡µé¢æœ€å°å­—èŠ‚æ•°ï¼Œé¡µé¢å­—èŠ‚æ•°ä»ç›¸åº”æ¶ˆæ¯å¤´çš„Content-lengthä¸­è¿›è¡Œè·å–ã€‚</li>
<li>gzip_http_versionï¼šè¯†åˆ«HTTPåè®®ç‰ˆæœ¬ï¼Œå…¶å€¼å¯ä»¥æ˜¯1.1.æˆ–1.0.</li>
<li>gzip_proxied : ç”¨äºè®¾ç½®å¯ç”¨æˆ–ç¦ç”¨ä»ä»£ç†æœåŠ¡å™¨ä¸Šæ”¶åˆ°ç›¸åº”å†…å®¹gzipå‹ç¼©ã€‚</li>
<li>gzip_vary : ç”¨äºåœ¨å“åº”æ¶ˆæ¯å¤´ä¸­æ·»åŠ Varyï¼šAccept-Encoding,ä½¿ä»£ç†æœåŠ¡å™¨æ ¹æ®è¯·æ±‚å¤´ä¸­çš„Accept-Encodingè¯†åˆ«æ˜¯å¦å¯ç”¨gzipå‹ç¼©ã€‚</li>
</ul>
<blockquote>
<p>æœ€ååˆ†äº«ä¸€ä¸ªå¯ä»¥åœ¨çº¿å‹ç¼©æ£€æµ‹çš„ç«™é•¿å·¥å…·<a href="https://tool.chinaz.com/Gzips">https://tool.chinaz.com/Gzips</a></p>
</blockquote>
]]></content>
      <categories>
        <category>webå‰ç«¯</category>
      </categories>
      <tags>
        <tag>nginx</tag>
        <tag>è…¾è®¯äº‘æœåŠ¡å™¨</tag>
      </tags>
  </entry>
  <entry>
    <title>nginx/1.18.0è¿›è¡ŒSSLè¯ä¹¦é…ç½®</title>
    <url>/posts/5510b3d9.html</url>
    <content><![CDATA[<p>æœåŠ¡å™¨ï¼šè…¾è®¯äº‘æœåŠ¡å™¨<br>nginxç‰ˆæœ¬ï¼šnginx/1.18.0 <a href="http://nginx.org/en/download.html">nginxä¸‹è½½åœ°å€</a><br>CentOS:   CentOS Linux release 7.6.1810 (Core)</p>
<span id="more"></span>
<h3 id="æŸ¥çœ‹å®‰è£…æ¨¡å—"><a href="#æŸ¥çœ‹å®‰è£…æ¨¡å—" class="headerlink" title="æŸ¥çœ‹å®‰è£…æ¨¡å—"></a>æŸ¥çœ‹å®‰è£…æ¨¡å—</h3><ul>
<li>æŸ¥çœ‹å®‰è£…äº†å“ªäº›æ¨¡å—ï¼Œ<code>nginx -V</code> æ˜¾ç¤ºçš„å¾ˆä¹±ï¼Œçœ‹èµ·æ¥ä¸æ˜¯å¾ˆæ–¹ä¾¿ï¼Œå¦‚ä¸‹ï¼š<br><img src="/posts/5510b3d9/1.png" alt="æ²¡æ’ç‰ˆçš„æ ·å¼"></li>
<li>è¾“å…¥ä¸‹é¢çš„å‘½ä»¤ï¼Œå°±å¯ä»¥å¾ˆæ¸…æ™°æŸ¥çœ‹å®‰è£…äº†å“ªäº›æ¨¡å—äº†<figure class="highlight apache"><table><tr><td class="code"><pre><span class="line"><span class="attribute">nginx</span> -V <span class="number">2</span>&gt;&amp;<span class="number">1</span> | sed <span class="string">&quot;s/\s\+--/\n --/g&quot;</span></span><br></pre></td></tr></table></figure>
<img src="/posts/5510b3d9/2.png" alt="æ’ç‰ˆåçš„æ ·å¼"></li>
</ul>
<h3 id="é…ç½®SSLè¯ä¹¦"><a href="#é…ç½®SSLè¯ä¹¦" class="headerlink" title="é…ç½®SSLè¯ä¹¦"></a>é…ç½®SSLè¯ä¹¦</h3><ul>
<li>è¿™é‡Œæˆ‘ç”¨çš„æ˜¯è…¾è®¯äº‘æœåŠ¡å™¨ï¼Œç‚¹å‡»ä¸‹è½½è¯ä¹¦<br><img src="/posts/5510b3d9/3.png" alt="ä¸‹è½½ä½ç½®"></li>
<li>ä¸‹è½½åæœ‰ä¸ªè¿™ä¸ªæ–‡ä»¶å¤¹<br><img src="/posts/5510b3d9/4.png" alt="ä¸‹è½½åæ–‡ä»¶å¤¹"></li>
<li>æ‰“å¼€æ–‡ä»¶å¤¹ï¼Œæ‰¾åˆ°nginxæ–‡ä»¶<br><img src="/posts/5510b3d9/5.png" alt="å›¾ç¤º"></li>
<li>æ‰“å¼€nginxæ–‡ä»¶é‡Œé¢ä¸¤ä¸ªæ–‡ä»¶å¤åˆ¶ä¸€ä¸‹<br><img src="/posts/5510b3d9/6.png" alt="å›¾ç¤º"></li>
<li>è¿™ä¸ªæ—¶å€™è¿æ¥åˆ°äº‘æœåŠ¡å™¨<br>æŠŠåˆšåˆšnginxæ–‡ä»¶é‡Œé¢å¤åˆ¶çš„ä¸¤ä¸ªæ–‡ä»¶ï¼Œæ”¾åœ¨<code>/etc/nginx/conf</code>æ–‡ä»¶ä¸­<br><img src="/posts/5510b3d9/7.png" alt="å›¾ç¤º"></li>
<li>é€šè¿‡<code>vim /etc/nginx/conf.d/default.conf</code>è¿›è¡Œç¼–è¾‘é…ç½®ï¼Œå°†ä¸‹é¢çš„<code>www.yubo365.cn</code>æ¢æˆä½ çš„åŸŸå<figure class="highlight nginx"><table><tr><td class="code"><pre><span class="line"><span class="section">server</span> &#123;</span><br><span class="line">    <span class="attribute">listen</span>       <span class="number">80</span>;</span><br><span class="line">    <span class="comment">#server_name  localhost;</span></span><br><span class="line">    <span class="attribute">server_name</span> www.yubo365.cn;</span><br><span class="line">    <span class="attribute">return</span>       <span class="number">301</span> https://<span class="variable">$server_name</span><span class="variable">$request_uri</span>;</span><br><span class="line">    <span class="comment">#charset koi8-r;</span></span><br><span class="line">    <span class="comment">#access_log  /var/log/nginx/host.access.log  main;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">#location / &#123;</span></span><br><span class="line">        <span class="comment">#root   /usr/share/nginx/html;</span></span><br><span class="line">        <span class="comment">#index  index.html index.htm;</span></span><br><span class="line">    <span class="comment">#&#125;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">#error_page  404              /404.html;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># redirect server error pages to the static page /50x.html</span></span><br><span class="line">    <span class="comment">#</span></span><br><span class="line">    <span class="comment">#error_page   500 502 503 504  /50x.html;</span></span><br><span class="line">    <span class="comment">#location = /50x.html &#123;</span></span><br><span class="line">        <span class="comment">#root   /usr/share/nginx/html;</span></span><br><span class="line">    <span class="comment">#&#125;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># proxy the PHP scripts to Apache listening on 127.0.0.1:80</span></span><br><span class="line">    <span class="comment">#</span></span><br><span class="line">    <span class="comment">#location ~ \.php$ &#123;</span></span><br><span class="line">    <span class="comment">#    proxy_pass   http://127.0.0.1;</span></span><br><span class="line">    <span class="comment">#&#125;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># pass the PHP scripts to FastCGI server listening on 127.0.0.1:9000</span></span><br><span class="line">    <span class="comment">#</span></span><br><span class="line">    <span class="comment">#location ~ \.php$ &#123;</span></span><br><span class="line">    <span class="comment">#    root           html;</span></span><br><span class="line">    <span class="comment">#    fastcgi_pass   127.0.0.1:9000;</span></span><br><span class="line">    <span class="comment">#    fastcgi_index  index.php;</span></span><br><span class="line">    <span class="comment">#    fastcgi_param  SCRIPT_FILENAME  /scripts$fastcgi_script_name;</span></span><br><span class="line">    <span class="comment">#    include        fastcgi_params;</span></span><br><span class="line">    <span class="comment">#&#125;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># deny access to .htaccess files, if Apache&#x27;s document root</span></span><br><span class="line">    <span class="comment"># concurs with nginx&#x27;s one</span></span><br><span class="line">    <span class="comment">#</span></span><br><span class="line">    <span class="comment">#location ~ /\.ht &#123;</span></span><br><span class="line">    <span class="comment">#    deny  all;</span></span><br><span class="line">    <span class="comment">#&#125;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="section">server</span> &#123;</span><br><span class="line">    <span class="attribute">listen</span>       <span class="number">443</span> ssl;  <span class="comment"># nginx1.15ä¹‹åç”¨è¿™ä¸ªè¯­æ³•,è€çš„è¯­æ³•æ˜¯ssl on;</span></span><br><span class="line">    <span class="attribute">server_name</span>  service.yuming.com;</span><br><span class="line">    <span class="attribute">ssl_certificate</span>   /etc/nginx/conf/1_www.yubo365.cn_bundle.crt;</span><br><span class="line">    <span class="attribute">ssl_certificate_key</span>  /etc/nginx/conf/2_www.yubo365.cn.key;</span><br><span class="line">    <span class="attribute">ssl_session_timeout</span> <span class="number">5m</span>;</span><br><span class="line">    <span class="attribute">ssl_protocols</span> TLSv1 TLSv1.<span class="number">1</span> TLSv1.<span class="number">2</span>;</span><br><span class="line">    <span class="attribute">ssl_ciphers</span> ECDHE-RSA-AES128-GCM-SHA256:HIGH:!aNULL:!MD5:!RC4:!DHE;        </span><br><span class="line">    <span class="attribute">ssl_prefer_server_ciphers</span> <span class="literal">on</span>;</span><br><span class="line">    <span class="section">location</span> / &#123;</span><br><span class="line">       <span class="attribute">root</span>   /usr/share/nginx/html;</span><br><span class="line">       <span class="attribute">index</span>  index.html index.htm;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">#location / &#123;</span></span><br><span class="line">       <span class="comment">#proxy_set_header Host $http_host;</span></span><br><span class="line">       <span class="comment">#proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;</span></span><br><span class="line">       <span class="comment">#proxy_set_header X-Real-Ip $remote_addr;</span></span><br><span class="line">       <span class="comment">#proxy_set_header X-NginX-Proxy true;</span></span><br><span class="line">       <span class="comment">#proxy_pass http://localhost:8081;</span></span><br><span class="line">       <span class="comment">#proxy_redirect off;</span></span><br><span class="line">    <span class="comment">#&#125;</span></span><br><span class="line">    <span class="attribute">error_page</span>   <span class="number">500</span> <span class="number">502</span> <span class="number">503</span> <span class="number">504</span>  /50x.html;</span><br><span class="line">    <span class="section">location</span> = /50x.html &#123;</span><br><span class="line">        <span class="attribute">root</span>   /usr/share/nginx/html;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h3 id="å¼€å¯80-443ç«¯å£"><a href="#å¼€å¯80-443ç«¯å£" class="headerlink" title="å¼€å¯80/443ç«¯å£"></a>å¼€å¯80/443ç«¯å£</h3><p>è¿›å…¥åˆ°è´­ä¹°çš„è…¾è®¯äº‘æœåŠ¡å™¨åå°ï¼ŒæœåŠ¡å™¨å®‰å…¨ç»„å¼€å¯80/443ç«¯å£ï¼Œå› ä¸ºhttpsé»˜è®¤çš„æ˜¯443ç«¯å£ã€‚  </p>
<ul>
<li>é…ç½®å¥½ä»¥åï¼Œé‡å¯ä¸‹æœåŠ¡å™¨<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">//å…³é—­</span><br><span class="line">nginx -s quit</span><br><span class="line"></span><br><span class="line">//å¼€å¯nginx</span><br><span class="line">nginx</span><br></pre></td></tr></table></figure></li>
<li>è®¿é—®<a href="https://www.yubo365.cn/">https://www.yubo365.cn/</a><br><img src="/posts/5510b3d9/8.png" alt="httpså›¾ç¤º"><br>å¯ä»¥çœ‹åˆ°å°é”è¿æ¥æ˜¯ç»¿è‰²çš„è¯´æ˜å·²ç»é…ç½®æˆåŠŸäº†</li>
</ul>
]]></content>
      <categories>
        <category>webå‰ç«¯</category>
      </categories>
      <tags>
        <tag>nginx</tag>
      </tags>
  </entry>
  <entry>
    <title>npmçš„é•œåƒæºä»¥åŠä»£ç†çš„æŸ¥çœ‹å’Œé…ç½®</title>
    <url>/posts/b660c1ef.html</url>
    <content><![CDATA[<h3 id="é•œåƒæº"><a href="#é•œåƒæº" class="headerlink" title="é•œåƒæº"></a>é•œåƒæº</h3><h4 id="æŸ¥è¯¢å½“å‰é•œåƒæº"><a href="#æŸ¥è¯¢å½“å‰é•œåƒæº" class="headerlink" title="æŸ¥è¯¢å½“å‰é•œåƒæº"></a>æŸ¥è¯¢å½“å‰é•œåƒæº</h4><figure class="highlight routeros"><table><tr><td class="code"><pre><span class="line">npm <span class="built_in">get</span> registry</span><br></pre></td></tr></table></figure>
<h4 id="è®¾ç½®ä¸ºæ·˜å®é•œåƒ"><a href="#è®¾ç½®ä¸ºæ·˜å®é•œåƒ" class="headerlink" title="è®¾ç½®ä¸ºæ·˜å®é•œåƒ"></a>è®¾ç½®ä¸ºæ·˜å®é•œåƒ</h4><figure class="highlight tcl"><table><tr><td class="code"><pre><span class="line">npm config <span class="keyword">set</span> <span class="keyword">registry</span> <span class="keyword">http</span>://<span class="keyword">registry</span>.npm.taobao.org/</span><br></pre></td></tr></table></figure>
<p>ä¸‹è½½cnpmæ·˜å®é•œåƒ</p>
<figure class="highlight awk"><table><tr><td class="code"><pre><span class="line">npm install -g cnpm --registry=https:<span class="regexp">//</span>registry.npm.taobao.org</span><br></pre></td></tr></table></figure>
<h4 id="è®¾ç½®é»˜è®¤çš„å®˜æ–¹é•œåƒ"><a href="#è®¾ç½®é»˜è®¤çš„å®˜æ–¹é•œåƒ" class="headerlink" title="è®¾ç½®é»˜è®¤çš„å®˜æ–¹é•œåƒ"></a>è®¾ç½®é»˜è®¤çš„å®˜æ–¹é•œåƒ</h4><figure class="highlight arduino"><table><tr><td class="code"><pre><span class="line">npm config set registry https:<span class="comment">//registry.npmjs.org/</span></span><br></pre></td></tr></table></figure>
<h4 id="æŸ¥çœ‹å’Œåˆ é™¤è®¾ç½®çš„æ·˜å®é•œåƒ"><a href="#æŸ¥çœ‹å’Œåˆ é™¤è®¾ç½®çš„æ·˜å®é•œåƒ" class="headerlink" title="æŸ¥çœ‹å’Œåˆ é™¤è®¾ç½®çš„æ·˜å®é•œåƒ"></a>æŸ¥çœ‹å’Œåˆ é™¤è®¾ç½®çš„æ·˜å®é•œåƒ</h4><figure class="highlight routeros"><table><tr><td class="code"><pre><span class="line">npm<span class="built_in"> config </span><span class="built_in">get</span> å‰é¢è®¾ç½®çš„åå­—</span><br></pre></td></tr></table></figure>
<figure class="highlight arduino"><table><tr><td class="code"><pre><span class="line">npm config <span class="keyword">delete</span> å‰é¢è®¾ç½®åå­—</span><br></pre></td></tr></table></figure>
<h3 id="npmä»£ç†"><a href="#npmä»£ç†" class="headerlink" title="npmä»£ç†"></a>npmä»£ç†</h3><h4 id="æŸ¥çœ‹å½“å‰ä»£ç†"><a href="#æŸ¥çœ‹å½“å‰ä»£ç†" class="headerlink" title="æŸ¥çœ‹å½“å‰ä»£ç†"></a>æŸ¥çœ‹å½“å‰ä»£ç†</h4><figure class="highlight routeros"><table><tr><td class="code"><pre><span class="line">npm<span class="built_in"> config </span><span class="built_in">get</span> proxy</span><br></pre></td></tr></table></figure>
<figure class="highlight routeros"><table><tr><td class="code"><pre><span class="line">npm<span class="built_in"> config </span><span class="built_in">get</span> https-proxy</span><br></pre></td></tr></table></figure>
<h4 id="è®¾ç½®ä»£ç†"><a href="#è®¾ç½®ä»£ç†" class="headerlink" title="è®¾ç½®ä»£ç†"></a>è®¾ç½®ä»£ç†</h4><figure class="highlight arduino"><table><tr><td class="code"><pre><span class="line">npm config set proxy http:<span class="comment">//server:port</span></span><br></pre></td></tr></table></figure>
<figure class="highlight arduino"><table><tr><td class="code"><pre><span class="line">npm config set https-proxy http:<span class="comment">//server:port</span></span><br></pre></td></tr></table></figure>
<h4 id="åˆ é™¤ä»£ç†"><a href="#åˆ é™¤ä»£ç†" class="headerlink" title="åˆ é™¤ä»£ç†"></a>åˆ é™¤ä»£ç†</h4><figure class="highlight routeros"><table><tr><td class="code"><pre><span class="line">npm<span class="built_in"> config </span><span class="built_in">set</span><span class="built_in"> proxy </span><span class="literal">null</span></span><br></pre></td></tr></table></figure>
<figure class="highlight routeros"><table><tr><td class="code"><pre><span class="line">npm<span class="built_in"> config </span><span class="built_in">set</span> https-proxy <span class="literal">null</span></span><br></pre></td></tr></table></figure>
<p>æˆ–è€…</p>
<figure class="highlight arduino"><table><tr><td class="code"><pre><span class="line">npm config <span class="keyword">delete</span> proxy</span><br></pre></td></tr></table></figure>
<figure class="highlight arduino"><table><tr><td class="code"><pre><span class="line">npm config <span class="keyword">delete</span> https-proxy</span><br></pre></td></tr></table></figure>
<h3 id="gitæŸ¥çœ‹ã€è®¾ç½®ã€åˆ é™¤ä»£ç†"><a href="#gitæŸ¥çœ‹ã€è®¾ç½®ã€åˆ é™¤ä»£ç†" class="headerlink" title="gitæŸ¥çœ‹ã€è®¾ç½®ã€åˆ é™¤ä»£ç†"></a>gitæŸ¥çœ‹ã€è®¾ç½®ã€åˆ é™¤ä»£ç†</h3><h4 id="æŸ¥çœ‹gitä»£ç†"><a href="#æŸ¥çœ‹gitä»£ç†" class="headerlink" title="æŸ¥çœ‹gitä»£ç†"></a>æŸ¥çœ‹gitä»£ç†</h4><figure class="highlight routeros"><table><tr><td class="code"><pre><span class="line">git<span class="built_in"> config </span>--global --<span class="built_in">get</span> http.proxy</span><br><span class="line">git<span class="built_in"> config </span>--global --<span class="built_in">get</span> https.proxy</span><br></pre></td></tr></table></figure>

<h4 id="è®¾ç½®gitä»£ç†"><a href="#è®¾ç½®gitä»£ç†" class="headerlink" title="è®¾ç½®gitä»£ç†"></a>è®¾ç½®gitä»£ç†</h4><figure class="highlight stylus"><table><tr><td class="code"><pre><span class="line">git config <span class="attr">--global</span> http<span class="selector-class">.proxy</span> http:<span class="comment">//IP:Port</span></span><br><span class="line">git config <span class="attr">--global</span> https<span class="selector-class">.proxy</span> http:<span class="comment">//IP:Port</span></span><br></pre></td></tr></table></figure>
<h4 id="åˆ é™¤gitä»£ç†"><a href="#åˆ é™¤gitä»£ç†" class="headerlink" title="åˆ é™¤gitä»£ç†"></a>åˆ é™¤gitä»£ç†</h4><figure class="highlight stylus"><table><tr><td class="code"><pre><span class="line">git config <span class="attr">--global</span> <span class="attr">--unset</span> http<span class="selector-class">.proxy</span></span><br><span class="line">git config <span class="attr">--global</span> <span class="attr">--unset</span> https.proxy</span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>å·¥å…·</category>
      </categories>
      <tags>
        <tag>Npm</tag>
        <tag>Git</tag>
      </tags>
  </entry>
  <entry>
    <title>nrmç®¡ç†é•œåƒæº</title>
    <url>/posts/54eb2703.html</url>
    <content><![CDATA[<h3 id="å®‰è£…"><a href="#å®‰è£…" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h3><figure class="highlight cmake"><table><tr><td class="code"><pre><span class="line">npm <span class="keyword">install</span> -g nrm</span><br></pre></td></tr></table></figure>
<h3 id="ä½¿ç”¨"><a href="#ä½¿ç”¨" class="headerlink" title="ä½¿ç”¨"></a>ä½¿ç”¨</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">nrm <span class="built_in">ls</span></span><br></pre></td></tr></table></figure>
<h4 id="æŸ¥çœ‹å¯ç”¨çš„æºï¼š"><a href="#æŸ¥çœ‹å¯ç”¨çš„æºï¼š" class="headerlink" title="æŸ¥çœ‹å¯ç”¨çš„æºï¼š"></a>æŸ¥çœ‹å¯ç”¨çš„æºï¼š</h4><p>å¸¦*çš„æ˜¯å½“å‰ä½¿ç”¨çš„æº</p>
<figure class="highlight awk"><table><tr><td class="code"><pre><span class="line">* npm -------- https:<span class="regexp">//</span>registry.npmjs.org/</span><br><span class="line">  yarn ------- https:<span class="regexp">//</span>registry.yarnpkg.com/</span><br><span class="line">  cnpm ------- http:<span class="regexp">//</span>r.cnpmjs.org/</span><br><span class="line">  taobao ----- https:<span class="regexp">//</span>registry.npm.taobao.org/</span><br><span class="line">  nj --------- https:<span class="regexp">//</span>registry.nodejitsu.com/</span><br><span class="line">  npmMirror -- https:<span class="regexp">//</span>skimdb.npmjs.com<span class="regexp">/registry/</span></span><br><span class="line">  edunpm ----- http:<span class="regexp">//</span>registry.enpmjs.org/</span><br></pre></td></tr></table></figure>
<h4 id="åˆ‡æ¢é€‰æ‹©"><a href="#åˆ‡æ¢é€‰æ‹©" class="headerlink" title="åˆ‡æ¢é€‰æ‹©"></a>åˆ‡æ¢é€‰æ‹©</h4><p>å¦‚æœè¦åˆ‡æ¢åˆ°taobaoæº</p>
<figure class="highlight actionscript"><table><tr><td class="code"><pre><span class="line">nrm <span class="keyword">use</span> taobao</span><br></pre></td></tr></table></figure>
<h4 id="å¢åŠ æº"><a href="#å¢åŠ æº" class="headerlink" title="å¢åŠ æº"></a>å¢åŠ æº</h4><p>ä½ å¯ä»¥å¢åŠ å®šåˆ¶çš„æºï¼Œç‰¹åˆ«é€‚ç”¨äºæ·»åŠ ä¼ä¸šå†…éƒ¨çš„ç§æœ‰æºï¼Œæ‰§è¡Œå‘½ä»¤ nrm add &lt;registry&gt; &lt;url&gt;ï¼Œå…¶ä¸­reigstryä¸ºæºåï¼Œurlä¸ºæºçš„è·¯å¾„ã€‚</p>
<figure class="highlight tcl"><table><tr><td class="code"><pre><span class="line">nrm add <span class="keyword">registry</span> <span class="keyword">http</span>://<span class="keyword">registry</span>.npm.frp.trmap.cn/</span><br></pre></td></tr></table></figure>
<h4 id="åˆ é™¤æº"><a href="#åˆ é™¤æº" class="headerlink" title="åˆ é™¤æº"></a>åˆ é™¤æº</h4><p>&lt;registry&gt;æ˜¯éœ€è¦åˆ é™¤çš„å¯¹åº”çš„æºåç§°</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line">nrm del <span class="tag">&lt;<span class="name">registry</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="æµ‹è¯•é€Ÿåº¦"><a href="#æµ‹è¯•é€Ÿåº¦" class="headerlink" title="æµ‹è¯•é€Ÿåº¦"></a>æµ‹è¯•é€Ÿåº¦</h4><p>nrm test æµ‹è¯•ç›¸åº”æºçš„å“åº”æ—¶é—´</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">nrm <span class="built_in">test</span> npm   </span><br></pre></td></tr></table></figure>
<p>nrm æŸ¥çœ‹æ‰€æœ‰çš„æºçš„å“åº”æ—¶é—´</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">nrm <span class="built_in">test</span></span><br></pre></td></tr></table></figure>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="operator">*</span> npm <span class="comment">---- 1189ms</span></span><br><span class="line">  yarn <span class="comment">--- 2893ms</span></span><br><span class="line">  cnpm <span class="comment">--- 715ms</span></span><br><span class="line">  taobao <span class="operator">-</span> <span class="number">413</span>ms</span><br><span class="line">  nj <span class="comment">----- Fetch Error</span></span><br><span class="line">  npmMirror  <span class="number">1393</span>ms</span><br><span class="line">  edunpm <span class="operator">-</span> <span class="keyword">Fetch</span> Error</span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>å·¥å…·</category>
      </categories>
      <tags>
        <tag>Npm</tag>
        <tag>Nrm</tag>
      </tags>
  </entry>
  <entry>
    <title>Windowsä¸‹å®‰è£…nvmç®¡ç†nodejsç‰ˆæœ¬</title>
    <url>/posts/64663d25.html</url>
    <content><![CDATA[<h3 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h3><p>nvmå…¨ånode.js version managementï¼Œé¡¾åæ€ä¹‰æ˜¯ä¸€ä¸ªnodejsçš„ç‰ˆæœ¬ç®¡ç†å·¥å…·ã€‚é€šè¿‡å®ƒå¯ä»¥å®‰è£…å’Œåˆ‡æ¢ä¸åŒç‰ˆæœ¬çš„nodejsã€‚ä¸‹é¢åˆ—å‡ºä¸‹è½½ã€å®‰è£…åŠä½¿ç”¨æ–¹æ³•ã€‚</p>
<h3 id="ä¸‹è½½"><a href="#ä¸‹è½½" class="headerlink" title="ä¸‹è½½"></a>ä¸‹è½½</h3><p>å¯åœ¨<a href="https://github.com/coreybutler/nvm-windows/releases">github</a>ä¸Šä¸‹è½½æœ€æ–°ç‰ˆæœ¬,æœ¬æ¬¡ä¸‹è½½å®‰è£…çš„æ˜¯windowsç‰ˆæœ¬ã€‚æ‰“å¼€ç½‘å€æˆ‘ä»¬å¯ä»¥çœ‹åˆ°æœ‰ä¸¤ä¸ªç‰ˆæœ¬ï¼š</p>
<ul>
<li>nvm-noinstall.zipï¼šç»¿è‰²å…å®‰è£…ç‰ˆï¼Œä½†ä½¿ç”¨æ—¶éœ€è¿›è¡Œé…ç½®ã€‚</li>
<li>nvm-setup.zipï¼šå®‰è£…ç‰ˆï¼Œæ¨èä½¿ç”¨<h3 id="å®‰è£…"><a href="#å®‰è£…" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h3><h4 id="åŒå‡»å®‰è£…æ–‡ä»¶-nvm-setup-exe"><a href="#åŒå‡»å®‰è£…æ–‡ä»¶-nvm-setup-exe" class="headerlink" title="åŒå‡»å®‰è£…æ–‡ä»¶ nvm-setup.exe"></a>åŒå‡»å®‰è£…æ–‡ä»¶ nvm-setup.exe</h4><img src="/posts/64663d25/1.png" alt="å®‰è£…æ–‡ä»¶"><h4 id="é€‰æ‹©nvmå®‰è£…è·¯å¾„"><a href="#é€‰æ‹©nvmå®‰è£…è·¯å¾„" class="headerlink" title="é€‰æ‹©nvmå®‰è£…è·¯å¾„"></a>é€‰æ‹©nvmå®‰è£…è·¯å¾„</h4><img src="/posts/64663d25/2.png" alt="é€‰æ‹©nvmå®‰è£…è·¯å¾„"><h4 id="é€‰æ‹©nodejsè·¯å¾„"><a href="#é€‰æ‹©nodejsè·¯å¾„" class="headerlink" title="é€‰æ‹©nodejsè·¯å¾„"></a>é€‰æ‹©nodejsè·¯å¾„</h4><img src="/posts/64663d25/3.png" alt="é€‰æ‹©nodejsè·¯å¾„"><h4 id="ç¡®è®¤å®‰è£…å³å¯"><a href="#ç¡®è®¤å®‰è£…å³å¯" class="headerlink" title="ç¡®è®¤å®‰è£…å³å¯"></a>ç¡®è®¤å®‰è£…å³å¯</h4><img src="/posts/64663d25/4.png" alt="ç¡®è®¤å®‰è£…"><h4 id="å®‰è£…å®Œç¡®è®¤"><a href="#å®‰è£…å®Œç¡®è®¤" class="headerlink" title="å®‰è£…å®Œç¡®è®¤"></a>å®‰è£…å®Œç¡®è®¤</h4>å®‰è£…æˆåŠŸåˆ™å¦‚ä¸‹æ˜¾ç¤ºã€‚å¯ä»¥çœ‹åˆ°é‡Œé¢åˆ—å‡ºäº†å„ç§å‘½ä»¤<figure class="highlight livecodeserver"><table><tr><td class="code"><pre><span class="line">  $ nvm</span><br><span class="line"></span><br><span class="line">Running <span class="built_in">version</span> <span class="number">1.1</span><span class="number">.7</span>.</span><br><span class="line"></span><br><span class="line">Usage:</span><br><span class="line"></span><br><span class="line">  nvm arch                     : Show <span class="keyword">if</span> node is running <span class="keyword">in</span> <span class="number">32</span> <span class="keyword">or</span> <span class="number">64</span> bit mode.</span><br><span class="line">  nvm install &lt;<span class="built_in">version</span>&gt; [arch] : The <span class="built_in">version</span> can be <span class="keyword">a</span> node.js <span class="built_in">version</span> <span class="keyword">or</span> <span class="string">&quot;latest&quot;</span> <span class="keyword">for</span> <span class="keyword">the</span> latest stable <span class="built_in">version</span>.</span><br><span class="line">                                 Optionally specify whether <span class="built_in">to</span> install <span class="keyword">the</span> <span class="number">32</span> <span class="keyword">or</span> <span class="number">64</span> bit <span class="built_in">version</span> (defaults <span class="built_in">to</span> <span class="keyword">system</span> arch).</span><br><span class="line">                                 Set [arch] <span class="built_in">to</span> <span class="string">&quot;all&quot;</span> <span class="built_in">to</span> install <span class="number">32</span> AND <span class="number">64</span> bit versions.</span><br><span class="line">                                 Add <span class="comment">--insecure to the end of this command to bypass SSL validation of the remote download server.</span></span><br><span class="line">  nvm list [available]         : List <span class="keyword">the</span> node.js installations. Type <span class="string">&quot;available&quot;</span> <span class="keyword">at</span> <span class="keyword">the</span> <span class="function"><span class="keyword">end</span> <span class="title">to</span> <span class="title">see</span> <span class="title">what</span> <span class="title">can</span> <span class="title">be</span> <span class="title">installed</span>. <span class="title">Aliased</span> <span class="title">as</span> <span class="title">ls</span>.</span></span><br><span class="line">  nvm <span class="keyword">on</span>                       : <span class="title">Enable</span> <span class="title">node</span>.<span class="title">js</span> <span class="title">version</span> <span class="title">management</span>.</span><br><span class="line">  nvm off                      : Disable node.js <span class="built_in">version</span> management.</span><br><span class="line">  nvm proxy [url]              : Set <span class="keyword">a</span> proxy <span class="built_in">to</span> use <span class="keyword">for</span> downloads. Leave [url] blank <span class="built_in">to</span> see <span class="keyword">the</span> current proxy.</span><br><span class="line">                                 Set [url] <span class="built_in">to</span> <span class="string">&quot;none&quot;</span> <span class="built_in">to</span> remove <span class="keyword">the</span> proxy.</span><br><span class="line">  nvm node_mirror [url]        : Set <span class="keyword">the</span> node mirror. Defaults <span class="built_in">to</span> <span class="keyword">https</span>://nodejs.org/dist/. Leave [url] blank <span class="built_in">to</span> use default url.</span><br><span class="line">  nvm npm_mirror [url]         : Set <span class="keyword">the</span> npm mirror. Defaults <span class="built_in">to</span> <span class="keyword">https</span>://github.com/npm/cli/archive/. Leave [url] blank <span class="built_in">to</span> default url.</span><br><span class="line">  nvm uninstall &lt;<span class="built_in">version</span>&gt;      : The <span class="built_in">version</span> must be <span class="keyword">a</span> specific <span class="built_in">version</span>.</span><br><span class="line">  nvm use [<span class="built_in">version</span>] [arch]     : Switch <span class="built_in">to</span> use <span class="keyword">the</span> specified <span class="built_in">version</span>. Optionally specify <span class="number">32</span>/<span class="number">64</span>bit architecture.</span><br><span class="line">                                 nvm use &lt;arch&gt; will continue <span class="keyword">using</span> <span class="keyword">the</span> selected <span class="built_in">version</span>, but <span class="keyword">switch</span> <span class="built_in">to</span> <span class="number">32</span>/<span class="number">64</span> bit mode.</span><br><span class="line">  nvm root [path]              : Set <span class="keyword">the</span> <span class="built_in">directory</span> where nvm should store different versions <span class="keyword">of</span> node.js.</span><br><span class="line">                                 If &lt;path&gt; is <span class="keyword">not</span> <span class="built_in">set</span>, <span class="keyword">the</span> current root will be displayed.</span><br><span class="line">  nvm <span class="built_in">version</span>                  : Displays <span class="keyword">the</span> current running <span class="built_in">version</span> <span class="keyword">of</span> nvm <span class="keyword">for</span> Windows. Aliased <span class="keyword">as</span> v.</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="å®‰è£…ç®¡ç†nodejs"><a href="#å®‰è£…ç®¡ç†nodejs" class="headerlink" title="å®‰è£…ç®¡ç†nodejs"></a>å®‰è£…ç®¡ç†nodejs</h3><h4 id="æŸ¥çœ‹æœ¬åœ°å®‰è£…çš„æ‰€æœ‰ç‰ˆæœ¬"><a href="#æŸ¥çœ‹æœ¬åœ°å®‰è£…çš„æ‰€æœ‰ç‰ˆæœ¬" class="headerlink" title="æŸ¥çœ‹æœ¬åœ°å®‰è£…çš„æ‰€æœ‰ç‰ˆæœ¬"></a>æŸ¥çœ‹æœ¬åœ°å®‰è£…çš„æ‰€æœ‰ç‰ˆæœ¬</h4>nvm list åæ˜¾ç¤ºçš„ * è¡¨ç¤ºçš„æ˜¯å½“å‰æ­£åœ¨ä½¿ç”¨çš„ç‰ˆæœ¬<figure class="highlight powershell"><table><tr><td class="code"><pre><span class="line"><span class="variable">$</span> nvm list</span><br><span class="line"></span><br><span class="line">  * <span class="number">15.3</span>.<span class="number">0</span> (Currently <span class="keyword">using</span> 64-bit executable)</span><br><span class="line">    <span class="number">10.4</span>.<span class="number">0</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h4 id="å®‰è£…ï¼Œç‰ˆæœ¬å·å¯è‡ªå®šä¹‰"><a href="#å®‰è£…ï¼Œç‰ˆæœ¬å·å¯è‡ªå®šä¹‰" class="headerlink" title="å®‰è£…ï¼Œç‰ˆæœ¬å·å¯è‡ªå®šä¹‰"></a>å®‰è£…ï¼Œç‰ˆæœ¬å·å¯è‡ªå®šä¹‰</h4><figure class="highlight apache"><table><tr><td class="code"><pre><span class="line"><span class="attribute">nvm</span> install <span class="number">10</span>.<span class="number">4</span>.<span class="number">0</span></span><br></pre></td></tr></table></figure>
<h4 id="ä½¿ç”¨ç‰¹å®šç‰ˆæœ¬"><a href="#ä½¿ç”¨ç‰¹å®šç‰ˆæœ¬" class="headerlink" title="ä½¿ç”¨ç‰¹å®šç‰ˆæœ¬"></a>ä½¿ç”¨ç‰¹å®šç‰ˆæœ¬</h4><figure class="highlight apache"><table><tr><td class="code"><pre><span class="line"><span class="attribute">nvm</span> use <span class="number">10</span>.<span class="number">4</span>.<span class="number">0</span></span><br></pre></td></tr></table></figure>
<h4 id="å¸è½½"><a href="#å¸è½½" class="headerlink" title="å¸è½½"></a>å¸è½½</h4><figure class="highlight apache"><table><tr><td class="code"><pre><span class="line"><span class="attribute">nvm</span> uninstall <span class="number">11</span>.<span class="number">13</span>.<span class="number">0</span></span><br></pre></td></tr></table></figure></li>
</ul>
]]></content>
      <categories>
        <category>å·¥å…·</category>
      </categories>
      <tags>
        <tag>Nvm</tag>
        <tag>Node</tag>
      </tags>
  </entry>
  <entry>
    <title>ç§»åŠ¨ç«¯é€‚é…</title>
    <url>/posts/783ce8a9.html</url>
    <content><![CDATA[<h2 id="ç§»åŠ¨ç«¯é€‚é…çš„æ–¹æ¡ˆ"><a href="#ç§»åŠ¨ç«¯é€‚é…çš„æ–¹æ¡ˆ" class="headerlink" title="ç§»åŠ¨ç«¯é€‚é…çš„æ–¹æ¡ˆ"></a>ç§»åŠ¨ç«¯é€‚é…çš„æ–¹æ¡ˆ</h2><ul>
<li>é€šè¿‡<code>Meida queriesï¼ˆåª’ä½“æŸ¥è¯¢ï¼‰</code>çš„æ–¹å¼</li>
<li>ä»¥å¤©çŒ«é¦–é¡µä¸ºä»£è¡¨çš„ <code>flex</code>å¼¹æ€§å¸ƒå±€</li>
<li>ä»¥æ·˜å®é¦–é¡µä¸ºä»£è¡¨çš„ <code>rem + viewport</code>ç¼©æ”¾</li>
<li><code>rem</code>æ–¹å¼<h3 id="åª’ä½“æŸ¥è¯¢"><a href="#åª’ä½“æŸ¥è¯¢" class="headerlink" title="åª’ä½“æŸ¥è¯¢"></a>åª’ä½“æŸ¥è¯¢</h3>å®ƒä¸»è¦æ˜¯é€šè¿‡æŸ¥è¯¢è®¾å¤‡çš„å®½åº¦æ¥æ‰§è¡Œä¸åŒçš„ css ä»£ç ï¼Œæœ€ç»ˆè¾¾åˆ°ç•Œé¢çš„é…ç½®ã€‚æ ¸å¿ƒè¯­æ³•æ˜¯ï¼š<figure class="highlight arduino"><table><tr><td class="code"><pre><span class="line">@media åª’ä½“ç±»å‹ <span class="built_in">and</span> (åª’ä½“ç‰¹æ€§)&#123;</span><br><span class="line">    <span class="comment">// css ä»£ç </span></span><br><span class="line">&#125;</span><br><span class="line">åª’ä½“ç±»å‹ï¼š</span><br><span class="line">    screen     ====&gt;  ç”¨äºç”µè„‘æ˜¾ç¤ºå±</span><br><span class="line">    print      ====&gt;  ç”¨äºæ‰“å°æœº </span><br><span class="line">    projection ====&gt;  ç”¨äºæ–¹æ¡ˆå±•ç¤ºï¼Œæ¯”å¦‚å¹»ç¯ç‰‡</span><br><span class="line">    ...</span><br><span class="line">åª’ä½“ç‰¹æ€§ï¼š</span><br><span class="line">    max-width</span><br><span class="line">    max-height</span><br><span class="line">    ...</span><br></pre></td></tr></table></figure>
ä¾‹å¦‚ï¼š<figure class="highlight arduino"><table><tr><td class="code"><pre><span class="line">@<span class="function">media screen <span class="title">and</span> <span class="params">(max-width:<span class="number">320</span>px)</span> </span>&#123;</span><br><span class="line">    <span class="comment">/* å±å¹•å®½åº¦å°äº320pxæ—¶å€™ */</span></span><br><span class="line">&#125;</span><br><span class="line">@<span class="function">media screen <span class="title">and</span> <span class="params">(min-width:<span class="number">321</span>px)</span> <span class="title">and</span> <span class="params">(max-width:<span class="number">375</span>px)</span></span>&#123;</span><br><span class="line">    <span class="comment">/* å±å¹•å®½åº¦å¤§äºç­‰äº321pxæ—¶å€™ä»£ç ç”Ÿæ•ˆ */</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="flex-æ–¹å¼"><a href="#flex-æ–¹å¼" class="headerlink" title="flex æ–¹å¼"></a>flex æ–¹å¼</h3>ä»¥å¤©çŒ«çš„å®ç°æ–¹å¼è¿›è¡Œè¯´æ˜ï¼š<br>å®ƒçš„viewportæ˜¯å›ºå®šçš„ï¼š<code>&lt;meta name=&quot;viewport&quot; content=&quot;width=device-width,initial-scale=1,maximum-scale=1,minimum-scale=1,user-scalable=no&quot;&gt;</code>é«˜åº¦å®šæ­»ï¼Œå®½åº¦è‡ªé€‚åº”ï¼Œå…ƒç´ éƒ½é‡‡ç”¨pxåšå•ä½ã€‚<br>éšç€å±å¹•å®½åº¦å˜åŒ–ï¼Œé¡µé¢ä¹Ÿä¼šè·Ÿç€å˜åŒ–ï¼Œæ•ˆæœå°±å’ŒPCé¡µé¢çš„æµä½“å¸ƒå±€å·®ä¸å¤šï¼Œåœ¨å“ªä¸ªå®½åº¦éœ€è¦è°ƒæ•´çš„æ—¶å€™ä½¿ç”¨å“åº”å¼å¸ƒå±€è°ƒè°ƒå°±è¡Œï¼ˆæ¯”å¦‚ç½‘æ˜“æ–°é—»ï¼‰ï¼Œè¿™æ ·å°±å®ç°äº†<code>é€‚é…</code>ã€‚<h3 id="rem-viewport-ç¼©æ”¾"><a href="#rem-viewport-ç¼©æ”¾" class="headerlink" title="rem + viewport ç¼©æ”¾"></a>rem + viewport ç¼©æ”¾</h3>è¿™ä¹Ÿæ˜¯æ·˜å®ä½¿ç”¨çš„æ–¹æ¡ˆï¼Œæ ¹æ®å±å¹•å®½åº¦è®¾å®š rem å€¼ï¼Œéœ€è¦é€‚é…çš„å…ƒç´ éƒ½ä½¿ç”¨ rem ä¸ºå•ä½ï¼Œä¸éœ€è¦é€‚é…çš„å…ƒç´ è¿˜æ˜¯ä½¿ç”¨ px ä¸ºå•ä½ã€‚ï¼ˆ1em = 16pxï¼‰<blockquote>
<p>remæ˜¯CSS3æ–°å¢çš„ä¸€ä¸ªç›¸å¯¹å•ä½ï¼ˆroot emï¼Œæ ¹emï¼‰ï¼Œè¿™ä¸ªå•ä½å¼•èµ·äº†å¹¿æ³›å…³æ³¨ã€‚è¿™ä¸ªå•ä½ä¸emæœ‰ä»€ä¹ˆåŒºåˆ«å‘¢ï¼Ÿ<br>åŒºåˆ«åœ¨äºä½¿ç”¨remä¸ºå…ƒç´ è®¾å®šå­—ä½“å¤§å°æ—¶ï¼Œä»ç„¶æ˜¯ç›¸å¯¹å¤§å°ï¼Œä½†ç›¸å¯¹çš„åªæ˜¯HTMLæ ¹å…ƒç´ ã€‚è¿™ä¸ªå•ä½å¯è°“é›†ç›¸å¯¹å¤§å°å’Œç»å¯¹å¤§å°çš„ä¼˜ç‚¹äºä¸€èº«ï¼Œé€šè¿‡å®ƒæ—¢å¯ä»¥åšåˆ°åªä¿®æ”¹æ ¹å…ƒç´ å°±æˆæ¯”ä¾‹åœ°è°ƒæ•´æ‰€æœ‰å­—ä½“å¤§å°ï¼Œåˆå¯ä»¥é¿å…å­—ä½“å¤§å°é€å±‚å¤åˆçš„è¿é”ååº”ã€‚ç›®å‰ï¼Œé™¤äº†IE8åŠæ›´æ—©ç‰ˆæœ¬å¤–ï¼Œæ‰€æœ‰æµè§ˆå™¨å‡å·²æ”¯æŒremã€‚å¯¹äºä¸æ”¯æŒå®ƒçš„æµè§ˆå™¨ï¼Œåº”å¯¹æ–¹æ³•ä¹Ÿå¾ˆç®€å•ï¼Œå°±æ˜¯å¤šå†™ä¸€ä¸ªç»å¯¹å•ä½çš„å£°æ˜ã€‚è¿™äº›æµè§ˆå™¨ä¼šå¿½ç•¥ç”¨remè®¾å®šçš„å­—ä½“å¤§å°ã€‚æ¯”å¦‚ï¼šp{font-size:14px;font-size:0.875rem;}<br>(æ¨èä¸€ä¸ªå•ä½è½¬æ¢çš„å·¥å…·ï¼š<a href="http://pxtoem.com/">http://pxtoem.com/</a>)</p>
</blockquote>
<h3 id="rem-æ–¹å¼"><a href="#rem-æ–¹å¼" class="headerlink" title="rem æ–¹å¼"></a>rem æ–¹å¼</h3><h4 id="ä¸ºä»€ä¹ˆhtmlçš„å­—ä½“å¤§å°è®¾ç½®ä¸ºfont-size-625"><a href="#ä¸ºä»€ä¹ˆhtmlçš„å­—ä½“å¤§å°è®¾ç½®ä¸ºfont-size-625" class="headerlink" title="ä¸ºä»€ä¹ˆhtmlçš„å­—ä½“å¤§å°è®¾ç½®ä¸ºfont-size:625%"></a>ä¸ºä»€ä¹ˆhtmlçš„å­—ä½“å¤§å°è®¾ç½®ä¸ºfont-size:625%</h4>æµè§ˆå™¨é»˜è®¤å­—ä½“å¤§å°æ˜¯16pxï¼Œremä¸pxå…³ç³»ä¸ºï¼š1rem = 10pxï¼Œ10/16=0.625=62.5%ï¼Œå½“è®¾è®¡ç¨¿å’Œå±å¹•ä¸€æ ·å¤§çš„æƒ…å†µä¸‹ï¼ˆå¦‚750pxï¼‰ï¼Œåªè¦å°†è®¾è®¡ç¨¿ä¸­é‡åˆ°çš„pxå°ºå¯¸é™¤ä»¥10å°±å¾—åˆ°äº†ç›¸åº”çš„remå°ºå¯¸ï¼Œä¾‹å¦‚ï¼š100px = 10remï¼Œ120px = 12remã€‚ä½†æ˜¯åœ¨é¡¹ç›®ä¸­è®¾ç½®æˆ font-size: 62.5% åœ¨å¤§éƒ¨åˆ†ç°ä»£æµè§ˆå™¨éƒ½æ²¡æœ‰é—®é¢˜ï¼Œåœ¨è°·æ­Œæµè§ˆå™¨å¯èƒ½ä¼šå‡ºç°é—®é¢˜ï¼Œå› ä¸ºchromeä¸æ”¯æŒå°äº12pxçš„å­—ä½“ï¼Œæœ€å°å°±æ˜¯12pxï¼Œè®¡ç®—å°äº10pxçš„æ—¶å€™ï¼Œä¼šé»˜è®¤å–12pxå»è®¡ç®—ï¼Œå¯¼è‡´chromeçš„em/remè®¡ç®—ä¸å‡†ç¡®ã€‚è°·æ­Œfont-size:62.5%åˆšå¥½æ˜¯10åƒç´ ï¼Œè€Œè°·æ­Œæ˜¯ä¸æ”¯æŒå°äº12åƒç´ çš„å­—ä½“çš„ï¼Œæ‰€ä»¥ï¼Œè°·æ­Œæ— å½¢å½“ä¸­å°†æ‰€æœ‰çš„remå…¨éƒ¨å˜å¤§äº†ã€‚chromeåœ¨å­—ä½“å°äº12pxæ—¶éƒ½å½“12px å¤„ç†ï¼Œä¹Ÿå°±æ˜¯è®¾ç½®62.5%ç›¸å½“äºè®¾ç½®æˆäº†75.0%ã€‚ä½†æ˜¯åœ¨é™¤çš„æ—¶å€™åˆæ˜¯é™¤çš„10å¾—åˆ°remå€¼ï¼Œå°±ä¼šæœ‰é—®é¢˜äº†<br>é’ˆå¯¹è¿™ä¸ªç°è±¡ï¼Œå¯ä»¥å°è¯•è®¾ç½®htmlå­—ä½“ä¸º625%ï¼Œå³100pxï¼Œbodyä¿®æ­£è®¾ç½®ä¸º16pxï¼Œè¿™æ · 0.1rem å°±æ˜¯ 10pxï¼Œè€Œbodyçš„å­—ä½“ä»ç„¶æ˜¯é»˜è®¤å¤§å°ï¼Œä¸å½±å“æœªè®¾ç½®å¤§å°çš„å…ƒç´ çš„é»˜è®¤å­—ä½“çš„å¤§å°ã€‚<h4 id="JSåŠ¨æ€ä¿®æ”¹é…åˆremé€‚é…"><a href="#JSåŠ¨æ€ä¿®æ”¹é…åˆremé€‚é…" class="headerlink" title="JSåŠ¨æ€ä¿®æ”¹é…åˆremé€‚é…"></a>JSåŠ¨æ€ä¿®æ”¹é…åˆremé€‚é…</h4><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// è®¡ç®—å±å¹•å®½åº¦</span></span><br><span class="line"><span class="keyword">let</span> W = <span class="variable language_">document</span>.<span class="property">documentElement</span>.<span class="property">clientWidth</span> || <span class="variable language_">document</span>.<span class="property">body</span>.<span class="property">clientWidth</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// è·å–htmlæ ¹æ ‡ç­¾</span></span><br><span class="line"><span class="keyword">let</span> <span class="variable constant_">HTMLDOM</span> = <span class="variable language_">document</span>.<span class="title function_">getElementsByTagName</span>(<span class="string">&#x27;html&#x27;</span>)[<span class="number">0</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment">// è®¾ç½®æ ¹å…ƒç´ å­—ä½“å¤§å°</span></span><br><span class="line"><span class="variable constant_">HTMLDOM</span>.<span class="property">style</span>.<span class="property">fontSize</span> = W / <span class="number">10</span> +<span class="string">&#x27;px&#x27;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
</ul>
]]></content>
      <categories>
        <category>webå‰ç«¯</category>
      </categories>
      <tags>
        <tag>ç§»åŠ¨ç«¯é€‚é…</tag>
      </tags>
  </entry>
  <entry>
    <title>Vue-RouteråŸºæœ¬ä½¿ç”¨åŠhashæ¨¡å¼å’Œhistoryæ¨¡å¼å®ç°åŸç†</title>
    <url>/posts/67ac0156.html</url>
    <content><![CDATA[<p>Vue Router æ˜¯ Vue.js å®˜æ–¹çš„è·¯ç”±ç®¡ç†å™¨ã€‚å®ƒå’Œ Vue.js çš„æ ¸å¿ƒæ·±åº¦é›†æˆï¼Œè®©æ„å»ºå•é¡µé¢åº”ç”¨å˜å¾—æ˜“å¦‚åæŒã€‚åŒ…å«çš„åŠŸèƒ½æœ‰ï¼š</p>
<ul>
<li>åµŒå¥—çš„è·¯ç”±/è§†å›¾è¡¨</li>
<li>æ¨¡å—åŒ–çš„ã€åŸºäºç»„ä»¶çš„è·¯ç”±é…ç½®</li>
<li>è·¯ç”±å‚æ•°ã€æŸ¥è¯¢ã€é€šé…ç¬¦</li>
<li>åŸºäº Vue.js è¿‡æ¸¡ç³»ç»Ÿçš„è§†å›¾è¿‡æ¸¡æ•ˆæœ</li>
<li>ç»†ç²’åº¦çš„å¯¼èˆªæ§åˆ¶</li>
<li>å¸¦æœ‰è‡ªåŠ¨æ¿€æ´»çš„ CSS class çš„é“¾æ¥</li>
<li>HTML5 å†å²æ¨¡å¼æˆ– hash æ¨¡å¼ï¼Œåœ¨ IE9 ä¸­è‡ªåŠ¨é™çº§</li>
<li>è‡ªå®šä¹‰çš„æ»šåŠ¨æ¡è¡Œä¸º<span id="more"></span>

</li>
</ul>
<h3 id="åˆ›å»ºç›®å½•"><a href="#åˆ›å»ºç›®å½•" class="headerlink" title="åˆ›å»ºç›®å½•"></a>åˆ›å»ºç›®å½•</h3><p>æ ¹æ®vue-cliè„šæ‰‹æ¶è‡ªåŠ¨ç”Ÿæˆä¸€ä¸ªç®€å•çš„å¸¦æœ‰routeræ–‡ä»¶å¤¹çš„é¡¹ç›®ç›®å½•</p>
<figure class="highlight oxygene"><table><tr><td class="code"><pre><span class="line">Vue CLI v4.<span class="number">5.9</span></span><br><span class="line">Failed <span class="keyword">to</span> check <span class="keyword">for</span> updates</span><br><span class="line">? Please pick a preset: Manually <span class="keyword">select</span> features</span><br><span class="line">? Check the features needed <span class="keyword">for</span> your project: </span><br><span class="line"> ( ) Choose Vue version</span><br><span class="line"> <span class="comment">(*) Babel</span></span><br><span class="line"><span class="comment"> ( ) TypeScript</span></span><br><span class="line"><span class="comment"> ( ) Progressive Web App (PWA) Support        </span></span><br><span class="line"><span class="comment"> (*)</span> Router</span><br><span class="line"> ( ) Vuex</span><br><span class="line"> ( ) CSS Pre-processors</span><br><span class="line">&gt;( ) Linter / Formatter</span><br><span class="line"> ( ) <span class="keyword">Unit</span> Testing</span><br><span class="line"> ( ) E2E Testing</span><br></pre></td></tr></table></figure>

<h3 id="Vue-Routerä½¿ç”¨"><a href="#Vue-Routerä½¿ç”¨" class="headerlink" title="Vue Routerä½¿ç”¨"></a>Vue Routerä½¿ç”¨</h3><ul>
<li>1.æ³¨å†Œè·¯ç”±æ’ä»¶</li>
<li>2.åˆ›å»ºä¸€ä¸ªrouterå¯¹è±¡ï¼Œåˆ›å»ºè¿‡ç¨‹ä¸­é…ç½®ä¸€äº›è·¯ç”±è§„åˆ™</li>
<li>3.æ³¨å†Œrouterå¯¹è±¡ï¼Œä¹Ÿå°±æ˜¯åœ¨åˆ›å»ºvueå®ä¾‹çš„æ—¶å€™ï¼Œè¦åœ¨é€‰é¡¹é‡Œé¢ï¼Œæ¥é…ç½®æˆ‘ä»¬åˆ›å»ºå¥½çš„routerå¯¹è±¡</li>
<li>4.åˆ›å»ºè·¯ç”±ç»„ä»¶å ä½å’Œè·³è½¬é“¾æ¥<h4 id="æ³¨å†Œè·¯ç”±æ’ä»¶"><a href="#æ³¨å†Œè·¯ç”±æ’ä»¶" class="headerlink" title="æ³¨å†Œè·¯ç”±æ’ä»¶"></a>æ³¨å†Œè·¯ç”±æ’ä»¶</h4>åœ¨ router/index.js æ–‡ä»¶ä¸­<figure class="highlight clean"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> Vue <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span><br><span class="line"><span class="keyword">import</span> VueRouter <span class="keyword">from</span> <span class="string">&#x27;vue-router&#x27;</span></span><br><span class="line"><span class="keyword">import</span> Home <span class="keyword">from</span> <span class="string">&#x27;../views/Home.vue&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 1.æ³¨å†Œè·¯ç”±æ’ä»¶</span></span><br><span class="line"><span class="comment">// Vue.use() æ˜¯ç”¨æ¥æ³¨å†Œæ’ä»¶ï¼Œä¼šè°ƒç”¨ä¼ å…¥å¯¹è±¡çš„installæ–¹æ³•</span></span><br><span class="line">Vue.use(VueRouter)</span><br></pre></td></tr></table></figure>
<h4 id="åˆ›å»ºrouterå¯¹è±¡é…ç½®è·¯ç”±è§„åˆ™"><a href="#åˆ›å»ºrouterå¯¹è±¡é…ç½®è·¯ç”±è§„åˆ™" class="headerlink" title="åˆ›å»ºrouterå¯¹è±¡é…ç½®è·¯ç”±è§„åˆ™"></a>åˆ›å»ºrouterå¯¹è±¡é…ç½®è·¯ç”±è§„åˆ™</h4>åœ¨ router/index.js æ–‡ä»¶ä¸­<figure class="highlight dart"><table><tr><td class="code"><pre><span class="line"><span class="comment">// è·¯ç”±è§„åˆ™</span></span><br><span class="line"><span class="keyword">const</span> routes = [</span><br><span class="line">  &#123;</span><br><span class="line">    path: <span class="string">&#x27;/&#x27;</span>,</span><br><span class="line">    name: <span class="string">&#x27;Home&#x27;</span>,</span><br><span class="line">    component: Home</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    path: <span class="string">&#x27;/about&#x27;</span>,</span><br><span class="line">    name: <span class="string">&#x27;About&#x27;</span>,</span><br><span class="line">    component: () =&gt; <span class="keyword">import</span>(<span class="comment">/* webpackChunkName: &quot;about&quot; */</span> <span class="string">&#x27;../views/About.vue&#x27;</span>)</span><br><span class="line">  &#125;</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"><span class="comment">// 2.åˆ›å»ºrouterè·¯ç”±å¯¹è±¡</span></span><br><span class="line"><span class="keyword">const</span> router = <span class="keyword">new</span> VueRouter(&#123;</span><br><span class="line">  routes</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> router</span><br></pre></td></tr></table></figure>
<h4 id="æ³¨å†Œrouterå¯¹è±¡"><a href="#æ³¨å†Œrouterå¯¹è±¡" class="headerlink" title="æ³¨å†Œrouterå¯¹è±¡"></a>æ³¨å†Œrouterå¯¹è±¡</h4>åœ¨main.jsæ–‡ä»¶ä¸­<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">Vue</span> <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">App</span> <span class="keyword">from</span> <span class="string">&#x27;./App.vue&#x27;</span></span><br><span class="line"><span class="keyword">import</span> router <span class="keyword">from</span> <span class="string">&#x27;./router&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="title class_">Vue</span>.<span class="property">config</span>.<span class="property">productionTip</span> = <span class="literal">false</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">new</span> <span class="title class_">Vue</span>(&#123;</span><br><span class="line">  <span class="comment">// 3. æ³¨å†Œrouter å¯¹è±¡</span></span><br><span class="line">  router,</span><br><span class="line">  <span class="attr">render</span>: <span class="function"><span class="params">h</span> =&gt;</span> <span class="title function_">h</span>(<span class="title class_">App</span>)</span><br><span class="line">&#125;).$mount(<span class="string">&#x27;#app&#x27;</span>)</span><br></pre></td></tr></table></figure>
<h4 id="åˆ›å»ºè·¯ç”±ç»„ä»¶å ä½å’Œè·³è½¬é“¾æ¥"><a href="#åˆ›å»ºè·¯ç”±ç»„ä»¶å ä½å’Œè·³è½¬é“¾æ¥" class="headerlink" title="åˆ›å»ºè·¯ç”±ç»„ä»¶å ä½å’Œè·³è½¬é“¾æ¥"></a>åˆ›å»ºè·¯ç”±ç»„ä»¶å ä½å’Œè·³è½¬é“¾æ¥</h4><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;app&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;nav&quot;</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- åˆ›å»ºè·¯ç”±è¿æ¥ --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">router-link</span> <span class="attr">to</span>=<span class="string">&quot;/&quot;</span>&gt;</span>Home<span class="tag">&lt;/<span class="name">router-link</span>&gt;</span> |</span><br><span class="line">    <span class="tag">&lt;<span class="name">router-link</span> <span class="attr">to</span>=<span class="string">&quot;/about&quot;</span>&gt;</span>About<span class="tag">&lt;/<span class="name">router-link</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- åˆ›å»ºè·¯ç”±å ä½ --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">router-view</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>

</li>
</ul>
<h3 id="routeå’Œ-routeråŒºåˆ«"><a href="#routeå’Œ-routeråŒºåˆ«" class="headerlink" title="$routeå’Œ$routeråŒºåˆ«"></a>$routeå’Œ$routeråŒºåˆ«</h3><p>åœ¨main.jsä¸­</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">Vue</span> <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">App</span> <span class="keyword">from</span> <span class="string">&#x27;./App.vue&#x27;</span></span><br><span class="line"><span class="comment">// import router from &#x27;./router&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="title class_">Vue</span>.<span class="property">config</span>.<span class="property">productionTip</span> = <span class="literal">false</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> vm = <span class="keyword">new</span> <span class="title class_">Vue</span>(&#123;</span><br><span class="line">  <span class="comment">// 3. æ³¨å†Œrouter å¯¹è±¡</span></span><br><span class="line">  <span class="comment">// router,</span></span><br><span class="line">  <span class="attr">render</span>: <span class="function"><span class="params">h</span> =&gt;</span> <span class="title function_">h</span>(<span class="title class_">App</span>)</span><br><span class="line">&#125;).$mount(<span class="string">&#x27;#app&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(vm)</span><br></pre></td></tr></table></figure>
<p>å…ˆå°†<code>router</code>æ³¨é‡Šï¼ŒæŸ¥çœ‹æ‰“å°ç»“æœå‘ç°æ²¡æœ‰<code>$route</code>å’Œ<code>$router</code></p>
<p>æ”¾å¼€æ³¨é‡Šåï¼Œä¼šå‘ç°å¤šäº†<code>$route</code>å’Œ<code>$router</code><br><img src="/posts/67ac0156/no_router.png" alt="route"></p>
<ul>
<li><p>$route: è¡¨ç¤ºè·¯ç”±è§„åˆ™,å­˜å‚¨çš„æ˜¯å½“å‰è·¯ç”±çš„ä¸€äº›è·¯ç”±æ•°æ®ï¼Œå­˜å‚¨äº†ä¸€äº›è·¯å¾„<br><img src="/posts/67ac0156/route.png" alt="route"></p>
</li>
<li><p>$router: è¡¨ç¤ºè·¯ç”±å¯¹è±¡ï¼Œå°±æ˜¯vuerouterçš„ä¸€ä¸ªå®ä¾‹ï¼Œè¿™ä¸ªè·¯ç”±å¯¹è±¡ä¸­ä¼šæä¾›ä¸€äº›è·Ÿè·¯ç”±ç›¸å…³çš„ä¸€äº›æ–¹æ³•<br><img src="/posts/67ac0156/router.png" alt="router"></p>
</li>
</ul>
<p>éœ€è¦æ³¨æ„çš„æ˜¯<code>$router</code>é‡Œé¢æœ‰ä¸€ä¸ª<code>currentRoute</code>ï¼Œè¿™ä¸ªå½“å‰è·¯ç”±è§„åˆ™ï¼Œæœ‰çš„æ—¶å€™ä¸æ–¹ä¾¿è·å–<code>$route</code>,æ¯”å¦‚åœ¨ä¸€ä¸ªæ’ä»¶é‡Œé¢æ²¡æœ‰åŠæ³•è·å–åˆ°<code>$route</code>ï¼Œå¯ä»¥æƒ³åŠæ³•è·å–åˆ°<code>$router</code>ï¼Œç„¶åè·å–<code>cunrrentRoute</code>,è¿™æ ·ä¹Ÿå°±è·å–åˆ°äº†å½“å‰è·¯ç”±çš„è§„åˆ™</p>
<h3 id="åŠ¨æ€è·¯ç”±ä¼ å‚"><a href="#åŠ¨æ€è·¯ç”±ä¼ å‚" class="headerlink" title="åŠ¨æ€è·¯ç”±ä¼ å‚"></a>åŠ¨æ€è·¯ç”±ä¼ å‚</h3><h4 id="åŠ¨æ€ä¼ å‚è¿æ¥è·³è½¬"><a href="#åŠ¨æ€ä¼ å‚è¿æ¥è·³è½¬" class="headerlink" title="åŠ¨æ€ä¼ å‚è¿æ¥è·³è½¬"></a>åŠ¨æ€ä¼ å‚è¿æ¥è·³è½¬</h4><ul>
<li>queryä¼šåœ¨åœ°å€æ å‡ºç° <code>id=&#39;XX&#39;</code>  eg: <code>http://localhost:8080/#/?id=1</code></li>
<li>paramsä¼šåœ¨åœ°å€æ  <code>/xx</code>,eg: <code>http://localhost:8080/#/detail/1</code>ï¼Œpropsæ–¹å¼éœ€è¦ç”¨è¿™ä¸ªæ–¹å¼<figure class="highlight dust"><table><tr><td class="code"><pre><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;app&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;nav&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="comment">&lt;!-- åˆ›å»ºè·¯ç”±è¿æ¥ --&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">router-link</span> <span class="attr">to</span>=<span class="string">&quot;/&quot;</span>&gt;</span>Home<span class="tag">&lt;/<span class="name">router-link</span>&gt;</span> |</span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">router-link</span> <span class="attr">to</span>=<span class="string">&quot;/about&quot;</span>&gt;</span>About<span class="tag">&lt;/<span class="name">router-link</span>&gt;</span> |</span></span><br><span class="line"><span class="language-xml">      <span class="comment">&lt;!-- &lt;router-link to=&quot;/detail&quot;&gt;Detail&lt;/router-link&gt;  --&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="comment">&lt;!-- &lt;router-link :to=&quot;</span></span><span class="template-variable">&#123;name:&#x27;Detail&#x27;,query:&#123;id:1&#125;</span><span class="language-xml"><span class="comment">&#125;&quot;&gt;Detail&lt;/router-link&gt;  --&gt;</span></span></span><br><span class="line"><span class="language-xml">      <span class="tag">&lt;<span class="name">router-link</span> <span class="attr">:to</span>=<span class="string">&quot;</span></span></span><span class="template-variable">&#123;name:&#x27;Detail&#x27;,params:&#123;id:1&#125;</span><span class="language-xml"><span class="tag"><span class="string">&#125;&quot;</span>&gt;</span>Detail<span class="tag">&lt;/<span class="name">router-link</span>&gt;</span> </span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="comment">&lt;!-- åˆ›å»ºå ä½ --&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">router-view</span>/&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br></pre></td></tr></table></figure>
<h4 id="è·¯ç”±é…ç½®"><a href="#è·¯ç”±é…ç½®" class="headerlink" title="è·¯ç”±é…ç½®"></a>è·¯ç”±é…ç½®</h4>åœ¨router/index.jsæ–‡ä»¶ä¸­<figure class="highlight pgsql"><table><tr><td class="code"><pre><span class="line">// è·¯ç”±è§„åˆ™</span><br><span class="line">const routes = [</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">path</span>: <span class="string">&#x27;/&#x27;</span>,</span><br><span class="line">    <span class="type">name</span>: <span class="string">&#x27;Home&#x27;</span>,</span><br><span class="line">    component: Home</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">path</span>: <span class="string">&#x27;/about&#x27;</span>,</span><br><span class="line">    <span class="type">name</span>: <span class="string">&#x27;About&#x27;</span>,</span><br><span class="line">    component: () =&gt; <span class="keyword">import</span>(<span class="comment">/* webpackChunkName: &quot;about&quot; */</span> <span class="string">&#x27;../views/About.vue&#x27;</span>)</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="type">path</span>: <span class="string">&#x27;/detail/:id&#x27;</span>,</span><br><span class="line">    <span class="type">name</span>: <span class="string">&#x27;Detail&#x27;</span>,</span><br><span class="line">    // å¼€å¯propsä¼šæŠŠurlä¸­çš„å‚æ•°ä¼ é€’ç»™ç»„ä»¶</span><br><span class="line">    // å½“ä¸º<span class="keyword">true</span>æ—¶ï¼Œä¼šå°†urlä¸­çš„å‚æ•°ä¼ é€’ç»™ç›¸åº”çš„ç»„ä»¶ï¼Œåœ¨ç»„ä»¶ä¸­é€šè¿‡propsæ¥æ¥æ”¶å°±å¯ä»¥äº†</span><br><span class="line">    props: <span class="keyword">true</span>,</span><br><span class="line">    component: () =&gt; <span class="keyword">import</span>(<span class="comment">/* webpackChunkName: &quot;about&quot; */</span> <span class="string">&#x27;../views/Detail.vue&#x27;</span>)</span><br><span class="line">  &#125;</span><br><span class="line">]</span><br></pre></td></tr></table></figure>
<h4 id="æ¥æ”¶æ–¹å¼"><a href="#æ¥æ”¶æ–¹å¼" class="headerlink" title="æ¥æ”¶æ–¹å¼"></a>æ¥æ”¶æ–¹å¼</h4>ä¸¤ç§æ–¹å¼æ¥æ”¶ï¼ˆæ–¹å¼1éœ€è¦å¼ºä¾èµ–ï¼Œæ›´æ¨èæ–¹å¼2ï¼‰ï¼š<figure class="highlight handlebars"><table><tr><td class="code"><pre><span class="line"><span class="language-xml"><span class="comment">&lt;!-- Detail.vueå†…å®¹ --&gt;</span></span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;detail&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">h1</span>&gt;</span>This is an Detail page<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="comment">&lt;!-- æ–¹å¼1ï¼š é€šè¿‡è·¯ç”±è§„åˆ™è·å– --&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">div</span>&gt;</span>è·¯ç”±è§„åˆ™è·å–queryæ–¹å¼ï¼š</span><span class="template-variable">&#123;&#123;<span class="name">$route.query.id</span>&#125;&#125;</span><span class="language-xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">div</span>&gt;</span>è·¯ç”±è§„åˆ™è·å–paramsæ–¹å¼ï¼š</span><span class="template-variable">&#123;&#123;<span class="name">$route.params.id</span>&#125;&#125;</span><span class="language-xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"></span></span><br><span class="line"><span class="language-xml">    <span class="comment">&lt;!-- æ–¹å¼2ï¼š é€šè¿‡propè·å– --&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">div</span>&gt;</span>propsæ–¹å¼è·å–ï¼š</span><span class="template-variable">&#123;&#123;<span class="name">id</span>&#125;&#125;</span><span class="language-xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="attr">name</span>:<span class="string">&#x27;Detail&#x27;</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    <span class="attr">props</span>:[<span class="string">&#x27;id&#x27;</span>]</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">&#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br></pre></td></tr></table></figure>
<h3 id="åµŒå¥—è·¯ç”±"><a href="#åµŒå¥—è·¯ç”±" class="headerlink" title="åµŒå¥—è·¯ç”±"></a>åµŒå¥—è·¯ç”±</h3>åœ¨router/index.jsæ–‡ä»¶ä¸­<figure class="highlight dart"><table><tr><td class="code"><pre><span class="line"><span class="comment">// è·¯ç”±è§„åˆ™</span></span><br><span class="line"><span class="keyword">const</span> routes = [</span><br><span class="line">  &#123;</span><br><span class="line">    path: <span class="string">&#x27;/&#x27;</span>,</span><br><span class="line">    name: <span class="string">&#x27;Home&#x27;</span>,</span><br><span class="line">    component: Home</span><br><span class="line">  &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">    path: <span class="string">&#x27;/about&#x27;</span>,</span><br><span class="line">    name: <span class="string">&#x27;About&#x27;</span>,</span><br><span class="line">    component: () =&gt; <span class="keyword">import</span>(<span class="comment">/* webpackChunkName: &quot;about&quot; */</span> <span class="string">&#x27;../views/About.vue&#x27;</span>),</span><br><span class="line">    children: [</span><br><span class="line">      &#123;</span><br><span class="line">        path: <span class="string">&#x27;detail/:id&#x27;</span>,</span><br><span class="line">        <span class="comment">// å¼€å¯propsä¼šæŠŠurlä¸­çš„å‚æ•°ä¼ é€’ç»™ç»„ä»¶</span></span><br><span class="line">        <span class="comment">// å½“ä¸ºtrueæ—¶ï¼Œä¼šå°†urlä¸­çš„å‚æ•°ä¼ é€’ç»™ç›¸åº”çš„ç»„ä»¶ï¼Œåœ¨ç»„ä»¶ä¸­é€šè¿‡propsæ¥æ¥æ”¶å°±å¯ä»¥äº†</span></span><br><span class="line">        props: <span class="keyword">true</span>,</span><br><span class="line">        component: () =&gt; <span class="keyword">import</span>(<span class="comment">/* webpackChunkName: &quot;about&quot; */</span> <span class="string">&#x27;../views/Detail.vue&#x27;</span>)</span><br><span class="line">      &#125;</span><br><span class="line">    ]</span><br><span class="line">  &#125;</span><br><span class="line">]</span><br></pre></td></tr></table></figure>
<h3 id="ç¼–ç¨‹å¼å¯¼èˆª"><a href="#ç¼–ç¨‹å¼å¯¼èˆª" class="headerlink" title="ç¼–ç¨‹å¼å¯¼èˆª"></a>ç¼–ç¨‹å¼å¯¼èˆª</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line">this.<span class="variable">$router</span>.<span class="title function_ invoke__">push</span>(<span class="string">&#x27;/&#x27;</span>)</span><br><span class="line"></span><br><span class="line">this.<span class="variable">$router</span>.<span class="title function_ invoke__">push</span>(&#123;<span class="attr">name</span>:<span class="string">&#x27;Home&#x27;</span>&#125;)</span><br><span class="line"></span><br><span class="line">this.<span class="variable">$router</span>.<span class="title function_ invoke__">push</span>(&#123;<span class="attr">name</span>:<span class="string">&#x27;Home&#x27;</span>,<span class="attr">params</span>:&#123;<span class="attr">id</span>:<span class="number">1</span>&#125;&#125;)</span><br><span class="line"></span><br><span class="line">this.<span class="variable">$router</span>.<span class="title function_ invoke__">push</span>(&#123;<span class="attr">path</span>:<span class="string">&#x27;/home&#x27;</span>,<span class="attr">query</span>:&#123;<span class="attr">id</span>:<span class="number">1</span>&#125;&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä¸ä¼šè®°å½•æœ¬æ¬¡å†å²</span></span><br><span class="line">this.<span class="variable">$router</span>.<span class="title function_ invoke__">replace</span>(<span class="string">&#x27;/home&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// è·³è½¬åˆ°å†å²çš„æŸä¸€æ¬¡ï¼Œå¦‚æœæ˜¯è´Ÿæ•°å°±æ˜¯åé€€</span></span><br><span class="line">this.<span class="variable">$router</span>.<span class="title function_ invoke__">go</span>(-<span class="number">2</span>)</span><br></pre></td></tr></table></figure>
<h3 id="Hashæ¨¡å¼-å’Œ-Historyæ¨¡å¼åŒºåˆ«"><a href="#Hashæ¨¡å¼-å’Œ-Historyæ¨¡å¼åŒºåˆ«" class="headerlink" title="Hashæ¨¡å¼ å’Œ Historyæ¨¡å¼åŒºåˆ«"></a>Hashæ¨¡å¼ å’Œ Historyæ¨¡å¼åŒºåˆ«</h3>æ— è®ºé‚£ç§æ¨¡å¼ï¼Œéƒ½æ˜¯å®¢æˆ·ç«¯è·¯ç”±çš„å®ç°æ–¹å¼ï¼Œä¹Ÿå°±æ˜¯å½“è·¯å¾„å‘ç”Ÿå˜åŒ–ä¹‹åä¸ä¼šå‘æœåŠ¡å™¨å‘é€è¯·æ±‚ï¼Œä½¿ç”¨JSç›‘è§†è·¯å¾„çš„å˜åŒ–ï¼Œç„¶åæ ¹æ®ä¸åŒçš„åœ°å€æ¸²æŸ“ä¸åŒçš„å†…å®¹ï¼Œå¦‚æœéœ€è¦æœåŠ¡å™¨ç«¯å†…å®¹çš„è¯ä¼šå‘é€ajaxè¯·æ±‚å»è·å–ã€‚<h4 id="è¡¨ç°å½¢å¼çš„åŒºåˆ«"><a href="#è¡¨ç°å½¢å¼çš„åŒºåˆ«" class="headerlink" title="è¡¨ç°å½¢å¼çš„åŒºåˆ«"></a>è¡¨ç°å½¢å¼çš„åŒºåˆ«</h4></li>
<li>hashæ¨¡å¼:<figure class="highlight awk"><table><tr><td class="code"><pre><span class="line">https:<span class="regexp">//mu</span>sic.<span class="number">163</span>.com<span class="regexp">/#/</span>playlist?id=<span class="number">121212</span></span><br></pre></td></tr></table></figure></li>
<li>historyæ¨¡å¼ï¼š<figure class="highlight awk"><table><tr><td class="code"><pre><span class="line">https:<span class="regexp">//mu</span>sic.<span class="number">163</span>.com<span class="regexp">/playlist/</span><span class="number">31032232</span></span><br></pre></td></tr></table></figure>
<h4 id="åŸç†åŒºåˆ«"><a href="#åŸç†åŒºåˆ«" class="headerlink" title="åŸç†åŒºåˆ«"></a>åŸç†åŒºåˆ«</h4><h5 id="Hashæ¨¡å¼"><a href="#Hashæ¨¡å¼" class="headerlink" title="Hashæ¨¡å¼"></a>Hashæ¨¡å¼</h5>hashæ¨¡å¼æ˜¯åŸºäºé”šç‚¹ï¼Œä»¥åŠonhashchangeäº‹ä»¶ï¼Œé€šè¿‡é”šç‚¹çš„å€¼ä½œä¸ºè·¯ç”±åœ°å€ï¼Œåœ°å€å‘ç”Ÿå˜åŒ–å‡ºå‘onhashchangeäº‹ä»¶ï¼Œåœ¨æ ¹æ®è·¯å¾„å†³å®šé¡µé¢ä¸Šå‘ˆç°çš„å†…å®¹<h5 id="Historyæ¨¡å¼"><a href="#Historyæ¨¡å¼" class="headerlink" title="Historyæ¨¡å¼"></a>Historyæ¨¡å¼</h5>historyæ˜¯åŸºäºHTML5ä¸­çš„History API</li>
<li>history.pushState()</li>
<li>history.replaceState()<h6 id="history-pushStateå’Œ-history-pushåŒºåˆ«"><a href="#history-pushStateå’Œ-history-pushåŒºåˆ«" class="headerlink" title="history.pushStateå’Œ history.pushåŒºåˆ«"></a>history.pushStateå’Œ history.pushåŒºåˆ«</h6></li>
<li>history.pushState() ä¸ä¼šå‘æœåŠ¡å™¨å‘é€è¯·æ±‚ï¼Œåªä¼šæ”¹å˜æµè§ˆå™¨åœ°å€æ ä¸­çš„åœ°å€ï¼Œå¹¶ä¸”æŠŠåœ°å€è®°å½•åˆ°å†å²è®°å½•ä¸­ï¼Œæ‰€ä»¥å¯ä»¥å®ç°å®¢æˆ·ç«¯è·¯ç”± å¦å¤–ï¼ŒIE10 ä»¥åæ‰æ”¯æŒ</li>
<li>history.push() è·¯å¾„å‘ç”Ÿå˜åŒ–ï¼Œéœ€è¦å‘æœåŠ¡å™¨å‘é€è¯·æ±‚<h4 id="Historyæ¨¡å¼ä½¿ç”¨"><a href="#Historyæ¨¡å¼ä½¿ç”¨" class="headerlink" title="Historyæ¨¡å¼ä½¿ç”¨"></a>Historyæ¨¡å¼ä½¿ç”¨</h4></li>
<li>historyéœ€è¦æœåŠ¡å™¨çš„æ”¯æŒ</li>
<li>å•é¡µé¢åº”ç”¨ä¸­ï¼Œåªæœ‰ä¸€ä¸ªindex.htmlè¿™æ ·çš„é¡µé¢ï¼ŒæœåŠ¡ç«¯ä¸å­˜åœ¨<a href="http://www.test.com/login">http://www.test.com/login</a> è¿™æ ·çš„åœ°å€ï¼ŒæœåŠ¡ç«¯ä¸å­˜åœ¨/loginè¿™æ ·çš„é¡µé¢</li>
<li>åœ¨æœåŠ¡ç«¯åº”è¯¥é™¤äº†é™æ€èµ„æºå¤–éƒ½è¿”å›å•é¡µåº”ç”¨çš„index.html<figure class="highlight actionscript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 2.åˆ›å»ºrouterå¯¹è±¡</span></span><br><span class="line"><span class="keyword">const</span> router = <span class="keyword">new</span> VueRouter(&#123;</span><br><span class="line">  mode: <span class="string">&#x27;history&#x27;</span>,    <span class="comment">//é»˜è®¤æ˜¯hash</span></span><br><span class="line">  routes</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
å› ä¸ºvue-cliè‡ªå¸¦çš„æœåŠ¡å™¨å·²ç»é…ç½®å¥½äº†ä¸Šé¢è¯´çš„å†…å®¹ï¼Œä¸‹é¢å°†ä»£ç æ‰“åŒ…éƒ¨ç½²çš„åˆ°nodeæœåŠ¡å™¨ä¸­è¿›è¡Œä¸€ä¸ªæµ‹è¯•</li>
<li>NodeæœåŠ¡å™¨é…ç½® historyæ¨¡å¼<figure class="highlight zephir"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> path = <span class="keyword">require</span>(<span class="string">&#x27;path&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// å¯¼å…¥historyæ¨¡å¼çš„æ¨¡å—</span></span><br><span class="line"><span class="keyword">const</span> history = <span class="keyword">require</span>(<span class="string">&#x27;connect-history-api-fallback&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">// å¯¼å…¥express</span></span><br><span class="line"><span class="keyword">const</span> express = <span class="keyword">require</span>(<span class="string">&#x27;express&#x27;</span>)</span><br><span class="line"><span class="keyword">const</span> app = express()</span><br><span class="line"></span><br><span class="line"><span class="comment">// æ³¨å†Œå¤„ç†historyæ¨¡å¼çš„ä¸­é—´ä»¶</span></span><br><span class="line"><span class="comment">// app.use(history())</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// å¤„ç†é™æ€èµ„æºçš„ä¸­é—´ä»¶ ç½‘ç«™æ ¹ç›®å½• ../web</span></span><br><span class="line">app.<span class="keyword">use</span>(express.<span class="keyword">static</span>(path.join(__dirname,<span class="string">&#x27;../web&#x27;</span>))) </span><br><span class="line"></span><br><span class="line"><span class="comment">// å¼€å¯æœåŠ¡</span></span><br><span class="line">app.listen(<span class="number">3000</span>, ()=&gt;&#123;</span><br><span class="line">    console.log(<span class="string">&#x27;æœåŠ¡å™¨å¼€å¯ï¼Œç«¯å£ï¼š3000&#x27;</span>)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>

</li>
</ul>
<p><img src="/posts/67ac0156/router_history.png" alt="å…³é—­historyåˆ·æ–°é¡µé¢"><br>è¿™æ˜¯å…ˆå…³é—­å¤„ç†historyï¼ˆæ³¨é‡Šapp.use(history())ï¼‰ï¼Œå½“å‰æ±‚åœ°å€åï¼Œåˆ·æ–°é¡µé¢å°±ä¼šå‡ºé”™äº† </p>
<p>å¦‚ä¸‹æ”¾å¼€æ³¨é‡Šï¼Œæ‰“å¼€historyæ”¯æŒï¼Œå†å»åˆ·æ–°é¡µé¢ï¼Œå°±å¯ä»¥äº†</p>
<figure class="highlight stata"><table><tr><td class="code"><pre><span class="line"><span class="comment">// æ³¨å†Œå¤„ç†historyæ¨¡å¼çš„ä¸­é—´ä»¶</span></span><br><span class="line"><span class="keyword">app</span>.<span class="keyword">use</span>(history())</span><br></pre></td></tr></table></figure>
<blockquote>
<p>åŠ è½½è¿‡ç¨‹æ˜¯ï¼š<br>æœåŠ¡å™¨ä¼šåˆ¤æ–­å½“å‰è¯·æ±‚çš„é¡µé¢ï¼ŒæœåŠ¡å™¨ä¸Šæ²¡æœ‰ä¼šæŠŠæˆ‘ä»¬å•é¡µåº”ç”¨é»˜è®¤çš„index.htmlè¿”å›ç»™æµè§ˆå™¨ï¼Œæµè§ˆå™¨æ¥æ”¶åˆ°è¿™ä¸ªindex.html,ä¼šå†å»åˆ¤æ–­è·¯ç”±åœ°å€ï¼Œç„¶åæ ¹æ®è·¯ç”±å»åŠ è½½å¯¹åº”é…ç½®çš„ç»„ä»¶ï¼Œè¿™å°±æ˜¯åŠ è½½çš„è¿‡ç¨‹ã€‚</p>
</blockquote>
<ul>
<li>Nginxé…ç½® historyæ¨¡å¼ macä¸‹è½½nginxæ•™ç¨‹åœ°å€å‚è€ƒï¼š<a href="https://www.cnblogs.com/meng1314-shuai/p/8335140.html">https://www.cnblogs.com/meng1314-shuai/p/8335140.html</a><br><img src="/posts/67ac0156/nginx1.png" alt="Nginxé…ç½®"></li>
</ul>
<p>å°†æ‰“åŒ…å¥½çš„å‰ç«¯é¡¹ç›®ï¼Œå¤åˆ¶åˆ°htmlä¸­<br><img src="/posts/67ac0156/nginx2.png" alt="Nginxé…ç½®2"></p>
<p>å¯åŠ¨nginxç‚¹å‡»è®¿é—®å¯ä»¥ï¼Œä½†æ˜¯ä¸€æ—¦åˆ·æ–°ï¼Œå°±ä¼šå‡ºç°å¦‚ä¸‹é—®é¢˜<br><img src="/posts/67ac0156/nginx3.png" alt="Nginxé…ç½®3"></p>
<p>è¿™ä¸ªæ—¶å€™å°±éœ€è¦å»nginx.configé‡Œé¢é…ç½®ä¸€ä¸‹<br><img src="/posts/67ac0156/nginx4.png" alt="Nginxé…ç½®4"></p>
<figure class="highlight awk"><table><tr><td class="code"><pre><span class="line">try_files <span class="variable">$uri</span> <span class="variable">$uri</span><span class="regexp">/ /i</span>ndex.html;   <span class="comment">#æ–°åŠ ä¸€ä¸ª </span></span><br></pre></td></tr></table></figure>
<p>try_files è¯•ç€å»è¯·æ±‚å½“å‰æµè§ˆå™¨è¯·æ±‚çš„è·¯å¾„æ‰€å¯¹åº”çš„æ–‡ä»¶ï¼Œæ²¡æ‰¾åˆ°å°±å»æ‰¾è¿™ä¸ªç›®å½•ä¸‹çš„é»˜è®¤é¦–é¡µï¼Œå¦‚æœæ²¡æœ‰æ‰¾åˆ°å°±å»å•æ–‡ä»¶åº”ç”¨ä¸‹çš„é¦–é¡µï¼ˆ/index.htmlï¼‰ é‡å¯nginxï¼Œç°åœ¨è®¿é—®çš„æ—¶å€™å†åˆ·æ–°é¡µé¢å°±ä¸ä¼šå‡ºç°ä¸Šé¢çš„404äº†</p>
<h4 id="å®ç°åŸç†"><a href="#å®ç°åŸç†" class="headerlink" title="å®ç°åŸç†"></a>å®ç°åŸç†</h4><h5 id="hashæ¨¡å¼"><a href="#hashæ¨¡å¼" class="headerlink" title="hashæ¨¡å¼"></a>hashæ¨¡å¼</h5><ul>
<li>URLä¸­#åé¢çš„å†…å®¹ä½œä¸ºè·¯å¾„åœ°å€</li>
<li>ç›‘å¬hashchangeäº‹ä»¶</li>
<li>æ ¹æ®å½“å‰è·¯ç”±åœ°å€æ‰¾åˆ°å¯¹åº”çš„ç»„ä»¶é‡æ–°æ¸²æŸ“</li>
</ul>
<h5 id="historyæ¨¡å¼"><a href="#historyæ¨¡å¼" class="headerlink" title="historyæ¨¡å¼"></a>historyæ¨¡å¼</h5><ul>
<li>é€šè¿‡history.pushState()æ–¹æ³•æ”¹å˜åœ°å€æ </li>
<li>ç›‘å¬popstateäº‹ä»¶</li>
<li>æ ¹æ®å½“å‰è·¯ç”±åœ°å€æ‰¾åˆ°å¯¹åº”ç»„ä»¶é‡æ–°æ¸²æŸ“</li>
</ul>
<h3 id="å®ç°ä¸€ä¸ªè‡ªå·±çš„vue-router"><a href="#å®ç°ä¸€ä¸ªè‡ªå·±çš„vue-router" class="headerlink" title="å®ç°ä¸€ä¸ªè‡ªå·±çš„vue-router"></a>å®ç°ä¸€ä¸ªè‡ªå·±çš„vue-router</h3><p>åŸæ–‡ä»¶<code>router/index.js</code>ä¸­ç”Ÿæˆçš„é»˜è®¤vue-routerå¦‚ä¸‹ï¼š</p>
<figure class="highlight arcade"><table><tr><td class="code"><pre><span class="line"><span class="comment">// æ³¨å†Œæ’ä»¶</span></span><br><span class="line">Vue.use(VueRouter)</span><br><span class="line"></span><br><span class="line"><span class="comment">// åˆ›å»ºè·¯ç”±å¯¹è±¡</span></span><br><span class="line">const router = <span class="keyword">new</span> VueRouter(&#123;</span><br><span class="line">    <span class="attr">routes</span>:[</span><br><span class="line">    &#123; <span class="attr">name</span>: <span class="string">&#x27;home&#x27;</span>, <span class="attr">path</span>: <span class="string">&#x27;/&#x27;</span>, <span class="attr">component</span>: homeComponent &#125;</span><br><span class="line">    ]</span><br><span class="line">&#125;)</span><br><span class="line"><span class="comment">// main.js</span></span><br><span class="line"><span class="comment">// åˆ›å»ºVueå®ä¾‹ æ³¨å†Œrouterå¯¹è±¡</span></span><br><span class="line"><span class="keyword">new</span> Vue(&#123;</span><br><span class="line">    router,</span><br><span class="line">    <span class="attr">reder</span>: <span class="function"><span class="params">h</span> =&gt;</span> h(App)</span><br><span class="line">&#125;).<span class="symbol">$mou</span>nt(<span class="string">&#x27;#app&#x27;</span>)</span><br></pre></td></tr></table></figure>
<h4 id="åˆ›å»ºrouter-link"><a href="#åˆ›å»ºrouter-link" class="headerlink" title="åˆ›å»ºrouter-link"></a>åˆ›å»ºrouter-link</h4><figure class="highlight stylus"><table><tr><td class="code"><pre><span class="line">let _Vue = null</span><br><span class="line">export default class VueRouter &#123;</span><br><span class="line">    <span class="comment">// å¯¼å‡ºä¸€ä¸ªé™æ€æ–¹æ³• install</span></span><br><span class="line">    <span class="comment">// Vue.use() ä¸­è°ƒç”¨installæ–¹æ³•æ—¶å€™ï¼Œä¼šä¼ é€’ä¸¤ä¸ªå‚æ•°ï¼Œä¸€ä¸ªæ˜¯vueæ„é€ å‡½æ•° å¦ä¸€ä¸ªæ˜¯ å¯é€‰çš„é€‰é¡¹å¯¹è±¡ </span></span><br><span class="line">    static install (Vue) &#123;  <span class="comment">//è¿™é‡Œä¼ é€’æ„é€ å‡½æ•°</span></span><br><span class="line">        <span class="comment">// 1. åˆ¤æ–­å½“å‰æ’ä»¶æ˜¯å¦å·²ç»è¢«å®‰è£…</span></span><br><span class="line">        <span class="built_in">if</span>(VueRouter<span class="selector-class">.install</span>.installed)&#123; </span><br><span class="line">            return</span><br><span class="line">        &#125;</span><br><span class="line">        VueRouter<span class="selector-class">.install</span><span class="selector-class">.installed</span> = true</span><br><span class="line">        <span class="comment">// 2. æŠŠvueæ„é€ å‡½æ•°è®°å½•åˆ°å…¨å±€å˜é‡</span></span><br><span class="line">        _Vue = Vue</span><br><span class="line">        <span class="comment">// 3. æŠŠåˆ›å»ºvueå®ä¾‹æ—¶å€™ä¼ å…¥çš„router å¯¹è±¡æ³¨å…¥åˆ°vueå®ä¾‹ä¸Š</span></span><br><span class="line">        <span class="comment">// æ··å…¥</span></span><br><span class="line">        _Vue<span class="selector-class">.mixin</span>(&#123;</span><br><span class="line">            <span class="built_in">beforeCreate</span>()&#123;</span><br><span class="line">                <span class="comment">// åªæœ‰vue $optionsé‡Œé¢æ‰ä¼šæœ‰router ç»„ä»¶æ²¡æœ‰</span></span><br><span class="line">                <span class="built_in">if</span>(this.<span class="variable">$options</span>.router)&#123;</span><br><span class="line">                    _Vue<span class="selector-class">.prototype</span>.<span class="variable">$router</span> = this.<span class="variable">$options</span><span class="selector-class">.router</span></span><br><span class="line">                    <span class="comment">// å…ˆæ‰¾åˆ°routeå¯¹è±¡ï¼Œç„¶åå†è°ƒç”¨initæ–¹æ³•</span></span><br><span class="line">                    this.<span class="variable">$options</span><span class="selector-class">.router</span><span class="selector-class">.init</span>()</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// åˆ›å»ºä¸€ä¸ªæ„é€ å‡½æ•°</span></span><br><span class="line">    <span class="built_in">constructor</span>(options)&#123;</span><br><span class="line">        this<span class="selector-class">.options</span> = options    <span class="comment">//ä½œç”¨å°±æ˜¯è®°å½•æ„é€ å‡½æ•°ä¼ å…¥çš„optionsè·¯ç”±è§„åˆ™</span></span><br><span class="line">        this<span class="selector-class">.routeMap</span> = &#123;&#125;  <span class="comment">// routeMapé‡Œé¢æ˜¯ä¸€ä¸ªé”®å€¼å¯¹å½¢å¼ï¼Œå¥å­˜çš„å°±æ˜¯è·¯ç”±åœ°å€ï¼Œå€¼å°±æ˜¯è·¯ç”±ç»„ä»¶ å°†æ¥åœ¨router-viewè¿™ä¸ªç»„ä»¶é‡Œé¢ä¼šæ ¹æ®å½“å‰çš„è·¯ç”±åœ°å€åˆ°routeMapé‡Œé¢æ‰¾åˆ°å¯¹åº”çš„ç»„ä»¶ç„¶åæ¸²æŸ“åˆ°æµè§ˆå™¨ä¸­</span></span><br><span class="line">        this<span class="selector-class">.data</span> = _Vue<span class="selector-class">.observable</span>(&#123;  <span class="comment">// å“åº”å¼å¯¹è±¡</span></span><br><span class="line">            current: <span class="string">&#x27;/&#x27;</span>  <span class="comment">//  currentç”¨æ¥è®°å½•å½“å‰è·¯ç”±åœ°å€ï¼Œé»˜è®¤æƒ…å†µä¸‹æ˜¯ / æ–œæ </span></span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// åˆ›å»ºä¸€ä¸ªåˆå§‹åŒ–æ–¹æ³• æ–¹ä¾¿è°ƒç”¨</span></span><br><span class="line">    init () &#123;</span><br><span class="line">        this<span class="selector-class">.createRouteMap</span>()</span><br><span class="line">        this<span class="selector-class">.initComponents</span>(_Vue)  <span class="comment">// ä¼ å…¥æ„é€ å‡½æ•°</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è¿™ä¸ªæ–¹æ³•çš„ä½œç”¨æ˜¯å»éå†æ‰€æœ‰çš„è·¯ç”±è§„åˆ™ï¼ŒæŠŠè¿™äº›è·¯ç”±è§„åˆ™è§£ææˆé”®å€¼å¯¹çš„å½¢å¼å­˜å‚¨åˆ°routeMapä¸­</span></span><br><span class="line">    <span class="built_in">createRouteMap</span>()&#123;</span><br><span class="line">        <span class="comment">// this.options.routes // æ‰€æœ‰çš„è·¯ç”±è§„åˆ™</span></span><br><span class="line">        this<span class="selector-class">.options</span><span class="selector-class">.routes</span><span class="selector-class">.forEach</span>(route =&gt; &#123;</span><br><span class="line">            this<span class="selector-class">.routeMap</span><span class="selector-attr">[route.path]</span> = route<span class="selector-class">.component</span> </span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    initComponents (Vue) &#123;   <span class="comment">// å‚æ•°æ˜¯vueæ„é€ å‡½æ•°</span></span><br><span class="line">        <span class="comment">// åˆ›å»ºrouter-link ç»„ä»¶</span></span><br><span class="line">        Vue<span class="selector-class">.component</span>(<span class="string">&#x27;router-link&#x27;</span>, &#123;</span><br><span class="line">            props: &#123;</span><br><span class="line">                to: String</span><br><span class="line">            &#125;,</span><br><span class="line">            template: `&lt;<span class="selector-tag">a</span> :href = <span class="string">&quot;to&quot;</span>&gt;&lt;slot&gt;&lt;/slot&gt;&lt;/a&gt;`</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="å¼•å…¥è‡ªå·±å†™çš„vueRouter"><a href="#å¼•å…¥è‡ªå·±å†™çš„vueRouter" class="headerlink" title="å¼•å…¥è‡ªå·±å†™çš„vueRouter"></a>å¼•å…¥è‡ªå·±å†™çš„vueRouter</h4><p>è¿™ä¸ªæ—¶å€™é¡µé¢ç›´æ¥å»å¼•å…¥è¿™ä¸ªæ–¹æ³•ï¼Œ</p>
<figure class="highlight coffeescript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> Vue <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span><br><span class="line"><span class="regexp">//</span> <span class="keyword">import</span> VueRouter <span class="keyword">from</span> <span class="string">&#x27;vue-router&#x27;</span></span><br><span class="line"><span class="keyword">import</span> VueRouter <span class="keyword">from</span> <span class="string">&#x27;../vuerouter&#x27;</span>  <span class="regexp">//</span> è¿™é‡Œå¼•å…¥è‡ªå·±å†™çš„vuerouter</span><br><span class="line"><span class="keyword">import</span> Home <span class="keyword">from</span> <span class="string">&#x27;../views/Home.vue&#x27;</span></span><br></pre></td></tr></table></figure>
<p>ç„¶åå‘ç°é¡µé¢ä¼šæœ‰æŠ¥é”™<br><img src="/posts/67ac0156/router_error" alt="router_error"></p>
<p>å› ä¸ºVueçš„æ„å»ºç‰ˆæœ¬åˆ†ä¸º<code>è¿è¡Œæ—¶ç‰ˆ</code> å’Œ <code>å®Œæ•´ç‰ˆ</code></p>
<ul>
<li>è¿è¡Œæ—¶ç‰ˆï¼šä¸æ”¯æŒtemplateæ¨¡ç‰ˆï¼Œéœ€è¦æ‰“åŒ…çš„æ—¶å€™æå‰ç¼–è¯‘</li>
<li>å®Œæ•´ç‰ˆï¼šåŒ…å«è¿è¡Œæ—¶å’Œç¼–è¯‘å™¨ï¼Œä½“ç§¯æ¯”è¿è¡Œæ—¶ç‰ˆæœ¬å¤§10Kå·¦å³ï¼Œç¨‹åºè¿è¡Œçš„æ—¶å€™æŠŠæ¨¡ç‰ˆè½¬æ¢æˆrenderå‡½æ•°</li>
</ul>
<p>æˆ‘ä»¬çš„vue-vliåˆ›å»ºçš„é¡¹ç›®é»˜è®¤çš„æ˜¯è¿è¡Œæ—¶ç‰ˆï¼Œæ‰€æœ‰å°±å‡ºç°ä¸Šé¢çš„é”™è¯¯äº†ï¼Œè§£å†³å¦‚ä¸‹ï¼š</p>
<ul>
<li><p>æ–¹æ³•ä¸€ï¼šé€šè¿‡å®Œæ•´ç‰ˆæ¥è§£å†³é—®é¢˜ï¼Œ<a href="https://cli.vuejs.org/zh/config/#%E5%85%A8%E5%B1%80-cli-%E9%85%8D%E7%BD%AE">https://cli.vuejs.org/zh/config/#å…¨å±€-cli-é…ç½®</a><br><img src="/posts/67ac0156/router_config" alt="router_error"><br>åœ¨æ ¹ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ªvue.config.jsæ–‡ä»¶</p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">module</span>.<span class="keyword">exports</span> = &#123;</span><br><span class="line">    runtimeCompiler: <span class="literal">true</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>è¿™æ ·é…ç½®åï¼Œé¡µé¢ä¸­router-linkå°±èƒ½æ˜¾ç¤ºäº†ï¼Œè¿˜æœ‰ä¸€ä¸ªæŠ¥é”™ï¼Œæ˜¯å› ä¸ºè‡ªå·±æ‰‹å†™æ—¶å€™è¿˜æ²¡æœ‰å†™router-view çš„ç»„ä»¶</p>
</li>
<li><p>æ–¹æ³•äºŒï¼šé€šè¿‡è¿è¡Œæ—¶ç‰ˆæ¥è§£å†³é—®é¢˜ï¼Œè¿è¡Œæ—¶ç‰ˆæœ¬çš„vueä¸å¸¦ç¼–è¯‘å™¨ï¼Œä¹Ÿå°±æ˜¯ä¸æ”¯æŒç»„ä»¶ä¸­çš„templateé€‰é¡¹ï¼Œç¼–è¯‘å™¨çš„ä½œç”¨å°±æ˜¯å°†templateç¼–è¯‘æˆrenderå‡½æ•°ï¼Œæ‰€æœ‰ç›´æ¥å†™renderå‡½æ•°æ¥è§£å†³</p>
<figure class="highlight awk"><table><tr><td class="code"><pre><span class="line">initComponents (Vue) &#123;   <span class="regexp">//</span> å‚æ•°æ˜¯vueæ„é€ å‡½æ•°</span><br><span class="line">        <span class="regexp">//</span> åˆ›å»ºrouter-link ç»„ä»¶</span><br><span class="line">        Vue.component(<span class="string">&#x27;router-link&#x27;</span>, &#123;</span><br><span class="line">            props: &#123;</span><br><span class="line">                to: String</span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="regexp">//</span> template: `&lt;a :href = <span class="string">&quot;to&quot;</span>&gt;&lt;slot&gt;&lt;<span class="regexp">/slot&gt;&lt;/</span>a&gt;`</span><br><span class="line">            render (h)&#123; </span><br><span class="line">                return h(<span class="string">&#x27;a&#x27;</span>,&#123;   <span class="regexp">//</span> hå‡½æ•° å¯ä»¥æ¥æ”¶ä¸‰ä¸ªå‚æ•°ï¼Œ<span class="number">1</span>åˆ›å»ºå…ƒç´ çš„é€‰æ‹©å™¨ <span class="number">2</span>.è®¾ç½®å±æ€§ <span class="number">3</span>.ç”Ÿæˆå…ƒç´ çš„å­å…ƒç´ æ‰€ä»¥æ•°ç»„çš„å½¢å¼</span><br><span class="line">                    attrs: &#123;</span><br><span class="line">                        href: this.to  <span class="regexp">//</span> ä¼ çš„propsä¸­çš„ to</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;, [this.<span class="variable">$slots</span>.default])   <span class="regexp">//</span>this.<span class="variable">$slots</span>.defaultè·å–é»˜è®¤æ’æ§½çš„å†…å®¹</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<h4 id="åˆ›å»ºrouter-view-è¿™ä¸ªç»„ä»¶"><a href="#åˆ›å»ºrouter-view-è¿™ä¸ªç»„ä»¶" class="headerlink" title="åˆ›å»ºrouter-view è¿™ä¸ªç»„ä»¶"></a>åˆ›å»ºrouter-view è¿™ä¸ªç»„ä»¶</h4><figure class="highlight awk"><table><tr><td class="code"><pre><span class="line">initComponents (Vue) &#123;   <span class="regexp">//</span> å‚æ•°æ˜¯vueæ„é€ å‡½æ•°</span><br><span class="line">        <span class="regexp">//</span> åˆ›å»ºrouter-link ç»„ä»¶</span><br><span class="line">        Vue.component(<span class="string">&#x27;router-link&#x27;</span>, &#123;</span><br><span class="line">            props: &#123;</span><br><span class="line">                to: String</span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="regexp">//</span> template: `&lt;a :href = <span class="string">&quot;to&quot;</span>&gt;&lt;slot&gt;&lt;<span class="regexp">/slot&gt;&lt;/</span>a&gt;`</span><br><span class="line">            render (h)&#123; </span><br><span class="line">                return h(<span class="string">&#x27;a&#x27;</span>,&#123;   <span class="regexp">//</span> hå‡½æ•° å¯ä»¥æ¥æ”¶ä¸‰ä¸ªå‚æ•°ï¼Œ<span class="number">1</span>åˆ›å»ºå…ƒç´ çš„é€‰æ‹©å™¨ <span class="number">2</span>.è®¾ç½®å±æ€§ <span class="number">3</span>.ç”Ÿæˆå…ƒç´ çš„å­å…ƒç´ æ‰€ä»¥æ•°ç»„çš„å½¢å¼</span><br><span class="line">                    attrs: &#123;</span><br><span class="line">                        href: this.to  <span class="regexp">//</span> ä¼ çš„propsä¸­çš„ to</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;, [this.<span class="variable">$slots</span>.default])   <span class="regexp">//</span>this.<span class="variable">$slots</span>.defaultè·å–é»˜è®¤æ’æ§½çš„å†…å®¹</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">        const self = this</span><br><span class="line">        <span class="regexp">//</span> åˆ›å»ºrouter-view ç»„ä»¶</span><br><span class="line">        Vue.component(<span class="string">&#x27;router-view&#x27;</span>,&#123;</span><br><span class="line">            render(h)&#123;   <span class="regexp">//</span> hä½œç”¨æ˜¯åˆ›å»ºè™šæ‹ŸDOM</span><br><span class="line">                <span class="regexp">//</span> æ‰¾åˆ°å½“å‰è·¯ç”±çš„åœ°å€ æ ¹æ®å½“å‰è·¯ç”±åœ°å€ï¼Œå»routeMapå¯¹è±¡ä¸­ï¼Œæ‰¾åˆ°å¯¹åº”çš„ç»„ä»¶ï¼Œç„¶åå†è°ƒç”¨hå‡½æ•°ï¼ŒæŠŠæ‰¾åˆ°çš„ç»„ä»¶è½¬æ¢æˆè™šæ‹ŸDOMç›´æ¥è¿”å›</span><br><span class="line">                const component = self.routeMap[self.data.current]  <span class="regexp">//</span>è·å–ç»„ä»¶</span><br><span class="line">                return h(component)   <span class="regexp">//</span> è°ƒç”¨hå‡½æ•°ï¼Œè¿”å›è™šæ‹ŸDOM ï¼Œhå‡½æ•°è¿˜å¯ä»¥ç›´æ¥æŠŠç»„ä»¶è½¬æ¢æˆè™šæ‹ŸDOM</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<p>è¿™ä¸ªæ—¶å€™å»é¡µé¢æŸ¥çœ‹ï¼Œæ²¡æœ‰æŠ¥é”™äº†ï¼Œå¯ä»¥æ˜¾ç¤ºäº†ï¼Œä½†æ˜¯å½“ç‚¹å‡»åˆ‡æ¢çš„æ—¶å€™ï¼Œé¡µé¢ä¼šåˆ·æ–°,éœ€è¦ç»™è¿™ä¸ªè¶…é“¾æ¥æ³¨å†Œä¸€ä¸ªç‚¹å‡»æ—¶é—´ï¼Œå–æ¶ˆåç»­æ‰§è¡Œï¼Œè¿˜éœ€è¦å°†åœ°å€æ ä¸­çš„å€¼ï¼Œæ”¹ä¸ºè¶…é“¾æ¥hrefä¸­çš„å€¼ï¼Œå°±éœ€è¦history.pushState()æ–¹æ³•</p>
<figure class="highlight awk"><table><tr><td class="code"><pre><span class="line"><span class="regexp">//</span> åˆ›å»ºrouter-link ç»„ä»¶</span><br><span class="line">        Vue.component(<span class="string">&#x27;router-link&#x27;</span>, &#123;</span><br><span class="line">            props: &#123;</span><br><span class="line">                to: String</span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="regexp">//</span> template: `&lt;a :href = <span class="string">&quot;to&quot;</span>&gt;&lt;slot&gt;&lt;<span class="regexp">/slot&gt;&lt;/</span>a&gt;`</span><br><span class="line">            render (h)&#123; </span><br><span class="line">                return h(<span class="string">&#x27;a&#x27;</span>,&#123;   <span class="regexp">//</span> hå‡½æ•° å¯ä»¥æ¥æ”¶ä¸‰ä¸ªå‚æ•°ï¼Œ<span class="number">1</span>åˆ›å»ºå…ƒç´ çš„é€‰æ‹©å™¨ <span class="number">2</span>.è®¾ç½®å±æ€§ <span class="number">3</span>.ç”Ÿæˆå…ƒç´ çš„å­å…ƒç´ æ‰€ä»¥æ•°ç»„çš„å½¢å¼</span><br><span class="line">                    attrs: &#123;</span><br><span class="line">                        href: this.to  <span class="regexp">//</span> ä¼ çš„propsä¸­çš„ to</span><br><span class="line">                    &#125;,</span><br><span class="line">                    <span class="regexp">//</span> ç»™aæ ‡ç­¾æ·»åŠ äº‹ä»¶</span><br><span class="line">                    on: &#123;</span><br><span class="line">                        click: this.clickHandler</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;, [this.<span class="variable">$slots</span>.default])   <span class="regexp">//</span>this.<span class="variable">$slots</span>.defaultè·å–é»˜è®¤æ’æ§½çš„å†…å®¹</span><br><span class="line">            &#125;,</span><br><span class="line">            methods:&#123;</span><br><span class="line">                clickHandler(e)&#123;</span><br><span class="line">                    history.pushState(&#123;&#125;,<span class="string">&#x27;&#x27;</span>, this.to)  <span class="regexp">//</span>ä¸‰ä¸ªå‚æ•°ï¼š<span class="number">1</span>.data å°†æ¥è§¦å‘pushStateè¿™ä¸ªäº‹ä»¶å¯¹è±¡çš„å‚æ•°  <span class="number">2</span>.titleç½‘é¡µæ ‡é¢˜ <span class="number">3</span>.urlåœ°å€</span><br><span class="line">                    </span><br><span class="line">                    <span class="regexp">//</span> å°†å½“å‰çš„è·¯å¾„ï¼Œè®°å½•åˆ°data.currenté‡Œé¢</span><br><span class="line">                    this.<span class="variable">$router</span>.data.current = this.to</span><br><span class="line">                    </span><br><span class="line">                    <span class="regexp">//</span> é˜»æ­¢è·³è½¬é»˜è®¤è¡Œä¸º</span><br><span class="line">                    e.preventDefault()</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;)</span><br></pre></td></tr></table></figure>
<p>ç°åœ¨å°±å¯ä»¥ç‚¹å‡»äº†ï¼Œä¸ä¼šåˆ·æ–°äº†ï¼Œåœ°å€æ ä¹Ÿä¼šè·Ÿç€ç‚¹å‡»æ ‡ç­¾çš„hrefæ‰€æ”¹å˜äº†ï¼Œè™½ç„¶ç°åœ¨å¯ä»¥ï¼Œä½†æ˜¯å½“æˆ‘ä»¬ç‚¹å‡»æµè§ˆå™¨å‰è¿›ï¼Œåé€€çš„æ—¶å€™ï¼Œåœ°å€æ å‘ç”Ÿäº†å˜åŒ–ï¼Œä½†æ˜¯ç»„ä»¶æ²¡æœ‰å‘ç”Ÿå˜åŒ–ï¼Œå› ä¸ºå‰è¿›åé€€çš„æ—¶å€™ï¼Œæ²¡æœ‰é‡æ–°åŠ è½½åœ°å€æ å¯¹åº”çš„ç»„ä»¶ï¼Œä¸‹é¢é€šè¿‡popstateè¿›è¡Œæ”¹è¿›ï¼Œå½“å†å²å‘ç”Ÿå˜åŒ–è§¦å‘ï¼Œåˆ°è¿™é‡Œæ¨¡æ‹Ÿrouterçš„historyæ¨¡å¼å°±æå®šäº†</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// è§£å†³å‰è¿›åé€€ åœ°å€æ å˜åŒ–ç»„ä»¶ä¸å˜åŒ–çš„é—®é¢˜</span></span><br><span class="line">    <span class="title function_">initEvent</span>(<span class="params"></span>)&#123;</span><br><span class="line">        <span class="variable language_">window</span>.<span class="title function_">addEventListener</span>(<span class="string">&#x27;popstate&#x27;</span>, <span class="function">()=&gt;</span> &#123;</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">data</span>.<span class="property">current</span> = <span class="variable language_">window</span>.<span class="property">location</span>.<span class="property">pathname</span>  <span class="comment">//è·¯å¾„éƒ¨åˆ†</span></span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<p>å®Œæ•´ä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line">let _Vue = <span class="literal">null</span></span><br><span class="line">export default <span class="class"><span class="keyword">class</span> <span class="title">VueRouter</span> </span>&#123;</span><br><span class="line">    <span class="comment">// å¯¼å‡ºä¸€ä¸ªé™æ€æ–¹æ³• install</span></span><br><span class="line">    <span class="comment">// Vue.use() ä¸­è°ƒç”¨installæ–¹æ³•æ—¶å€™ï¼Œä¼šä¼ é€’ä¸¤ä¸ªå‚æ•°ï¼Œä¸€ä¸ªæ˜¯vueæ„é€ å‡½æ•° å¦ä¸€ä¸ªæ˜¯ å¯é€‰çš„é€‰é¡¹å¯¹è±¡ </span></span><br><span class="line">    static install (Vue) &#123;  <span class="comment">//è¿™é‡Œä¼ é€’æ„é€ å‡½æ•°</span></span><br><span class="line">        <span class="comment">// 1. åˆ¤æ–­å½“å‰æ’ä»¶æ˜¯å¦å·²ç»è¢«å®‰è£…</span></span><br><span class="line">        <span class="keyword">if</span>(VueRouter.install.installed)&#123; </span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        &#125;</span><br><span class="line">        VueRouter.install.installed = <span class="literal">true</span></span><br><span class="line">        <span class="comment">// 2. æŠŠvueæ„é€ å‡½æ•°è®°å½•åˆ°å…¨å±€å˜é‡</span></span><br><span class="line">        _Vue = Vue</span><br><span class="line">        <span class="comment">// 3. æŠŠåˆ›å»ºvueå®ä¾‹æ—¶å€™ä¼ å…¥çš„router å¯¹è±¡æ³¨å…¥åˆ°vueå®ä¾‹ä¸Š</span></span><br><span class="line">        <span class="comment">// æ··å…¥</span></span><br><span class="line">        _Vue.mixin(&#123;</span><br><span class="line">            beforeCreate()&#123;</span><br><span class="line">                <span class="comment">// åªæœ‰vue $optionsé‡Œé¢æ‰ä¼šæœ‰router ç»„ä»¶æ²¡æœ‰</span></span><br><span class="line">                <span class="keyword">if</span>(<span class="keyword">this</span>.$options.router)&#123;</span><br><span class="line">                    _Vue.prototype.$router = <span class="keyword">this</span>.$options.router</span><br><span class="line">                    <span class="comment">// å…ˆæ‰¾åˆ°routeå¯¹è±¡ï¼Œç„¶åå†è°ƒç”¨initæ–¹æ³•</span></span><br><span class="line">                    <span class="keyword">this</span>.$options.router.<span class="keyword">init</span>()</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// åˆ›å»ºä¸€ä¸ªæ„é€ å‡½æ•°</span></span><br><span class="line">    <span class="keyword">constructor</span>(options)&#123;</span><br><span class="line">        <span class="keyword">this</span>.options = options    <span class="comment">//ä½œç”¨å°±æ˜¯è®°å½•æ„é€ å‡½æ•°ä¼ å…¥çš„optionsè·¯ç”±è§„åˆ™</span></span><br><span class="line">        <span class="keyword">this</span>.routeMap = &#123;&#125;  <span class="comment">// routeMapé‡Œé¢æ˜¯ä¸€ä¸ªé”®å€¼å¯¹å½¢å¼ï¼Œå¥å­˜çš„å°±æ˜¯è·¯ç”±åœ°å€ï¼Œå€¼å°±æ˜¯è·¯ç”±ç»„ä»¶ å°†æ¥åœ¨router-viewè¿™ä¸ªç»„ä»¶é‡Œé¢ä¼šæ ¹æ®å½“å‰çš„è·¯ç”±åœ°å€åˆ°routeMapé‡Œé¢æ‰¾åˆ°å¯¹åº”çš„ç»„ä»¶ç„¶åæ¸²æŸ“åˆ°æµè§ˆå™¨ä¸­</span></span><br><span class="line">        <span class="keyword">this</span>.<span class="keyword">data</span> = _Vue.observable(&#123;  <span class="comment">// å“åº”å¼å¯¹è±¡</span></span><br><span class="line">            current: <span class="string">&#x27;/&#x27;</span>  <span class="comment">//  currentç”¨æ¥è®°å½•å½“å‰è·¯ç”±åœ°å€ï¼Œé»˜è®¤æƒ…å†µä¸‹æ˜¯ / æ–œæ </span></span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// åˆ›å»ºä¸€ä¸ªåˆå§‹åŒ–æ–¹æ³• æ–¹ä¾¿è°ƒç”¨</span></span><br><span class="line">    <span class="keyword">init</span> () &#123;</span><br><span class="line">        <span class="keyword">this</span>.createRouteMap()</span><br><span class="line">        <span class="keyword">this</span>.initComponents(_Vue)  <span class="comment">// ä¼ å…¥æ„é€ å‡½æ•°</span></span><br><span class="line">        <span class="keyword">this</span>.initEvent()</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è¿™ä¸ªæ–¹æ³•çš„ä½œç”¨æ˜¯å»éå†æ‰€æœ‰çš„è·¯ç”±è§„åˆ™ï¼ŒæŠŠè¿™äº›è·¯ç”±è§„åˆ™è§£ææˆé”®å€¼å¯¹çš„å½¢å¼å­˜å‚¨åˆ°routeMapä¸­</span></span><br><span class="line">    createRouteMap()&#123;</span><br><span class="line">        <span class="comment">// this.options.routes // æ‰€æœ‰çš„è·¯ç”±è§„åˆ™</span></span><br><span class="line">        <span class="keyword">this</span>.options.routes.forEach(route =&gt; &#123;</span><br><span class="line">            <span class="keyword">this</span>.routeMap[route.path] = route.component </span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    initComponents (Vue) &#123;   <span class="comment">// å‚æ•°æ˜¯vueæ„é€ å‡½æ•°</span></span><br><span class="line">        <span class="comment">// åˆ›å»ºrouter-link ç»„ä»¶</span></span><br><span class="line">        Vue.component(<span class="string">&#x27;router-link&#x27;</span>, &#123;</span><br><span class="line">            props: &#123;</span><br><span class="line">                to: String</span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="comment">// template: `&lt;a :href = &quot;to&quot;&gt;&lt;slot&gt;&lt;/slot&gt;&lt;/a&gt;`</span></span><br><span class="line">            render (h)&#123; </span><br><span class="line">                <span class="keyword">return</span> h(<span class="string">&#x27;a&#x27;</span>,&#123;   <span class="comment">// hå‡½æ•° å¯ä»¥æ¥æ”¶ä¸‰ä¸ªå‚æ•°ï¼Œ1åˆ›å»ºå…ƒç´ çš„é€‰æ‹©å™¨ 2.è®¾ç½®å±æ€§ 3.ç”Ÿæˆå…ƒç´ çš„å­å…ƒç´ æ‰€ä»¥æ•°ç»„çš„å½¢å¼</span></span><br><span class="line">                    attrs: &#123;</span><br><span class="line">                        href: <span class="keyword">this</span>.to  <span class="comment">// ä¼ çš„propsä¸­çš„ to</span></span><br><span class="line">                    &#125;,</span><br><span class="line">                    <span class="comment">// ç»™aæ ‡ç­¾æ·»åŠ äº‹ä»¶</span></span><br><span class="line">                    on: &#123;</span><br><span class="line">                        click: <span class="keyword">this</span>.clickHandler</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;, [<span class="keyword">this</span>.$slots.default])   <span class="comment">//this.$slots.defaultè·å–é»˜è®¤æ’æ§½çš„å†…å®¹</span></span><br><span class="line">            &#125;,</span><br><span class="line">            methods:&#123;</span><br><span class="line">                clickHandler(e)&#123;</span><br><span class="line">                    history.pushState(&#123;&#125;,<span class="string">&#x27;&#x27;</span>, <span class="keyword">this</span>.to)  <span class="comment">//ä¸‰ä¸ªå‚æ•°ï¼š1.data å°†æ¥è§¦å‘pushStateè¿™ä¸ªäº‹ä»¶å¯¹è±¡çš„å‚æ•°  2.titleç½‘é¡µæ ‡é¢˜ 3.urlåœ°å€</span></span><br><span class="line">                    </span><br><span class="line">                    <span class="comment">// å°†å½“å‰çš„è·¯å¾„ï¼Œè®°å½•åˆ°data.currenté‡Œé¢</span></span><br><span class="line">                    <span class="keyword">this</span>.$router.<span class="keyword">data</span>.current = <span class="keyword">this</span>.to</span><br><span class="line">                    </span><br><span class="line">                    <span class="comment">// é˜»æ­¢è·³è½¬é»˜è®¤è¡Œä¸º</span></span><br><span class="line">                    e.preventDefault()</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">        <span class="keyword">const</span> self = <span class="keyword">this</span></span><br><span class="line">        <span class="comment">// åˆ›å»ºrouter-view ç»„ä»¶</span></span><br><span class="line">        Vue.component(<span class="string">&#x27;router-view&#x27;</span>,&#123;</span><br><span class="line">            render(h)&#123;   <span class="comment">// hä½œç”¨æ˜¯åˆ›å»ºè™šæ‹ŸDOM</span></span><br><span class="line">                <span class="comment">// æ‰¾åˆ°å½“å‰è·¯ç”±çš„åœ°å€ æ ¹æ®å½“å‰è·¯ç”±åœ°å€ï¼Œå»routeMapå¯¹è±¡ä¸­ï¼Œæ‰¾åˆ°å¯¹åº”çš„ç»„ä»¶ï¼Œç„¶åå†è°ƒç”¨hå‡½æ•°ï¼ŒæŠŠæ‰¾åˆ°çš„ç»„ä»¶è½¬æ¢æˆè™šæ‹ŸDOMç›´æ¥è¿”å›</span></span><br><span class="line">                <span class="keyword">const</span> component = self.routeMap[self.<span class="keyword">data</span>.current]  <span class="comment">//è·å–ç»„ä»¶</span></span><br><span class="line">                <span class="keyword">return</span> h(component)   <span class="comment">// è°ƒç”¨hå‡½æ•°ï¼Œè¿”å›è™šæ‹ŸDOM ï¼Œhå‡½æ•°è¿˜å¯ä»¥ç›´æ¥æŠŠç»„ä»¶è½¬æ¢æˆè™šæ‹ŸDOM</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è§£å†³å‰è¿›åé€€ åœ°å€æ å˜åŒ–ç»„ä»¶ä¸å˜åŒ–çš„é—®é¢˜</span></span><br><span class="line">    initEvent()&#123;</span><br><span class="line">        window.addEventListener(<span class="string">&#x27;popstate&#x27;</span>, ()=&gt; &#123;</span><br><span class="line">            <span class="keyword">this</span>.<span class="keyword">data</span>.current = window.location.pathname  <span class="comment">// è·¯å¾„éƒ¨åˆ†å°±æ˜¯/æ–œæ å’Œæ–œæ åé¢çš„éƒ¨åˆ†  eg: /home</span></span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
]]></content>
      <categories>
        <category>webå‰ç«¯</category>
      </categories>
      <tags>
        <tag>Vue</tag>
        <tag>vue-router</tag>
      </tags>
  </entry>
  <entry>
    <title>å“åº”å¼åŸç†æ¨¡æ‹Ÿ</title>
    <url>/posts/e3abf81e.html</url>
    <content><![CDATA[<p><img src="/posts/e3abf81e/liuchen.png" alt="mvvmå“åº”å¼åŸç†"> </p>
<span id="more"></span>
<p>Vue.jsæ˜¯å½“å‰æ¯”è¾ƒç«çš„JavaScript MVVMï¼ˆModel View ViewModelï¼‰ï¼Œæ•°æ®ï¼Œè§†å›¾ï¼Œè§†å›¾æ¨¡å‹ï¼‰åº“ï¼Œå®ƒè·Ÿä»¥å¾€çš„ä¸åŒä¹‹å¤„åœ¨äºï¼Œä¹‹å‰æ›´å¤šçš„æ˜¯æ‰‹åŠ¨æ“ä½œDomï¼Œç°åœ¨æ˜¯ä»¥æ•°æ®ä¸ºé©±åŠ¨ï¼Œæœ¬ç¯‡æ–‡ç« é€šè¿‡å¯¹<code>æ•°æ®é©±åŠ¨</code>ã€<code>æ•°æ®å“åº”å¼çš„æ ¸å¿ƒåŸç†</code>ã€<code>å‘å¸ƒè®¢é˜…æ¨¡å¼</code>ã€<code>è§‚å¯Ÿè€…æ¨¡å¼</code>è¿™å‡ ä¸ªçŸ¥è¯†ç‚¹çš„å­¦ä¹ ï¼Œç„¶åæ¨¡æ‹Ÿvueå“åº”å¼åŸç†ï¼Œå®ç°ä¸€ä¸ªç®€å•å°ç‰ˆæœ¬çš„Vueã€‚</p>
<h3 id="æ•°æ®é©±åŠ¨"><a href="#æ•°æ®é©±åŠ¨" class="headerlink" title="æ•°æ®é©±åŠ¨"></a>æ•°æ®é©±åŠ¨</h3><p>è¯´åˆ°æ•°æ®é©±åŠ¨ï¼Œé¦–å…ˆå¯¹<code>æ•°æ®å“åº”å¼</code>ã€<code>åŒå‘ç»‘å®š</code>ã€<code>æ•°æ®é©±åŠ¨</code> è¿™ä¸‰ä¸ªæ¨¡å—è¿›è¡Œä¸€ä¸ªç®€å•ä»‹ç»</p>
<ul>
<li>æ•°æ®å“åº”å¼<br>  æ•°æ®å“åº”å¼ä¸­çš„æ•°æ®æŒ‡çš„æ˜¯æ•°æ®æ¨¡å‹ï¼Œæ•°æ®æ¨¡å‹ä»…ä»…æ˜¯æ™®é€šçš„JavaScriptå¯¹è±¡ï¼Œæ•°æ®å“åº”å¼çš„æ ¸å¿ƒæŒ‡çš„æ˜¯å½“æˆ‘ä»¬ä¿®æ”¹æ•°æ®æ—¶ï¼Œè§†å›¾ä¼šè¿›è¡Œæ›´æ–°ï¼Œé¿å…äº†ç¹ççš„DOMæ“ä½œï¼Œæé«˜å¼€å‘æ•ˆç‡ã€‚</li>
<li>åŒå‘ç»‘å®š<br>  æ•°æ®æ”¹å˜ï¼Œè§†å›¾æ”¹å˜ï¼›è§†å›¾æ”¹å˜ï¼Œæ•°æ®ä¹Ÿéšä¹‹æ”¹å˜ï¼›æˆ‘ä»¬å¯ä»¥ä½¿ç”¨v-modelåœ¨è¡¨å•å…ƒç´ ä¸Šåˆ›å»ºåŒå‘æ•°æ®ç»‘å®šã€‚</li>
<li>æ•°æ®é©±åŠ¨<br>  è¿™ä¸ªæ˜¯Vueæœ€ç‹¬ç‰¹çš„ç‰¹æ€§ä¹‹ä¸€ï¼Œè®©æˆ‘ä»¬åœ¨å¼€å‘è¿‡ç¨‹ä¸­ä»…éœ€è¦å…³æ³¨æ•°æ®æœ¬èº«ï¼Œä¸éœ€è¦å…³å¿ƒæ•°æ®æ˜¯å¦‚ä½•æ¸²æŸ“åˆ°è§†å›¾çš„ã€‚<h3 id="æ•°æ®å“åº”å¼çš„æ ¸å¿ƒåŸç†"><a href="#æ•°æ®å“åº”å¼çš„æ ¸å¿ƒåŸç†" class="headerlink" title="æ•°æ®å“åº”å¼çš„æ ¸å¿ƒåŸç†"></a>æ•°æ®å“åº”å¼çš„æ ¸å¿ƒåŸç†</h3><h4 id="Vue2-x"><a href="#Vue2-x" class="headerlink" title="Vue2.x"></a>Vue2.x</h4>Vue2.xçš„æ ¸å¿ƒæ˜¯é€šè¿‡<code>Object.defineProperty</code>æŠŠæ•°æ®è½¬æˆ<code>getter/setter</code>è®©Vueèƒ½å¤Ÿè¿½è¸ªä¾èµ–ï¼Œåœ¨æ•°æ®è¢«è®¿é—®å’Œä¿®æ”¹æ—¶ï¼Œå¯ä»¥è¿›è¡Œè¿›è¡Œæ•°æ®åŠ«æŒé€šçŸ¥å˜æ›´ã€‚</li>
<li><a href="https://cn.vuejs.org/v2/guide/reactivity.html">Vue2.xå“åº”å¼åŸç†</a></li>
<li><a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Object/defineProperty">MDN-Object.defineProperty</a></li>
<li><code>Object.defineProperty</code> æ˜¯ ES5 ä¸­ä¸€ä¸ªæ— æ³• <code>shimï¼ˆåœ¨ä¸€ä¸ªæ—§çš„ç¯å¢ƒä¸­æ¨¡æ‹Ÿå‡ºä¸€ä¸ªæ–° API ï¼Œè€Œä¸”ä»…é æ—§ç¯å¢ƒä¸­å·²æœ‰çš„æ‰‹æ®µå®ç°ï¼Œä»¥ä¾¿æ‰€æœ‰çš„æµè§ˆå™¨å…·æœ‰ç›¸åŒçš„è¡Œä¸ºï¼‰</code>çš„ç‰¹æ€§ï¼Œè¿™ä¹Ÿå°±æ˜¯ Vue ä¸æ”¯æŒ IE8 ä»¥åŠæ›´ä½ç‰ˆæœ¬æµè§ˆå™¨çš„åŸå› ã€‚</li>
<li>Vue å®˜æ–¹å¯¹äº ie æµè§ˆå™¨ç‰ˆæœ¬å…¼å®¹æƒ…å†µçš„æè¿°æ˜¯ ie9+ï¼Œå³æ˜¯ ie9 åŠæ›´é«˜çš„ç‰ˆæœ¬ã€‚ç»è¿‡æµ‹è¯•ï¼ŒVue çš„æ ¸å¿ƒæ¡†æ¶ vuejsæœ¬èº«ï¼Œä»¥åŠç”Ÿæ€çš„å®˜æ–¹æ ¸å¿ƒæ’ä»¶ï¼ˆVueRouterã€Vuexç­‰ï¼‰å‡å¯ä»¥åœ¨ ie9 ä¸Šæ­£å¸¸ä½¿ç”¨ã€‚è§£å†³æ–¹æ¡ˆæ˜¯ä½¿ç”¨ babel-polyfillï¼Œå®ƒå¯ä»¥å°† es6 çš„ä»£ç ç¿»è¯‘æˆä½ç‰ˆæœ¬æµè§ˆå™¨å¯ä»¥è¯†åˆ«çš„ es5 ä»£ç .</li>
</ul>
<p><code>Object.defineProperty</code>åŸºæœ¬ä½¿ç”¨ï¼š</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>defineProperty<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;app&quot;</span>&gt;</span></span><br><span class="line">        hello</span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">        <span class="comment">// æ¨¡æ‹Ÿ Vueä¸­çš„dataé€‰é¡¹</span></span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">let</span> data = &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="attr">msg</span>: <span class="string">&#x27;Hello&#x27;</span></span></span><br><span class="line"><span class="language-javascript">        &#125;</span></span><br><span class="line"><span class="language-javascript">        <span class="comment">// æ¨¡æ‹Ÿvueå®ä¾‹</span></span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">let</span> vm = &#123;&#125;</span></span><br><span class="line"><span class="language-javascript">        <span class="comment">// æ•°æ®åŠ«æŒï¼šå½“è®¿é—®è€…æˆ–è€…è®¿é—®vmä¸­æˆå‘˜çš„æ—¶å€™ï¼Œåšä¸€äº›å¹²é¢„æ“ä½œ</span></span></span><br><span class="line"><span class="language-javascript">        <span class="comment">// ä¸‰ä¸ªå‚æ•°ï¼š1.å¯¹è±¡   2.å¯¹è±¡å¢åŠ çš„å±æ€§  3.å±æ€§æè¿°</span></span></span><br><span class="line"><span class="language-javascript">        <span class="title class_">Object</span>.<span class="title function_">defineProperty</span>(vm, <span class="string">&#x27;msg&#x27;</span>, &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="comment">// å¯æšä¸¾ï¼ˆå¯éå†ï¼‰</span></span></span><br><span class="line"><span class="language-javascript">            <span class="attr">enumerable</span>: <span class="literal">true</span>,</span></span><br><span class="line"><span class="language-javascript">            <span class="comment">// å¯é…ç½®ï¼ˆå¯ä»¥ä½¿ç”¨deleteåˆ é™¤ï¼Œæˆ–å¯ä»¥é€šè¿‡ defineProperty é‡æ–°å®šä¹‰ï¼‰</span></span></span><br><span class="line"><span class="language-javascript">            <span class="attr">configurable</span>: <span class="literal">true</span>,</span></span><br><span class="line"><span class="language-javascript">            <span class="comment">// å½“è·å–å€¼çš„æ—¶å€™æ‰§è¡Œ</span></span></span><br><span class="line"><span class="language-javascript">            <span class="title function_">get</span>(<span class="params"></span>)&#123;</span></span><br><span class="line"><span class="language-javascript">                <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;get:&#x27;</span>,data.<span class="property">msg</span>)</span></span><br><span class="line"><span class="language-javascript">            &#125;,</span></span><br><span class="line"><span class="language-javascript">            <span class="comment">// å½“è®¾ç½®å€¼çš„æ—¶å€™æ‰§è¡Œ</span></span></span><br><span class="line"><span class="language-javascript">            <span class="title function_">set</span>(<span class="params">newValue</span>)&#123;</span></span><br><span class="line"><span class="language-javascript">                <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;set:&#x27;</span>,newValue)</span></span><br><span class="line"><span class="language-javascript">                <span class="keyword">if</span>(newValue == data.<span class="property">msg</span>)&#123;</span></span><br><span class="line"><span class="language-javascript">                    <span class="keyword">return</span></span></span><br><span class="line"><span class="language-javascript">                &#125;</span></span><br><span class="line"><span class="language-javascript">                data.<span class="property">msg</span> = newValue</span></span><br><span class="line"><span class="language-javascript">                <span class="comment">// æ•°æ®æ›´æ”¹ï¼Œæ›´æ–°DOMçš„å€¼</span></span></span><br><span class="line"><span class="language-javascript">                <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;#app&#x27;</span>).<span class="property">textContent</span> = data.<span class="property">msg</span></span></span><br><span class="line"><span class="language-javascript">            &#125;</span></span><br><span class="line"><span class="language-javascript">        &#125;)</span></span><br><span class="line"><span class="language-javascript">    </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>åœ¨æ§åˆ¶å°é€šè¿‡<code>vm.msg</code>è·å–å€¼çš„æ—¶å€™ï¼Œè§¦å‘äº†<code>get</code>çš„æ–¹æ³•ï¼Œé€šè¿‡<code>vm.msg=&#39;xxx&#39;</code>,è§¦å‘äº†<code>set</code>çš„æ–¹æ³•ï¼Œæ•ˆæœå¦‚ä¸‹ï¼š<br><img src="/posts/e3abf81e/1.png" alt="æ§åˆ¶å°å±•ç¤º"><br>ä»¥ä¸Šä»£ç æ¨¡æ‹Ÿçš„æ˜¯å¯¹ä¸€ä¸ªå¯¹è±¡ä¸­ä¸€ä¸ªå±æ€§<code>msg</code>çš„è½¬æ¢<code>getter/setter</code>ï¼Œé‚£ä¹ˆå¦‚æœä¸€ä¸ªå¯¹è±¡ä¸­å¤šä¸ªå±æ€§éœ€è¦è½¬æ¢<code>getter/setter</code>å¦‚ä½•å¤„ç†å‘¢ï¼Ÿ<br>æ€è·¯å¦‚ä¸‹ï¼šé€šè¿‡<code> Object.keys()</code>éå†ï¼Œç„¶åå†è½¬æ¢æˆvmçš„<code>setter/getter</code></p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>defineProperty<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;app&quot;</span>&gt;</span></span><br><span class="line">        hello</span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">        <span class="comment">// æ¨¡æ‹Ÿ Vueä¸­çš„dataé€‰é¡¹</span></span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">let</span> data = &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="attr">msg</span>: <span class="string">&#x27;Hello&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">            <span class="attr">count</span>: <span class="number">100</span></span></span><br><span class="line"><span class="language-javascript">        &#125;</span></span><br><span class="line"><span class="language-javascript">        <span class="comment">// æ¨¡æ‹Ÿvueå®ä¾‹</span></span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">let</span> vm = &#123;&#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">        <span class="title function_">proxyData</span>(data)</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">function</span> <span class="title function_">proxyData</span>(<span class="params">data</span>)&#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="comment">// éå†dataå¯¹è±¡ä¸­çš„æ‰€æœ‰å±æ€§</span></span></span><br><span class="line"><span class="language-javascript">            <span class="title class_">Object</span>.<span class="title function_">keys</span>(data).<span class="title function_">forEach</span>(<span class="function"><span class="params">key</span>=&gt;</span>&#123;</span></span><br><span class="line"><span class="language-javascript">                <span class="comment">// æŠŠdata ä¸­çš„å±æ€§ï¼Œè½¬æ¢æˆvmçš„setter/getter</span></span></span><br><span class="line"><span class="language-javascript">                <span class="title class_">Object</span>.<span class="title function_">defineProperty</span>(vm, key, &#123;</span></span><br><span class="line"><span class="language-javascript">                    <span class="attr">enumerable</span>: <span class="literal">true</span>,</span></span><br><span class="line"><span class="language-javascript">                    <span class="attr">configurable</span>: <span class="literal">true</span>,</span></span><br><span class="line"><span class="language-javascript">                    <span class="title function_">get</span>(<span class="params"></span>)&#123;</span></span><br><span class="line"><span class="language-javascript">                        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;get:&#x27;</span>, key, data[key])</span></span><br><span class="line"><span class="language-javascript">                        <span class="keyword">return</span> data[key]</span></span><br><span class="line"><span class="language-javascript">                    &#125;,</span></span><br><span class="line"><span class="language-javascript">                    <span class="title function_">set</span>(<span class="params">newValue</span>)&#123;</span></span><br><span class="line"><span class="language-javascript">                        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;set:&#x27;</span>, key, newValue)</span></span><br><span class="line"><span class="language-javascript">                        <span class="keyword">if</span>(newValue === data[key])&#123;</span></span><br><span class="line"><span class="language-javascript">                            <span class="keyword">return</span></span></span><br><span class="line"><span class="language-javascript">                        &#125;</span></span><br><span class="line"><span class="language-javascript">                        data[key] = newValue</span></span><br><span class="line"><span class="language-javascript">                        <span class="comment">// æ•°æ®æ›´æ”¹ï¼Œæ›´æ–°DOMçš„å€¼</span></span></span><br><span class="line"><span class="language-javascript">                        <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;#app&#x27;</span>).<span class="property">textContent</span> = data[key]</span></span><br><span class="line"><span class="language-javascript">                    &#125;</span></span><br><span class="line"><span class="language-javascript">                &#125;)</span></span><br><span class="line"><span class="language-javascript">            &#125;)</span></span><br><span class="line"><span class="language-javascript">        &#125;</span></span><br><span class="line"><span class="language-javascript">    </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="Vue3-x"><a href="#Vue3-x" class="headerlink" title="Vue3.x"></a>Vue3.x</h4><p>Vue3.xæ ¸å¿ƒçš„æ˜¯é€šè¿‡<code>Proxy</code>æŠŠæ•°æ®è½¬æˆ<code>getter/setter</code>è®©Vueèƒ½å¤Ÿè¿½è¸ªä¾èµ–ã€‚</p>
<ul>
<li><a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/Proxy">MDN-Proxy</a></li>
<li>ç›´æ¥ç›‘å¬å¯¹è±¡ï¼Œå¹¶éå±æ€§</li>
<li>ES6 ä¸­æ–°å¢ï¼ŒIEä¸æ”¯æŒï¼Œæ€§èƒ½ç”±æµè§ˆå™¨ä¼˜åŒ–ï¼ˆæ¯”Object.definePropertyå¥½ï¼‰</li>
</ul>
<p>ä½¿ç”¨å¦‚ä¸‹ï¼š</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Document<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;app&quot;</span>&gt;</span></span><br><span class="line">        hello</span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">        <span class="comment">// æ¨¡æ‹ŸVue ä¸­ dataé€‰é¡¹</span></span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">let</span> data = &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="attr">msg</span>: <span class="string">&#x27;hello&#x27;</span>,</span></span><br><span class="line"><span class="language-javascript">            <span class="attr">count</span>: <span class="number">10</span></span></span><br><span class="line"><span class="language-javascript">        &#125;</span></span><br><span class="line"><span class="language-javascript">        <span class="comment">// æ¨¡æ‹ŸVueå®ä¾‹</span></span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">let</span> vm = <span class="keyword">new</span> <span class="title class_">Proxy</span>(data, &#123;  <span class="comment">// ç¬¬ä¸€ä¸ªå‚æ•°ï¼šä»£ç†å¯¹è±¡ï¼Œ ç¬¬äºŒå‚æ•°ï¼šæ‰§è¡Œä»£ç†è¡Œä¸ºçš„å‡½æ•°</span></span></span><br><span class="line"><span class="language-javascript">            <span class="comment">// å½“è®¿é—®vm çš„æˆå‘˜ä¼šæ‰§è¡Œ </span></span></span><br><span class="line"><span class="language-javascript">            <span class="comment">// ä¸¤ä¸ªå‚æ•°ï¼Œ1: ä»£ç†çš„ç›®æ ‡å¯¹è±¡ï¼Œ2:è¦è®¿é—®çš„å“ªä¸ªå±æ€§</span></span></span><br><span class="line"><span class="language-javascript">            <span class="title function_">get</span>(<span class="params">target, key</span>)&#123;</span></span><br><span class="line"><span class="language-javascript">                <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;set, key:&#x27;</span>, key, target[key])</span></span><br><span class="line"><span class="language-javascript">                <span class="keyword">return</span> target[key]</span></span><br><span class="line"><span class="language-javascript">            &#125;,</span></span><br><span class="line"><span class="language-javascript">            <span class="comment">// å½“è®¾ç½®vm çš„æˆå‘˜ä¼šæ‰§è¡Œ</span></span></span><br><span class="line"><span class="language-javascript">            <span class="comment">// ä¸‰ä¸ªå‚æ•°ï¼š 1:ä»£ç†çš„ç›®æ ‡å¯¹è±¡ï¼Œ2:è®¾ç½®çš„å“ªä¸ªå±æ€§ï¼Œ 3:è®¾ç½®çš„æ–°çš„å€¼</span></span></span><br><span class="line"><span class="language-javascript">            <span class="title function_">set</span>(<span class="params">target,key,newValue</span>)&#123;</span></span><br><span class="line"><span class="language-javascript">                <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;set,key:&#x27;</span>, key, newValue)</span></span><br><span class="line"><span class="language-javascript">                <span class="keyword">if</span>(target[key] === newValue)&#123;</span></span><br><span class="line"><span class="language-javascript">                    <span class="keyword">return</span></span></span><br><span class="line"><span class="language-javascript">                &#125;</span></span><br><span class="line"><span class="language-javascript">                target[key] = newValue</span></span><br><span class="line"><span class="language-javascript">                <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&quot;#app&quot;</span>).<span class="property">textContent</span> = newValue</span></span><br><span class="line"><span class="language-javascript">            &#125;</span></span><br><span class="line"><span class="language-javascript">        &#125;)</span></span><br><span class="line"><span class="language-javascript">    </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="å‘å¸ƒè®¢é˜…æ¨¡å¼-amp-è§‚å¯Ÿè€…æ¨¡å¼"><a href="#å‘å¸ƒè®¢é˜…æ¨¡å¼-amp-è§‚å¯Ÿè€…æ¨¡å¼" class="headerlink" title="å‘å¸ƒè®¢é˜…æ¨¡å¼ &amp; è§‚å¯Ÿè€…æ¨¡å¼"></a>å‘å¸ƒè®¢é˜…æ¨¡å¼ &amp; è§‚å¯Ÿè€…æ¨¡å¼</h3><h4 id="å‘å¸ƒè®¢é˜…æ¨¡å¼"><a href="#å‘å¸ƒè®¢é˜…æ¨¡å¼" class="headerlink" title="å‘å¸ƒè®¢é˜…æ¨¡å¼"></a>å‘å¸ƒè®¢é˜…æ¨¡å¼</h4><p>é€šä¿—ç†è§£ï¼Œå‡è®¾å­˜åœ¨ä¸€ä¸ª<code>â€œä¿¡å·ä¸­å¿ƒâ€</code>ï¼ŒæŸä¸ªä»»åŠ¡æ‰§è¡Œå®Œæ¯•ï¼Œå°±å‘ä¿¡å·ä¸­å¿ƒ<code>â€œå‘å¸ƒâ€</code>ä¸€ä¸ªä¿¡å·ï¼Œå…¶ä»–ä»»åŠ¡å¯ä»¥å‘ä¿¡å·ä¸­å¿ƒ<code>â€œè®¢é˜…â€</code>è¿™ä¸ªä¿¡å·ï¼Œä»è€ŒçŸ¥é“ä»€ä¹ˆæ—¶å€™è‡ªå·±å¯ä»¥å¼€å§‹æ‰§è¡Œï¼Œè¿™å°±å«<code>å‘å¸ƒ/è®¢é˜…æ¨¡å¼</code>ã€‚</p>
<ul>
<li>è®¢é˜…è€…</li>
<li>å‘å¸ƒè€…</li>
<li>ä¿¡å·ä¸­å¿ƒ</li>
</ul>
<p>åœ¨Vueä¸­çš„äº‹ä»¶æœºåˆ¶å’ŒNodeä¸­çš„äº‹ä»¶å°±æ˜¯ç»™äºˆå‘å¸ƒè®¢é˜…æ¨¡å¼çš„ï¼Œä¸‹é¢å…„å¼Ÿç»„ä»¶é€šä¿¡è¿‡ç¨‹ä¸ºä¾‹ï¼š</p>
<figure class="highlight reasonml"><table><tr><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">    <span class="comment">// eventBus.js</span></span><br><span class="line">    <span class="comment">// äº‹ä»¶ä¸­å¿ƒ</span></span><br><span class="line">    <span class="keyword">let</span> eventHub = <span class="keyword">new</span> <span class="constructor">Vue()</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ç»„ä»¶ ComponentA.vue</span></span><br><span class="line">    <span class="comment">// å‘å¸ƒè€…</span></span><br><span class="line">    addTodo: <span class="keyword">function</span><span class="literal">()</span>&#123;</span><br><span class="line">        <span class="comment">// å‘å¸ƒæ¶ˆæ¯ï¼ˆäº‹ä»¶ï¼‰</span></span><br><span class="line">        eventHub.<span class="constructor">$emit(&#x27;<span class="params">add</span>-<span class="params">todo</span>&#x27;, &#123; <span class="params">text</span>: <span class="params">this</span>.<span class="params">newTodoText</span> &#125;)</span></span><br><span class="line">        this.newTodoText = &#x27;&#x27;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ç»„ä»¶ ComponentB.vue</span></span><br><span class="line">    <span class="comment">//  è®¢é˜…å·</span></span><br><span class="line">    created: <span class="keyword">function</span><span class="literal">()</span>&#123;</span><br><span class="line">        <span class="comment">// è®¢é˜…æ¶ˆæ¯ï¼ˆäº‹ä»¶ï¼‰</span></span><br><span class="line">        eventHub.<span class="constructor">$on(&#x27;<span class="params">add</span>-<span class="params">todo</span>&#x27;,<span class="params">this</span>.<span class="params">addTodo</span> )</span></span><br><span class="line">    &#125;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>
<h5 id="Vueè‡ªå®šä¹‰äº‹ä»¶çš„å®ç°"><a href="#Vueè‡ªå®šä¹‰äº‹ä»¶çš„å®ç°" class="headerlink" title="Vueè‡ªå®šä¹‰äº‹ä»¶çš„å®ç°"></a>Vueè‡ªå®šä¹‰äº‹ä»¶çš„å®ç°</h5><p>é¡µé¢ä¸­äº‹ä»¶ä½¿ç”¨å†™æ³•ï¼š</p>
<figure class="highlight awk"><table><tr><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">    <span class="regexp">//</span> vue è‡ªå®šä¹‰äº‹ä»¶</span><br><span class="line">    let vm =  new Vue()</span><br><span class="line">    <span class="regexp">//</span> vmå†…éƒ¨çš„å˜é‡æ˜¯ä¸€ä¸ªå¯¹è±¡çš„å½¢å¼ï¼Œå¯¹è±¡çš„å±æ€§æ˜¯äº‹ä»¶çš„åç§°ï¼Œå¯¹è±¡çš„å€¼æ˜¯äº‹ä»¶å¤„ç†å‡½æ•°</span><br><span class="line">    <span class="regexp">//</span> vmå†…éƒ¨ï¼š&#123;<span class="string">&#x27;click&#x27;</span>:[fn1,fn2], <span class="string">&#x27;change&#x27;</span>:[<span class="string">&#x27;fn3&#x27;</span>]&#125;</span><br><span class="line"></span><br><span class="line">    <span class="regexp">//</span> æ³¨å†Œäº‹ä»¶ï¼ˆè®¢é˜…æ¶ˆæ¯ï¼‰</span><br><span class="line">    vm.<span class="variable">$on</span>(<span class="string">&#x27;dataChange&#x27;</span>, ()=&gt;&#123;</span><br><span class="line">        console.log(<span class="string">&#x27;dataChange&#x27;</span>)</span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line">    vm.<span class="variable">$on</span>(<span class="string">&#x27;dataChange&#x27;</span>, ()=&gt;&#123;</span><br><span class="line">        console.log(<span class="string">&#x27;dataChange1&#x27;</span>)</span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line">    <span class="regexp">//</span> è§¦å‘äº‹ä»¶ï¼ˆå‘å¸ƒæ¶ˆæ¯ï¼‰</span><br><span class="line">    vm.<span class="variable">$emit</span>(<span class="string">&#x27;dataChange&#x27;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="regexp">//</span> å½“é€šè¿‡vm.<span class="variable">$emit</span>è§¦å‘äº‹ä»¶çš„æ—¶å€™ï¼Œå°±ä¼šå»å†…éƒ¨å»æ‰¾åˆ°å¯¹åº”çš„å±æ€§ï¼Œç„¶åå»æ‰§è¡Œå¯¹åº”å±æ€§åé¢çš„å‡½æ•°</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure>
<p>å®ç°æ–¹æ³•ï¼š</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="comment">// äº‹ä»¶è§¦å‘å™¨</span></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">class</span> <span class="title class_">EventEmitter</span>&#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="title function_">constructor</span>(<span class="params"></span>)&#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="comment">// &#123; &#x27;click&#x27;:[ fn1, fn2 ], &#x27;change&#x27;:[ fn ] &#125;</span></span></span><br><span class="line"><span class="language-javascript">            <span class="variable language_">this</span>.<span class="property">subs</span> = <span class="title class_">Object</span>.<span class="title function_">create</span>(<span class="literal">null</span>)</span></span><br><span class="line"><span class="language-javascript">        &#125;</span></span><br><span class="line"><span class="language-javascript">        <span class="comment">// æ³¨å†Œäº‹ä»¶  eventType:äº‹ä»¶åç§°  handler: äº‹ä»¶å‡½æ•°</span></span></span><br><span class="line"><span class="language-javascript">        $on(eventType, handler) &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="comment">// åˆ¤æ–­ä¸Šé¢çš„ &#123; &#x27;click&#x27;:[ fn1, fn2 ], &#x27;change&#x27;:[ fn ] &#125; å¯¹è±¡åˆšå¼€å§‹çš„æ—¶å€™æœ‰æ²¡æœ‰å€¼ï¼Œ</span></span></span><br><span class="line"><span class="language-javascript">            <span class="comment">// æœ‰å€¼å°±ç›´æ¥è®¾ç½®è¿›å»ï¼Œ</span></span></span><br><span class="line"><span class="language-javascript">            <span class="comment">// æ²¡æœ‰å€¼å°±è®¾ç½®æˆç©ºæ•°ç»„</span></span></span><br><span class="line"><span class="language-javascript">            <span class="variable language_">this</span>.<span class="property">subs</span>[eventType] = <span class="variable language_">this</span>.<span class="property">subs</span>[eventType] || []</span></span><br><span class="line"><span class="language-javascript">            <span class="variable language_">this</span>.<span class="property">subs</span>[eventType].<span class="title function_">push</span>(handler)</span></span><br><span class="line"><span class="language-javascript">        &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">        <span class="comment">// è§¦å‘äº‹ä»¶</span></span></span><br><span class="line"><span class="language-javascript">        $emit(eventType) &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">if</span>(<span class="variable language_">this</span>.<span class="property">subs</span>[eventType])&#123;</span></span><br><span class="line"><span class="language-javascript">                <span class="variable language_">this</span>.<span class="property">subs</span>[eventType].<span class="title function_">forEach</span>(<span class="function"><span class="params">handler</span> =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">                    <span class="title function_">handler</span>()</span></span><br><span class="line"><span class="language-javascript">                &#125;);</span></span><br><span class="line"><span class="language-javascript">            &#125;</span></span><br><span class="line"><span class="language-javascript">        &#125;</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript">    <span class="comment">// æµ‹è¯•</span></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">let</span> em = <span class="keyword">new</span> <span class="title class_">EventEmitter</span>()</span></span><br><span class="line"><span class="language-javascript">    em.$on(<span class="string">&#x27;click&#x27;</span>, <span class="function">()=&gt;</span>&#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;click1&#x27;</span>)</span></span><br><span class="line"><span class="language-javascript">    &#125;)</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    em.$on(<span class="string">&#x27;click&#x27;</span>, <span class="function">()=&gt;</span>&#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;click2&#x27;</span>)</span></span><br><span class="line"><span class="language-javascript">    &#125;)</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    em.$emit(<span class="string">&#x27;click&#x27;</span>)</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>æ‰“å¼€æµè§ˆå™¨åœ¨æ§åˆ¶å°ä¸­æŸ¥çœ‹ï¼Œæ‰“å°å‡ºäº†<code>click1</code>ã€<code>click2</code></p>
<h4 id="è§‚å¯Ÿè€…æ¨¡å¼"><a href="#è§‚å¯Ÿè€…æ¨¡å¼" class="headerlink" title="è§‚å¯Ÿè€…æ¨¡å¼"></a>è§‚å¯Ÿè€…æ¨¡å¼</h4><ul>
<li>è§‚å¯Ÿè€…æ¨¡å¼ï¼ˆè®¢é˜…è€…ï¼‰â€“Watcher<ul>
<li>update(): å½“äº‹ä»¶å‘ç”Ÿæ—¶ï¼Œå…·ä½“è¦åšçš„äº‹æƒ…</li>
</ul>
</li>
<li>ç›®æ ‡ï¼ˆå‘å¸ƒè€…ï¼‰â€“Dep<ul>
<li>subsæ•°ç»„ï¼šå­˜å‚¨æ‰€æœ‰çš„è§‚å¯Ÿè€…</li>
<li>addsub(): æ·»åŠ è§‚å¯Ÿè€…</li>
<li>notify(): å½“äº‹ä»¶å‘ç”Ÿï¼Œè°ƒç”¨æ‰€æœ‰è§‚å¯Ÿè€…çš„updateæ–¹æ³•</li>
</ul>
</li>
<li>æ²¡æœ‰äº‹ä»¶ä¸­å¿ƒ</li>
</ul>
<p>ç®€å•å®ç°ï¼š</p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="comment">// å‘å¸ƒè€…--ç›®æ ‡</span></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">class</span> <span class="title class_">Dep</span> &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="title function_">constructor</span> ()&#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="comment">// è®°å½•æ‰€æœ‰çš„è®¢é˜…ç€</span></span></span><br><span class="line"><span class="language-javascript">            <span class="variable language_">this</span>.<span class="property">subs</span> = []</span></span><br><span class="line"><span class="language-javascript">        &#125;</span></span><br><span class="line"><span class="language-javascript">        <span class="comment">// æŠŠè®¢é˜…ç€æ·»åŠ åˆ°subsæ•°ç»„é‡Œ</span></span></span><br><span class="line"><span class="language-javascript">        <span class="title function_">addSub</span>(<span class="params">sub</span>)&#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">if</span>(sub &amp;&amp; sub.<span class="property">update</span>)&#123;</span></span><br><span class="line"><span class="language-javascript">                <span class="variable language_">this</span>.<span class="property">subs</span>.<span class="title function_">push</span>(sub)</span></span><br><span class="line"><span class="language-javascript">            &#125;</span></span><br><span class="line"><span class="language-javascript">        &#125;</span></span><br><span class="line"><span class="language-javascript">        <span class="comment">// å½“äº‹ä»¶å‘ç”Ÿçš„æ—¶å€™é€šçŸ¥æ‰€æœ‰çš„è®¢é˜…è€…ï¼Œè°ƒç”¨æ‰€æœ‰çš„è®¢é˜…è€…updateæ–¹æ³•</span></span></span><br><span class="line"><span class="language-javascript">        <span class="title function_">notify</span>(<span class="params"></span>)&#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="variable language_">this</span>.<span class="property">subs</span>.<span class="title function_">forEach</span>(<span class="function"><span class="params">sub</span>=&gt;</span>&#123;</span></span><br><span class="line"><span class="language-javascript">                sub.<span class="title function_">update</span>()</span></span><br><span class="line"><span class="language-javascript">            &#125;)</span></span><br><span class="line"><span class="language-javascript">        &#125;</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript">    <span class="comment">// è®¢é˜…è€…--è§‚å¯Ÿè€…</span></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">class</span> <span class="title class_">Watcher</span>&#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="title function_">update</span>(<span class="params"></span>)&#123;</span></span><br><span class="line"><span class="language-javascript">            consolel.<span class="title function_">log</span>(<span class="string">&#x27;update&#x27;</span>)</span></span><br><span class="line"><span class="language-javascript">        &#125;</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="comment">// æµ‹è¯•</span></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">let</span> dep = <span class="keyword">new</span> <span class="title class_">Dep</span>()</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">let</span> watcher = <span class="keyword">new</span> <span class="title class_">Watcher</span>()</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="comment">// å°†è®¢é˜…è€…æ·»åŠ åˆ°å‘å¸ƒè€…ä¸­ï¼Œè®©å‘å¸ƒè€…è®°å½•ä¸‹æ¥æ‰€æœ‰çš„è§‚å¯Ÿè€…</span></span></span><br><span class="line"><span class="language-javascript">    dep.<span class="title function_">addSub</span>(watcher)</span></span><br><span class="line"><span class="language-javascript">    dep.<span class="title function_">notify</span>()</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>æ€»ç»“ï¼š</p>
<ul>
<li><code>è§‚å¯Ÿè€…æ¨¡å¼</code>æ˜¯ç”±å…·ä½“ç›®æ ‡è°ƒåº¦ï¼Œæ¯”å¦‚å½“å‰äº‹ä»¶è§¦å‘ï¼ŒDepå°±ä¼šå»è°ƒç”¨è§‚å¯Ÿè€…çš„æ–¹æ³•ï¼Œæ‰€ä»¥è§‚å¯Ÿè€…æ¨¡å¼çš„è®¢é˜…è€…ä¸å‘å¸ƒè€…ä¹‹é—´å­˜åœ¨ä¾èµ–çš„</li>
<li><code>å‘å¸ƒ/è®¢é˜…æ¨¡å¼</code>ç”±ç»Ÿä¸€è°ƒåº¦ä¸­å¿ƒè°ƒç”¨ï¼Œå› æ­¤å‘å¸ƒè€…å’Œè®¢é˜…è€…ä¸éœ€è¦çŸ¥é“å¯¹æ–¹çš„å­˜åœ¨<br><img src="/posts/e3abf81e/2.png" alt="image"></li>
</ul>
<h3 id="æ¨¡æ‹ŸVueå“åº”å¼åŸç†"><a href="#æ¨¡æ‹ŸVueå“åº”å¼åŸç†" class="headerlink" title="æ¨¡æ‹ŸVueå“åº”å¼åŸç†"></a>æ¨¡æ‹ŸVueå“åº”å¼åŸç†</h3><p>å‰é¢çš„ <code>æ•°æ®å“åº”å¼åŸç†</code>ã€<code>å‘å¸ƒ/è®¢é˜…æ¨¡å¼</code>ã€<code>è§‚å¯Ÿè€…æ¨¡å¼</code>éƒ½äº†è§£ä¹‹åï¼Œå°†å‰é¢çš„è¿™äº›æ–¹æ³•ç»“åˆèµ·æ¥ï¼Œç„¶åæ¨¡æ‹Ÿä¸€ä¸ªç®€å•çš„Vueï¼Œåœ¨å‡†å¤‡æ¨¡æ‹Ÿå¼€å‘ä¸€ä¸ªVueå‰ï¼Œé¦–é¡µè¦å¯¹vueçš„æ•´ä½“ç»“æ„æœ‰ä¸ªè®¤è¯†ï¼Œç»“æ„å¦‚ä¸‹ï¼š<br><img src="/posts/e3abf81e/3.png" alt="image"><br>ä¸»è¦å®ç° <code>Vue</code>ã€<code>Observer</code>ã€<code>Dep</code>ã€<code>Watcher</code>ã€<code>Compiler</code> äº”ç§ï¼Œæ¥ç€å…·ä½“åˆ†æ</p>
<h4 id="Vue"><a href="#Vue" class="headerlink" title="Vue"></a>Vue</h4><ul>
<li>è´Ÿè´£æ¥æ”¶åˆå§‹åŒ–çš„å‚æ•°ï¼ˆé€‰é¡¹ï¼‰ï¼ŒæŠŠdataä¸­çš„æˆå‘˜æ³¨å…¥åˆ°Vueå®ä¾‹</li>
<li>è´Ÿè´£æŠŠdataä¸­çš„å±æ€§æ³¨å…¥åˆ°Vueå®ä¾‹ï¼Œè½¬æ¢æˆgetter/setter</li>
<li>è´Ÿè´£è°ƒç”¨observerç›‘å¬dataä¸­æ‰€æœ‰å±æ€§å˜åŒ–</li>
<li>è´Ÿè´£è°ƒç”¨compilerè§£ææŒ‡ä»¤/å·®å€¼è¡¨è¾¾å¼</li>
</ul>
<p>åˆ›å»ºä¸€ä¸ª<code>minVue/index.html</code>æ–‡ä»¶</p>
<figure class="highlight handlebars"><table><tr><td class="code"><pre><span class="line"><span class="language-xml"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;UTF-8&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span> <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>mini Vue<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;app&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">h1</span>&gt;</span>å·®å€¼è¡¨è¾¾å¼<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">h3</span>&gt;</span></span><span class="template-variable">&#123;&#123; <span class="name">msg</span> &#125;&#125;</span><span class="language-xml"><span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">h3</span>&gt;</span></span><span class="template-variable">&#123;&#123; <span class="name">count</span> &#125;&#125;</span><span class="language-xml"><span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">h1</span>&gt;</span>v-text<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">v-text</span>=<span class="string">&quot;msg&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">h1</span>&gt;</span>v-model<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">v-model</span>=<span class="string">&quot;msg&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">        <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;text&quot;</span> <span class="attr">v-model</span>=<span class="string">&quot;count&quot;</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;./js/vue.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line"><span class="language-xml">    <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        <span class="keyword">let</span> vm = <span class="keyword">new</span> <span class="title class_">Vue</span>(&#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">            <span class="attr">el</span>: <span class="string">&quot;#app&quot;</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">            <span class="attr">data</span>:&#123;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">                <span class="attr">msg</span>: <span class="string">&#x27;hello&#x27;</span>,</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">                <span class="attr">count</span>: <span class="number">1000</span></span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">            &#125;</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">        &#125;)</span></span></span><br><span class="line"><span class="language-javascript"><span class="language-xml">    </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span></span><br><span class="line"><span class="language-xml"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span></span><br></pre></td></tr></table></figure>
<p>åˆ›å»ºä¸€ä¸ª<code>minVue/js/vue.js</code>æ–‡ä»¶</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Vue</span></span>&#123;</span><br><span class="line">    <span class="keyword">constructor</span>(options)&#123;</span><br><span class="line">        <span class="comment">// 1.é€šè¿‡å±æ€§ä¿å­˜é€‰é¡¹çš„æ•°æ®</span></span><br><span class="line">        <span class="keyword">this</span>.$options = options || &#123;&#125;</span><br><span class="line">        <span class="keyword">this</span>.$<span class="keyword">data</span> = options.<span class="keyword">data</span> || &#123;&#125;</span><br><span class="line">        <span class="keyword">this</span>.$el = typeof options.el === <span class="string">&#x27;string&#x27;</span>?document.querySelector(options.el):options.el </span><br><span class="line">        <span class="comment">// 2.æŠŠdataä¸­çš„æˆå‘˜è½¬æ¢æˆgetter/setterï¼Œæ³¨å…¥åˆ°vueå®ä¾‹ä¸­</span></span><br><span class="line">        <span class="keyword">this</span>._proxyData(<span class="keyword">this</span>.$<span class="keyword">data</span>)</span><br><span class="line">        <span class="comment">// 3.è°ƒç”¨Observerå¯¹è±¡ï¼Œç›‘å¬æ•°æ®å˜åŒ–</span></span><br><span class="line">        <span class="comment">// 4.è°ƒç”¨compilerå¯¹è±¡ï¼Œè§£ææŒ‡ä»¤å’Œå·®å€¼è¡¨è¾¾å¼</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// ä»£ç†æ•°æ® </span></span><br><span class="line">    _proxyData(<span class="keyword">data</span>)&#123;</span><br><span class="line">        <span class="comment">// éå†dataä¸­çš„æ‰€æœ‰å±æ€§</span></span><br><span class="line">        Object.keys(<span class="keyword">data</span>).forEach(key =&gt; &#123;</span><br><span class="line">            <span class="comment">// æ³¨æ„ï¼šè¿™é‡Œçš„thisæ˜¯ä¸Šé¢constructoré‡Œé¢è°ƒç”¨å‡½æ•°æ—¶å€™çš„thisï¼Œä¹Ÿå°±æ˜¯vueå®ä¾‹</span></span><br><span class="line">            </span><br><span class="line">            <span class="comment">// æŠŠdataçš„å±æ€§æ³¨å…¥åˆ°vueå®ä¾‹ä¸­</span></span><br><span class="line">            Object.defineProperty(<span class="keyword">this</span>, key, &#123;</span><br><span class="line">                enumerable: <span class="literal">true</span>,</span><br><span class="line">                configurable: <span class="literal">true</span>,</span><br><span class="line">                <span class="keyword">get</span>()&#123;</span><br><span class="line">                    <span class="keyword">return</span> <span class="keyword">data</span>[key]</span><br><span class="line">                &#125;,</span><br><span class="line">                <span class="keyword">set</span>(newValue)&#123;</span><br><span class="line">                    <span class="keyword">if</span>(newValue === <span class="keyword">data</span>[key])&#123;</span><br><span class="line">                        <span class="keyword">return</span></span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">data</span>[key] = newValue</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">            &#125;)</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="Observer"><a href="#Observer" class="headerlink" title="Observer"></a>Observer</h4><ul>
<li>è´Ÿè´£æŠŠdataé€‰é¡¹ä¸­çš„å±æ€§è½¬æ¢æˆå“åº”å¼æ•°æ®è¿›è¡Œç›‘å¬</li>
<li>å¦‚æœdataä¸­çš„æŸä¸ªå±æ€§æ˜¯å¯¹è±¡ï¼ŒæŠŠè¯¥å±æ€§è½¬æ¢æˆå“åº”å¼æ•°æ®</li>
<li>å¦‚æœ‰å˜åŒ–å¯æ‹¿åˆ°æœ€æ–°å€¼å¹¶é€šçŸ¥Dep</li>
</ul>
<p>åˆ›å»º<code>minVue/js/observer.js</code>æ–‡ä»¶</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Observer</span></span>&#123;</span><br><span class="line">    <span class="keyword">constructor</span>(<span class="keyword">data</span>)&#123;</span><br><span class="line">        <span class="keyword">this</span>.walk(<span class="keyword">data</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// éå†å¯¹è±¡æ‰€æœ‰å±æ€§</span></span><br><span class="line">    walk(<span class="keyword">data</span>)&#123;</span><br><span class="line">        <span class="comment">// 1.åˆ¤æ–­dataæ˜¯å¦æ˜¯å¯¹è±¡</span></span><br><span class="line">        <span class="keyword">if</span>(!<span class="keyword">data</span> || typeof <span class="keyword">data</span> !== <span class="string">&#x27;object&#x27;</span>)&#123;</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 2.éå†dataå¯¹è±¡çš„æ‰€æœ‰å±æ€§</span></span><br><span class="line">        Object.keys(<span class="keyword">data</span>).forEach(key=&gt;&#123;</span><br><span class="line">            <span class="keyword">this</span>.defineReactive(<span class="keyword">data</span>, key, <span class="keyword">data</span>[key])</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è°ƒç”¨Object.defineProperty æŠŠå±æ€§è½¬æˆgetter å’Œsetter</span></span><br><span class="line">    <span class="comment">// ä¸‰ä¸ªå‚æ•°ï¼š 1.å¯¹è±¡  2.keyå±æ€§  3.å±æ€§å¯¹åº”çš„å€¼</span></span><br><span class="line">    defineReactive(obj, key, <span class="keyword">val</span>)&#123;</span><br><span class="line">        let that = <span class="keyword">this</span></span><br><span class="line">        <span class="comment">// å¦‚æœvalæ˜¯å¯¹è±¡ï¼ŒæŠŠvalå†…éƒ¨çš„å±æ€§è½¬æ¢æˆå“åº”å¼</span></span><br><span class="line">        <span class="keyword">this</span>.walk(<span class="keyword">val</span>)</span><br><span class="line"></span><br><span class="line">        Object.defineProperty(obj, key, &#123;</span><br><span class="line">            enumerable: <span class="literal">true</span>,</span><br><span class="line">            configurable: <span class="literal">true</span>,</span><br><span class="line">            <span class="keyword">get</span>()&#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">val</span>   <span class="comment">// ä¸èƒ½ä¼ obj[key],ä¸ç„¶ä¼šå‡ºç°æ­»é€’å½’ï¼Œé€šè¿‡ä¼ ç¬¬ä¸‰ä¸ªå‚æ•°valé—­åŒ…æ¥è§£å†³</span></span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="keyword">set</span>(newValue)&#123;</span><br><span class="line">                <span class="keyword">if</span>(newValue === <span class="keyword">val</span>)&#123;</span><br><span class="line">                    <span class="keyword">return</span></span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">val</span> = newValue</span><br><span class="line">                <span class="comment">// å¦‚æœæ–°èµ‹å€¼çš„å±æ€§æ˜¯å¯¹è±¡è¿›è¡Œå“åº”å¼</span></span><br><span class="line">                that.walk(newValue)</span><br><span class="line">                </span><br><span class="line">                <span class="comment">// å‘é€é€šçŸ¥</span></span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>åœ¨<code>vue.js</code>æ–‡ä»¶ä¸­è°ƒç”¨<code>Observer</code>å¯¹è±¡ï¼Œç›‘å¬æ•°æ®å˜åŒ–</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Vue</span></span>&#123;</span><br><span class="line">    <span class="keyword">constructor</span>(options)&#123;</span><br><span class="line">        <span class="comment">// 1.é€šè¿‡å±æ€§ä¿å­˜é€‰é¡¹çš„æ•°æ®</span></span><br><span class="line">        <span class="keyword">this</span>.$options = options || &#123;&#125;</span><br><span class="line">        <span class="keyword">this</span>.$<span class="keyword">data</span> = options.<span class="keyword">data</span> || &#123;&#125;</span><br><span class="line">        <span class="keyword">this</span>.$el = typeof options.el === <span class="string">&#x27;string&#x27;</span>?document.querySelector(options.el):options.el </span><br><span class="line">        <span class="comment">// 2.æŠŠdataä¸­çš„æˆå‘˜è½¬æ¢æˆgetter/setterï¼Œæ³¨å…¥åˆ°vueå®ä¾‹ä¸­</span></span><br><span class="line">        <span class="keyword">this</span>._proxyData(<span class="keyword">this</span>.$<span class="keyword">data</span>)</span><br><span class="line">        <span class="comment">// 3.è°ƒç”¨Observerå¯¹è±¡ï¼Œç›‘å¬æ•°æ®å˜åŒ–</span></span><br><span class="line">        new Observer(<span class="keyword">this</span>.$<span class="keyword">data</span>)</span><br><span class="line">        <span class="comment">// 4.è°ƒç”¨compilerå¯¹è±¡ï¼Œè§£ææŒ‡ä»¤å’Œå·®å€¼è¡¨è¾¾å¼</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// ä»£ç†æ•°æ® </span></span><br><span class="line">    _proxyData(<span class="keyword">data</span>)&#123;</span><br><span class="line">        <span class="comment">// éå†dataä¸­çš„æ‰€æœ‰å±æ€§</span></span><br><span class="line">        Object.keys(<span class="keyword">data</span>).forEach(key =&gt; &#123;</span><br><span class="line">            <span class="comment">// æ³¨æ„ï¼šè¿™é‡Œçš„thisæ˜¯ä¸Šé¢constructoré‡Œé¢è°ƒç”¨å‡½æ•°æ—¶å€™çš„thisï¼Œä¹Ÿå°±æ˜¯vueå®ä¾‹</span></span><br><span class="line">            </span><br><span class="line">            <span class="comment">// æŠŠdataçš„å±æ€§æ³¨å…¥åˆ°vueå®ä¾‹ä¸­</span></span><br><span class="line">            Object.defineProperty(<span class="keyword">this</span>, key, &#123;</span><br><span class="line">                enumerable: <span class="literal">true</span>,</span><br><span class="line">                configurable: <span class="literal">true</span>,</span><br><span class="line">                <span class="keyword">get</span>()&#123;</span><br><span class="line">                    <span class="keyword">return</span> <span class="keyword">data</span>[key]</span><br><span class="line">                &#125;,</span><br><span class="line">                <span class="keyword">set</span>(newValue)&#123;</span><br><span class="line">                    <span class="keyword">if</span>(newValue === <span class="keyword">data</span>[key])&#123;</span><br><span class="line">                        <span class="keyword">return</span></span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">data</span>[key] = newValue</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">            &#125;)</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="Compiler"><a href="#Compiler" class="headerlink" title="Compiler"></a>Compiler</h4><ul>
<li>è´Ÿè´£ç¼–è¯‘æ¨¡ç‰ˆï¼Œè§£ææŒ‡ä»¤/å·®å€¼è¡¨è¾¾å¼</li>
<li>è´Ÿè´£é¡µé¢çš„é¦–æ¬¡æ¸²æŸ“</li>
<li>å½“æ•°æ®å˜åŒ–åé‡æ–°æ¸²æŸ“è¯•å›¾</li>
</ul>
<p>åˆ›å»ºä¸€ä¸ª<code>minVue/js/compiler.js</code>æ–‡ä»¶</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Compiler</span>&#123;</span><br><span class="line">    <span class="title function_">constructor</span>(<span class="params">vm</span>)&#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">el</span> = vm.<span class="property">$el</span></span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">vm</span> = vm</span><br><span class="line">        <span class="variable language_">this</span>.<span class="title function_">compile</span>(<span class="variable language_">this</span>.<span class="property">el</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// ç¼–è¯‘æ¨¡ç‰ˆï¼Œå¤„ç†æ–‡æœ¬èŠ‚ç‚¹å’Œå…ƒç´ èŠ‚ç‚¹</span></span><br><span class="line">    <span class="title function_">compile</span>(<span class="params">el</span>)&#123;</span><br><span class="line">        <span class="keyword">let</span> childNodes = el.<span class="property">childNodes</span></span><br><span class="line">        <span class="title class_">Array</span>.<span class="title function_">from</span>(childNodes).<span class="title function_">forEach</span>(<span class="function"><span class="params">node</span>=&gt;</span>&#123;</span><br><span class="line">            <span class="comment">// å¤„ç†æ–‡æœ¬èŠ‚ç‚¹</span></span><br><span class="line">            <span class="keyword">if</span>(<span class="variable language_">this</span>.<span class="title function_">isTextNode</span>(node))&#123;</span><br><span class="line">                <span class="variable language_">this</span>.<span class="title function_">compileText</span>(node)</span><br><span class="line">            &#125;<span class="keyword">else</span> <span class="keyword">if</span>(<span class="variable language_">this</span>.<span class="title function_">isElementNode</span>(node))&#123;</span><br><span class="line">                <span class="comment">// å¤„ç†å…ƒç´ èŠ‚ç‚¹</span></span><br><span class="line">                <span class="variable language_">this</span>.<span class="title function_">compileElement</span>(node)</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// åˆ¤æ–­nodeèŠ‚ç‚¹ï¼Œæ˜¯å¦æ˜¯å­èŠ‚ç‚¹ï¼Œå¦‚æœæœ‰å­èŠ‚ç‚¹ï¼Œè¦é€’å½’è°ƒç”¨compile</span></span><br><span class="line">            <span class="keyword">if</span>(node.<span class="property">childNodes</span> &amp;&amp; node.<span class="property">childNodes</span>.<span class="property">length</span>)&#123;</span><br><span class="line">                <span class="variable language_">this</span>.<span class="title function_">compile</span>(node)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// ç¼–è¯‘å…ƒç´ èŠ‚ç‚¹ï¼Œå¤„ç†æŒ‡ä»¤</span></span><br><span class="line">    <span class="title function_">compileElement</span>(<span class="params">node</span>)&#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(node.<span class="property">attributes</span>)</span><br><span class="line">        <span class="comment">// éå†æ‰€æœ‰çš„å±æ€§èŠ‚ç‚¹</span></span><br><span class="line">        <span class="title class_">Array</span>.<span class="title function_">from</span>(node.<span class="property">attributes</span>).<span class="title function_">forEach</span>(<span class="function"><span class="params">attr</span>=&gt;</span>&#123;</span><br><span class="line">            <span class="comment">// åˆ¤æ–­æ˜¯å¦æ˜¯æŒ‡ä»¤</span></span><br><span class="line">            <span class="keyword">let</span> attrName = attr.<span class="property">name</span></span><br><span class="line">            <span class="keyword">if</span>(<span class="variable language_">this</span>.<span class="title function_">isDirective</span>(attrName))&#123;  <span class="comment">// åˆ¤æ–­å±æ€§æ˜¯å¦æ˜¯æŒ‡ä»¤ï¼ˆ ä»¥ v- å¼€å¤´ ï¼‰</span></span><br><span class="line">                <span class="comment">// v-text --&gt;  text</span></span><br><span class="line">                attrName = attrName.<span class="title function_">substr</span>(<span class="number">2</span>)</span><br><span class="line">                <span class="keyword">let</span> key = attr.<span class="property">value</span></span><br><span class="line">                <span class="variable language_">this</span>.<span class="title function_">update</span>(node, key, attrName)  <span class="comment">// åˆ¤æ–­ä»€ä¹ˆæ ·çš„æŒ‡ä»¤ï¼Œå¯¹åº”çš„å¤„ç†æ–¹æ³•</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="title function_">update</span>(<span class="params">node, key, attrName</span>)&#123;</span><br><span class="line">        <span class="keyword">let</span> updateFn = <span class="variable language_">this</span>[attrName + <span class="string">&#x27;Updater&#x27;</span>]  <span class="comment">// ç”¨äºåˆ¤æ–­ä½¿ç”¨å“ªä¸€ä¸ªå¤„ç†æŒ‡ä»¤çš„å‡½æ•°</span></span><br><span class="line">        updateFn &amp;&amp; <span class="title function_">updateFn</span>(node, <span class="variable language_">this</span>.<span class="property">vm</span>[key])   <span class="comment">// å¯¹åº”çš„å¤„ç†æ–¹æ³•</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å¤„ç† v-text æŒ‡ä»¤</span></span><br><span class="line">    <span class="title function_">textUpdater</span>(<span class="params">node, value</span>)&#123;</span><br><span class="line">        node.<span class="property">textContent</span> = value</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å¤„ç†v-modelæŒ‡ä»¤</span></span><br><span class="line">    <span class="title function_">modelUpdater</span>(<span class="params">node, value</span>)&#123;</span><br><span class="line">        node.<span class="property">value</span> = value</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ç¼–è¯‘æ–‡æœ¬èŠ‚ç‚¹ï¼Œå¤„ç†å·®å€¼è¡¨è¾¾å¼</span></span><br><span class="line">    <span class="title function_">compileText</span>(<span class="params">node</span>)&#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">dir</span>(node)  <span class="comment">// ä»¥å¯¹è±¡å½¢å¼æ‰“å°</span></span><br><span class="line">        <span class="comment">// &#123;&#123; msg &#125;&#125;  å»æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…å·®å€¼è¡¨è¾¾å¼</span></span><br><span class="line">        <span class="keyword">let</span> reg = <span class="regexp">/\&#123;\&#123;(.+?)\&#125;\&#125;/</span></span><br><span class="line">        <span class="comment">// è·å–æ–‡æœ¬å†…å®¹</span></span><br><span class="line">        <span class="keyword">let</span> value = node.<span class="property">textContent</span></span><br><span class="line">        <span class="keyword">if</span>(reg.<span class="title function_">test</span>(value))&#123;</span><br><span class="line">            <span class="keyword">let</span> key = <span class="title class_">RegExp</span>.<span class="property">$1</span>.<span class="title function_">trim</span>()   <span class="comment">// è·å–åˆ°çš„æ˜¯æ­£åˆ™ä¸­ (.+?) åŒ¹é…åˆ°å€¼ï¼Œå»é™¤ç©ºæ ¼</span></span><br><span class="line">            node.<span class="property">textContent</span> = value.<span class="title function_">replace</span>(reg, <span class="variable language_">this</span>.<span class="property">vm</span>[key])   <span class="comment">// æ–‡æœ¬èŠ‚ç‚¹ä¸­çš„æ’å€¼è¡¨è¾¾å¼æ›¿æ¢ï¼ˆæ›¿æ¢èŠ±æ‹¬å·ä¸­å€¼ï¼‰ </span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// åˆ¤æ–­å…ƒç´ å±æ€§æ˜¯å¦æ˜¯æŒ‡ä»¤</span></span><br><span class="line">    <span class="title function_">isDirective</span>(<span class="params">attrName</span>)&#123;</span><br><span class="line">        <span class="keyword">return</span> attrName.<span class="title function_">startsWith</span>(<span class="string">&#x27;v-&#x27;</span>)  </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// åˆ¤æ–­èŠ‚ç‚¹æ˜¯å¦æ˜¯æ–‡æœ¬èŠ‚ç‚¹</span></span><br><span class="line">    <span class="title function_">isTextNode</span>(<span class="params">node</span>)&#123;</span><br><span class="line">        <span class="keyword">return</span> node.<span class="property">nodeType</span> === <span class="number">3</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// åˆ¤æ–­èŠ‚ç‚¹æ˜¯å¦æ˜¯å…ƒç´ èŠ‚ç‚¹</span></span><br><span class="line">    <span class="title function_">isElementNode</span>(<span class="params">node</span>)&#123;</span><br><span class="line">        <span class="keyword">return</span> node.<span class="property">nodeType</span> === <span class="number">1</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>åœ¨<code>vue.js</code>æ–‡ä»¶ä¸­ï¼Œç¬¬å››æ­¥éœ€è¦è°ƒç”¨<code>compiler</code>å¯¹è±¡ï¼Œè§£ææŒ‡ä»¤å’Œå·®å€¼è¡¨è¾¾å¼</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Vue</span></span>&#123;</span><br><span class="line">    <span class="keyword">constructor</span>(options)&#123;</span><br><span class="line">        <span class="comment">// 1.é€šè¿‡å±æ€§ä¿å­˜é€‰é¡¹çš„æ•°æ®</span></span><br><span class="line">        <span class="keyword">this</span>.$options = options || &#123;&#125;</span><br><span class="line">        <span class="keyword">this</span>.$<span class="keyword">data</span> = options.<span class="keyword">data</span> || &#123;&#125;</span><br><span class="line">        <span class="keyword">this</span>.$el = typeof options.el === <span class="string">&#x27;string&#x27;</span>?document.querySelector(options.el):options.el </span><br><span class="line">        <span class="comment">// 2.æŠŠdataä¸­çš„æˆå‘˜è½¬æ¢æˆgetter/setterï¼Œæ³¨å…¥åˆ°vueå®ä¾‹ä¸­</span></span><br><span class="line">        <span class="keyword">this</span>._proxyData(<span class="keyword">this</span>.$<span class="keyword">data</span>)</span><br><span class="line">        <span class="comment">// 3.è°ƒç”¨Observerå¯¹è±¡ï¼Œç›‘å¬æ•°æ®å˜åŒ–</span></span><br><span class="line">        new Observer(<span class="keyword">this</span>.$<span class="keyword">data</span>)</span><br><span class="line">        <span class="comment">// 4.è°ƒç”¨compilerå¯¹è±¡ï¼Œè§£ææŒ‡ä»¤å’Œå·®å€¼è¡¨è¾¾å¼</span></span><br><span class="line">        new Compiler(<span class="keyword">this</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// ä»£ç†æ•°æ® </span></span><br><span class="line">    _proxyData(<span class="keyword">data</span>)&#123;</span><br><span class="line">        <span class="comment">// éå†dataä¸­çš„æ‰€æœ‰å±æ€§</span></span><br><span class="line">        Object.keys(<span class="keyword">data</span>).forEach(key =&gt; &#123;</span><br><span class="line">            <span class="comment">// æ³¨æ„ï¼šè¿™é‡Œçš„thisæ˜¯ä¸Šé¢constructoré‡Œé¢è°ƒç”¨å‡½æ•°æ—¶å€™çš„thisï¼Œä¹Ÿå°±æ˜¯vueå®ä¾‹</span></span><br><span class="line">            </span><br><span class="line">            <span class="comment">// æŠŠdataçš„å±æ€§æ³¨å…¥åˆ°vueå®ä¾‹ä¸­</span></span><br><span class="line">            Object.defineProperty(<span class="keyword">this</span>, key, &#123;</span><br><span class="line">                enumerable: <span class="literal">true</span>,</span><br><span class="line">                configurable: <span class="literal">true</span>,</span><br><span class="line">                <span class="keyword">get</span>()&#123;</span><br><span class="line">                    <span class="keyword">return</span> <span class="keyword">data</span>[key]</span><br><span class="line">                &#125;,</span><br><span class="line">                <span class="keyword">set</span>(newValue)&#123;</span><br><span class="line">                    <span class="keyword">if</span>(newValue === <span class="keyword">data</span>[key])&#123;</span><br><span class="line">                        <span class="keyword">return</span></span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">data</span>[key] = newValue</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;)</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="Depï¼ˆDependencyï¼‰"><a href="#Depï¼ˆDependencyï¼‰" class="headerlink" title="Depï¼ˆDependencyï¼‰"></a>Depï¼ˆDependencyï¼‰</h4><ul>
<li>æ”¶é›†ä¾èµ–ï¼Œæ·»åŠ è§‚å¯Ÿè€…ï¼ˆwatcherï¼‰</li>
<li>é€šçŸ¥æ‰€æœ‰è§‚å¯Ÿè€…<br><img src="/posts/e3abf81e/5.png" alt="image"><br>å»º<code>minVue/js/dep.js</code>æ–‡ä»¶<figure class="highlight perl"><table><tr><td class="code"><pre><span class="line">class Dep &#123;</span><br><span class="line">    constructor () &#123;</span><br><span class="line">        <span class="regexp">//</span> å­˜å‚¨æ‰€æœ‰çš„è§‚å¯Ÿè€…</span><br><span class="line">        this.subs = []</span><br><span class="line">    &#125;</span><br><span class="line">    // æ·»åŠ è§‚å¯Ÿè€…</span><br><span class="line">    addSub(<span class="function"><span class="keyword">sub</span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="function"><span class="keyword">sub</span> &amp;&amp; <span class="title">sub</span>.<span class="title">update</span>)</span>&#123;</span><br><span class="line">            this.subs.push(<span class="function"><span class="keyword">sub</span>) </span></span><br><span class="line"><span class="function">        &#125;</span></span><br><span class="line"><span class="function">    &#125;</span></span><br><span class="line"><span class="function">    // å‘é€é€šçŸ¥</span></span><br><span class="line"><span class="function">    <span class="title">notify</span></span>()&#123;</span><br><span class="line">        this.subs.forEach(<span class="string">sub=&gt;</span>&#123;</span><br><span class="line">            sub.update()</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
ç„¶ååœ¨<code>js/observer.js</code>ä¸­æ”¶é›†ä¾èµ–ï¼Œå‘é€é€šçŸ¥<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Observer</span></span>&#123;</span><br><span class="line">    <span class="keyword">constructor</span>(<span class="keyword">data</span>)&#123;</span><br><span class="line">        <span class="keyword">this</span>.walk(<span class="keyword">data</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// éå†å¯¹è±¡æ‰€æœ‰å±æ€§</span></span><br><span class="line">    walk(<span class="keyword">data</span>)&#123;</span><br><span class="line">        <span class="comment">// 1.åˆ¤æ–­dataæ˜¯å¦æ˜¯å¯¹è±¡</span></span><br><span class="line">        <span class="keyword">if</span>(!<span class="keyword">data</span> || typeof <span class="keyword">data</span> !== <span class="string">&#x27;object&#x27;</span>)&#123;</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 2.éå†dataå¯¹è±¡çš„æ‰€æœ‰å±æ€§</span></span><br><span class="line">        Object.keys(<span class="keyword">data</span>).forEach(key=&gt;&#123;</span><br><span class="line">            <span class="keyword">this</span>.defineReactive(<span class="keyword">data</span>, key, <span class="keyword">data</span>[key])</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è°ƒç”¨Object.defineProperty æŠŠå±æ€§è½¬æˆgetter å’Œsetter</span></span><br><span class="line">    <span class="comment">// ä¸‰ä¸ªå‚æ•°ï¼š 1.å¯¹è±¡  2.keyå±æ€§  3.å±æ€§å¯¹åº”çš„å€¼</span></span><br><span class="line">    defineReactive(obj, key, <span class="keyword">val</span>)&#123;</span><br><span class="line">        let that = <span class="keyword">this</span></span><br><span class="line">        <span class="comment">// è´Ÿè´£æ”¶é›†ä¾èµ–ï¼Œå¹¶å‘é€é€šçŸ¥</span></span><br><span class="line">        let dep = new Dep()</span><br><span class="line"></span><br><span class="line">        <span class="comment">// å¦‚æœvalæ˜¯å¯¹è±¡ï¼ŒæŠŠvalå†…éƒ¨çš„å±æ€§è½¬æ¢æˆå“åº”å¼</span></span><br><span class="line">        <span class="keyword">this</span>.walk(<span class="keyword">val</span>)</span><br><span class="line"></span><br><span class="line">        Object.defineProperty(obj, key, &#123;</span><br><span class="line">            enumerable: <span class="literal">true</span>,</span><br><span class="line">            configurable: <span class="literal">true</span>,</span><br><span class="line">            <span class="keyword">get</span>()&#123;</span><br><span class="line">                <span class="comment">// æ”¶é›†ä¾èµ–</span></span><br><span class="line">                Dep.target &amp;&amp; dep.addSub(Dep.target)</span><br><span class="line">                </span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">val</span>   <span class="comment">// ä¸èƒ½ä¼ obj[key],ä¸ç„¶ä¼šå‡ºç°æ­»é€’å½’ï¼Œé€šè¿‡ä¼ ç¬¬ä¸‰ä¸ªå‚æ•°valé—­åŒ…æ¥è§£å†³</span></span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="keyword">set</span>(newValue)&#123;</span><br><span class="line">                <span class="keyword">if</span>(newValue === <span class="keyword">val</span>)&#123;</span><br><span class="line">                    <span class="keyword">return</span></span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">val</span> = newValue</span><br><span class="line">                <span class="comment">// å¦‚æœæ–°èµ‹å€¼çš„å±æ€§æ˜¯å¯¹è±¡è¿›è¡Œå“åº”å¼</span></span><br><span class="line">                that.walk(newValue)</span><br><span class="line"></span><br><span class="line">                <span class="comment">// å‘é€é€šçŸ¥</span></span><br><span class="line">                dep.notify()</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="Watcher"><a href="#Watcher" class="headerlink" title="Watcher"></a>Watcher</h4></li>
<li>å½“æ•°æ®å˜åŒ–å‡ºå‘ä¾èµ–ï¼Œdepé€šçŸ¥æ‰€æœ‰çš„Watcherå®ä¾‹æ›´æ–°è§†å›¾</li>
<li>è‡ªèº«å®ä¾‹åŒ–çš„æ—¶å€™å¾€depå¯¹è±¡ä¸­æ·»åŠ è‡ªå·±<br><img src="/posts/e3abf81e/4.png" alt="image"></li>
</ul>
<p>å»º<code>js/watcher.js</code>æ–‡ä»¶</p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Watcher</span></span>&#123;</span><br><span class="line">    <span class="keyword">constructor</span>(vm, key, cb )&#123;</span><br><span class="line">        <span class="keyword">this</span>.vm = vm </span><br><span class="line">        <span class="comment">// dataä¸­çš„å±æ€§åç§°</span></span><br><span class="line">        <span class="keyword">this</span>.key = key </span><br><span class="line">        <span class="comment">// å›è°ƒå‡½æ•°è´Ÿè´£æ›´æ–°è§†å›¾</span></span><br><span class="line">        <span class="keyword">this</span>.cb = cb</span><br><span class="line"></span><br><span class="line">        <span class="comment">// æŠŠwatcherå¯¹è±¡è®°å½•åˆ°Depç±»çš„é™æ€å±æ€§target</span></span><br><span class="line">        Dep.target = <span class="keyword">this</span></span><br><span class="line">        <span class="comment">// è§¦å‘getæ–¹æ³•ï¼Œåœ¨getæ–¹æ³•ä¸­ä¼šè°ƒç”¨addSub</span></span><br><span class="line">        <span class="keyword">this</span>.oldValue = vm[key]</span><br><span class="line"></span><br><span class="line">        Dep.target = <span class="literal">null</span>  <span class="comment">// æ·»åŠ è¿‡å è®¾ç½®ä¸ºç©ºï¼Œé˜²æ­¢é‡å¤æ·»åŠ </span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// å½“æ•°æ®å‘ç”Ÿå˜åŒ–çš„æ—¶å€™æ›´æ–°è§†å›¾</span></span><br><span class="line">    update()&#123;</span><br><span class="line">        let newValue = <span class="keyword">this</span>.vm[<span class="keyword">this</span>.key]</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">this</span>.oldValue === newValue )&#123;</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">this</span>.cb(newValue)  <span class="comment">// æ›´æ–°è§†å›¾</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><code>oberser.js</code>æ–‡ä»¶ä¸­æ·»åŠ æ”¶é›†ä¾èµ–ï¼Œ<code>Dep.target &amp;&amp; dep.addSub(Dep.target)</code></p>
<figure class="highlight kotlin"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Observer</span></span>&#123;</span><br><span class="line">    <span class="keyword">constructor</span>(<span class="keyword">data</span>)&#123;</span><br><span class="line">        <span class="keyword">this</span>.walk(<span class="keyword">data</span>)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// éå†å¯¹è±¡æ‰€æœ‰å±æ€§</span></span><br><span class="line">    walk(<span class="keyword">data</span>)&#123;</span><br><span class="line">        <span class="comment">// 1.åˆ¤æ–­dataæ˜¯å¦æ˜¯å¯¹è±¡</span></span><br><span class="line">        <span class="keyword">if</span>(!<span class="keyword">data</span> || typeof <span class="keyword">data</span> !== <span class="string">&#x27;object&#x27;</span>)&#123;</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 2.éå†dataå¯¹è±¡çš„æ‰€æœ‰å±æ€§</span></span><br><span class="line">        Object.keys(<span class="keyword">data</span>).forEach(key=&gt;&#123;</span><br><span class="line">            <span class="keyword">this</span>.defineReactive(<span class="keyword">data</span>, key, <span class="keyword">data</span>[key])</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// è°ƒç”¨Object.defineProperty æŠŠå±æ€§è½¬æˆgetter å’Œsetter</span></span><br><span class="line">    <span class="comment">// ä¸‰ä¸ªå‚æ•°ï¼š 1.å¯¹è±¡  2.keyå±æ€§  3.å±æ€§å¯¹åº”çš„å€¼</span></span><br><span class="line">    defineReactive(obj, key, <span class="keyword">val</span>)&#123;</span><br><span class="line">        let that = <span class="keyword">this</span></span><br><span class="line">        <span class="comment">// è´Ÿè´£æ”¶é›†ä¾èµ–ï¼Œå¹¶å‘é€é€šçŸ¥</span></span><br><span class="line">        let dep = new Dep()</span><br><span class="line"></span><br><span class="line">        <span class="comment">// å¦‚æœvalæ˜¯å¯¹è±¡ï¼ŒæŠŠvalå†…éƒ¨çš„å±æ€§è½¬æ¢æˆå“åº”å¼</span></span><br><span class="line">        <span class="keyword">this</span>.walk(<span class="keyword">val</span>)</span><br><span class="line"></span><br><span class="line">        Object.defineProperty(obj, key, &#123;</span><br><span class="line">            enumerable: <span class="literal">true</span>,</span><br><span class="line">            configurable: <span class="literal">true</span>,</span><br><span class="line">            <span class="keyword">get</span>()&#123;</span><br><span class="line">                <span class="comment">// æ”¶é›†ä¾èµ–</span></span><br><span class="line">                Dep.target &amp;&amp; dep.addSub(Dep.target)   <span class="comment">// Dep.target ä¹Ÿå°±æ˜¯watcherå¯¹è±¡</span></span><br><span class="line"></span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">val</span>   <span class="comment">// ä¸èƒ½ä¼ obj[key],ä¸ç„¶ä¼šå‡ºç°æ­»é€’å½’ï¼Œé€šè¿‡ä¼ ç¬¬ä¸‰ä¸ªå‚æ•°valé—­åŒ…æ¥è§£å†³</span></span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="keyword">set</span>(newValue)&#123;</span><br><span class="line">                <span class="keyword">if</span>(newValue === <span class="keyword">val</span>)&#123;</span><br><span class="line">                    <span class="keyword">return</span></span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">val</span> = newValue</span><br><span class="line">                <span class="comment">// å¦‚æœæ–°èµ‹å€¼çš„å±æ€§æ˜¯å¯¹è±¡è¿›è¡Œå“åº”å¼</span></span><br><span class="line">                that.walk(newValue)</span><br><span class="line"></span><br><span class="line">                <span class="comment">// å‘é€é€šçŸ¥</span></span><br><span class="line">                dep.notify()</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å›åˆ°<code>Oberver.js</code>ä¸­ï¼Œåˆ›å»ºæ’å€¼è¡¨è¾¾å¼æ—¶å€™åˆ›å»º<code>watcherå¯¹è±¡</code>ï¼Œå½“æ•°æ®æ”¹å˜æ›´æ–°è§†å›¾</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// ç¼–è¯‘æ–‡æœ¬èŠ‚ç‚¹ï¼Œå¤„ç†å·®å€¼è¡¨è¾¾å¼</span></span><br><span class="line"><span class="title function_">compileText</span>(<span class="params">node</span>)&#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">dir</span>(node)  <span class="comment">// ä»¥å¯¹è±¡å½¢å¼æ‰“å°</span></span><br><span class="line">    <span class="comment">// &#123;&#123; msg &#125;&#125;  å»æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…å·®å€¼è¡¨è¾¾å¼</span></span><br><span class="line">    <span class="keyword">let</span> reg = <span class="regexp">/\&#123;\&#123;(.+?)\&#125;\&#125;/</span></span><br><span class="line">    <span class="comment">// è·å–æ–‡æœ¬å†…å®¹</span></span><br><span class="line">    <span class="keyword">let</span> value = node.<span class="property">textContent</span></span><br><span class="line">    <span class="keyword">if</span>(reg.<span class="title function_">test</span>(value))&#123;</span><br><span class="line">        <span class="keyword">let</span> key = <span class="title class_">RegExp</span>.<span class="property">$1</span>.<span class="title function_">trim</span>()   <span class="comment">// è·å–åˆ°çš„æ˜¯æ­£åˆ™ä¸­ (.+?) åŒ¹é…åˆ°å€¼ï¼Œå»é™¤ç©ºæ ¼</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment">// æ–‡æœ¬èŠ‚ç‚¹ä¸­çš„æ’å€¼è¡¨è¾¾å¼æ›¿æ¢ï¼ˆæ›¿æ¢èŠ±æ‹¬å·ä¸­å€¼ï¼‰ </span></span><br><span class="line">        node.<span class="property">textContent</span> = value.<span class="title function_">replace</span>(reg, <span class="variable language_">this</span>.<span class="property">vm</span>[key])   </span><br><span class="line">        </span><br><span class="line">        <span class="comment">// åˆ›å»ºwatcherå¯¹è±¡ï¼Œå½“æ•°æ®æ”¹å˜æ›´æ–°è§†å›¾</span></span><br><span class="line">        <span class="keyword">new</span> <span class="title class_">Watcher</span>(<span class="variable language_">this</span>.<span class="property">vm</span>, key, <span class="function">(<span class="params">newValue</span>)=&gt;</span>&#123;</span><br><span class="line">            node.<span class="property">textContent</span> = newValue</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>åœ¨å¤„ç†æŒ‡ä»¤çš„æ–¹æ³•<code>compiler.js</code>æ–‡ä»¶ä¸­åˆ›å»º<code>watcherå¯¹è±¡</code></p>
<figure class="highlight stylus"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="title">update</span><span class="params">(node, key, attrName)</span></span>&#123;</span><br><span class="line">    let updateFn = this<span class="selector-attr">[attrName + <span class="string">&#x27;Updater&#x27;</span>]</span>  <span class="comment">// ç”¨äºåˆ¤æ–­ä½¿ç”¨å“ªä¸€ä¸ªå¤„ç†æŒ‡ä»¤çš„å‡½æ•°</span></span><br><span class="line">    <span class="comment">// updateFn &amp;&amp; updateFn(node, this.vm[key])   // å¯¹åº”çš„å¤„ç†æ–¹æ³•</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// è¿™é‡Œçš„å†™æ³•æ˜¯é’ˆå¯¹watcherè°ƒç”¨æ—¶å€™è·å–compilerçš„thisè¿˜æœ‰keyåšçš„æ”¹å†™</span></span><br><span class="line">    updateFn &amp;&amp; updateFn<span class="selector-class">.call</span>(this, node, this<span class="selector-class">.vm</span><span class="selector-attr">[key]</span>, key)   </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å¤„ç† v-text æŒ‡ä»¤</span></span><br><span class="line"><span class="function"><span class="title">textUpdater</span><span class="params">(node, value, key)</span></span>&#123;</span><br><span class="line">    node<span class="selector-class">.textContent</span> = value</span><br><span class="line">    <span class="comment">// åˆ›å»ºwatcherå¯¹è±¡ï¼Œå½“æ•°æ®æ”¹å˜æ›´æ–°è§†å›¾</span></span><br><span class="line">    new <span class="built_in">Watcher</span>(this<span class="selector-class">.vm</span>, key, (newValue)=&gt;&#123;</span><br><span class="line">        node<span class="selector-class">.textContent</span> = newValue</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// å¤„ç†v-modelæŒ‡ä»¤</span></span><br><span class="line"><span class="function"><span class="title">modelUpdater</span><span class="params">(node, value, key)</span></span>&#123;</span><br><span class="line">    node<span class="selector-class">.value</span> = value</span><br><span class="line">    <span class="comment">// åˆ›å»ºwatcherå¯¹è±¡ï¼Œå½“æ•°æ®æ”¹å˜æ›´æ–°è§†å›¾</span></span><br><span class="line">    new <span class="built_in">Watcher</span>(this<span class="selector-class">.vm</span>, key, (newValue)=&gt;&#123;</span><br><span class="line">        node<span class="selector-class">.value</span> = newValue</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="æ€»ç»“ï¼š"><a href="#æ€»ç»“ï¼š" class="headerlink" title="æ€»ç»“ï¼š"></a>æ€»ç»“ï¼š</h4><ul>
<li><p>æ•´ä½“ä¸€ä¸ªæµç¨‹å›¾ï¼š<br><img src="/posts/e3abf81e/liuchen.png" alt="mvvmå“åº”å¼åŸç†"></p>
</li>
<li><p>Vueæ„é€ å‡½æ•°ä¸­åšäº†å“ªäº›äº‹æƒ…ï¼š<br>é¦–å…ˆè®°å½•ä¸‹æ¥optionsä¼ è¿‡æ¥çš„é€‰é¡¹ï¼Œæ¥ç€è°ƒç”¨_proxyDataæŠŠdataä¸­çš„å±æ€§æ³¨å…¥åˆ°Vueå®ä¾‹ä¸­ï¼Œæ¥ç€å¼€å§‹åˆ›å»ºObserverå’ŒCompilerï¼ŒObserverä½œç”¨æ˜¯æ•°æ®åŠ«æŒï¼Œåœ¨Observeré‡Œé¢ï¼ŒæŠŠdataé‡Œé¢çš„å±æ€§è½¬æ¢æˆgetterå’Œsetterï¼Œå½“æ•°æ®å˜åŒ–çš„æ—¶å€™ï¼Œä¹Ÿå°±æ˜¯è§¦å‘setteræ–¹æ³•çš„æ—¶å€™ï¼Œé€šçŸ¥å˜åŒ–ï¼Œå‘Šè¯‰Depæ•°æ®å˜åŒ–äº†ï¼Œè¦è°ƒç”¨notifyæ–¹æ³•ï¼Œnotifyæ–¹æ³•ä¸­è¦è°ƒç”¨watcherçš„updateï¼Œwatcherçš„updateæ–¹æ³•ä¸­å°±ä¼šå»æ›´æ–°è§†å›¾ï¼Œè¿™æ˜¯æ•°æ®å˜åŒ–çš„æ—¶å€™æ›´æ–°è§†å›¾ï¼Œå½“åˆ›å»ºwatcherå¯¹è±¡çš„æ—¶å€™ï¼Œä¼šå°†å½“å‰çš„watcherå¯¹è±¡æ·»åŠ åˆ°Depçš„Subsæ•°ç»„ä¸­ï¼Œä¹Ÿå°±æ˜¯æ”¶é›†ä¾èµ–ï¼Œä¹Ÿæ”¶é›†Depä¾èµ–çš„è¿™äº›watcherï¼Œè®©Depå°†è¿™äº›ä¾èµ–è®°å½•ä¸‹æ¥ï¼ŒObserveråˆ›å»ºå®Œä¹‹åï¼Œæ¥ä¸‹æ¥åˆ›å»ºCompilerå¯¹è±¡ï¼ŒCompilerå¯¹è±¡ä½œç”¨æ˜¯è§£ææŒ‡ä»¤ï¼Œè§£ææ’å€¼è¡¨è¾¾å¼ï¼Œé¡µé¢é¦–æ¬¡åŠ è½½çš„æ—¶å€™ï¼Œä¼šè°ƒç”¨Compileré‡Œé¢çš„ç›¸å…³æ–¹æ³•å»æ›´æ–°è¯•è§†å›¾ï¼ŒåŒæ—¶ï¼Œåœ¨Compileré‡Œé¢è¿˜è¦å»è®¢é˜…æ•°æ®çš„å˜åŒ–ç»‘å®šæ›´æ–°å‡½æ•°ï¼ˆè®¢é˜…æ•°æ®çš„å˜åŒ–ï¼šæ„æ€æ˜¯åœ¨Compilerå¤„ç†æ’å€¼è¡¨è¾¾å¼çš„æ–¹æ³•å’Œå¤„ç†æŒ‡ä»¤çš„æ–¹æ³•ä¸­ï¼Œé™¤äº†æ›´æ–°è§†å›¾ä»¥å¤–ï¼Œè¿˜è¦å»åˆ›å»ºä¸€ä¸ªwatcherå¯¹è±¡ï¼Œä¹Ÿå°±æ˜¯è®¢é˜…æ•°æ®çš„å˜åŒ–ï¼Œå½“æ•°æ®å˜åŒ–çš„æ—¶å€™ï¼ŒDepä¼šé€šçŸ¥watcherï¼Œç»‘å®šæ›´æ–°å‡½æ•°ï¼šå½“æˆ‘ä»¬åˆ›å»ºä¸€ä¸ªwatcherå¯¹è±¡çš„æ—¶å€™ï¼Œè¦ä¼ é€’ä¸€ä¸ªå›è°ƒå‡½æ•°ï¼Œåœ¨è¿™ä¸ªå›è°ƒå‡½æ•°ä¸­å»æ›´æ–°è§†å›¾ï¼Œå½“é¡µé¢é¦–æ¬¡åŠ è½½çš„æ—¶å€™ï¼Œæ˜¯é€šè¿‡Compilerå»æ›´æ–°è§†å›¾ï¼Œå½“æ•°æ®å˜åŒ–çš„æ—¶å€™æ˜¯é€šè¿‡watcherå»æ›´æ–°è§†å›¾ï¼‰ã€‚</p>
</li>
</ul>
]]></content>
      <categories>
        <category>webå‰ç«¯</category>
      </categories>
      <tags>
        <tag>Vue</tag>
      </tags>
  </entry>
  <entry>
    <title>JavaScriptæ ¸å¿ƒåŸç†</title>
    <url>/posts/2541eeff.html</url>
    <content><![CDATA[<h3 id="JSæ•°æ®ç±»å‹"><a href="#JSæ•°æ®ç±»å‹" class="headerlink" title="JSæ•°æ®ç±»å‹"></a>JSæ•°æ®ç±»å‹</h3><h4 id="æ¦‚å¿µ"><a href="#æ¦‚å¿µ" class="headerlink" title="æ¦‚å¿µ"></a>æ¦‚å¿µ</h4><p>JavaScript çš„æ•°æ®ç±»å‹æœ‰ä¸‹å›¾æ‰€ç¤ºçš„ 8 ç§ï¼š<br><img src="/posts/2541eeff/1.png" alt="8ç§ç±»å‹"><br>å‰ 7 ç§ç±»å‹ä¸ºåŸºç¡€ç±»å‹ï¼Œæœ€å 1 ç§ï¼ˆObjectï¼‰ä¸ºå¼•ç”¨ç±»å‹ï¼Œè€Œå¼•ç”¨æ•°æ®ç±»å‹ï¼ˆObjectï¼‰åˆåˆ†ä¸ºå›¾ä¸Šè¿™å‡ ç§å¸¸è§çš„ç±»å‹ï¼š<code>Array</code> - æ•°ç»„å¯¹è±¡ã€<code>RegExp</code> - æ­£åˆ™å¯¹è±¡ã€<code>Date</code> - æ—¥æœŸå¯¹è±¡ã€<code>Math</code> - æ•°å­¦å‡½æ•°ã€<code>Function</code> - å‡½æ•°å¯¹è±¡ã€‚<br>å„ç§ JavaScript çš„æ•°æ®ç±»å‹æœ€åéƒ½ä¼šåœ¨åˆå§‹åŒ–ä¹‹åæ”¾åœ¨ä¸åŒçš„å†…å­˜ä¸­ï¼Œå› æ­¤ä¸Šé¢çš„æ•°æ®ç±»å‹å¤§è‡´å¯ä»¥åˆ†æˆä¸¤ç±»æ¥è¿›è¡Œå­˜å‚¨ï¼š</p>
<ul>
<li>åŸºç¡€ç±»å‹å­˜å‚¨åœ¨<code>æ ˆå†…å­˜</code>ï¼Œè¢«å¼•ç”¨æˆ–æ‹·è´æ—¶ï¼Œä¼šåˆ›å»ºä¸€ä¸ªå®Œå…¨ç›¸ç­‰çš„å˜é‡ï¼›</li>
<li>å¼•ç”¨ç±»å‹å­˜å‚¨åœ¨<code>å †å†…å­˜</code>ï¼Œå­˜å‚¨çš„æ˜¯åœ°å€ï¼Œå¤šä¸ªå¼•ç”¨æŒ‡å‘åŒä¸€ä¸ªåœ°å€ï¼Œè¿™é‡Œä¼šæ¶‰åŠä¸€ä¸ª<code>â€œå…±äº«â€</code>çš„æ¦‚å¿µã€‚</li>
</ul>
<h4 id="ç±»å‹æ£€æµ‹"><a href="#ç±»å‹æ£€æµ‹" class="headerlink" title="ç±»å‹æ£€æµ‹"></a>ç±»å‹æ£€æµ‹</h4><h5 id="åˆ¤æ–­æ–¹æ³•1ï¼štypeof"><a href="#åˆ¤æ–­æ–¹æ³•1ï¼štypeof" class="headerlink" title="åˆ¤æ–­æ–¹æ³•1ï¼štypeof"></a>åˆ¤æ–­æ–¹æ³•1ï¼štypeof</h5><figure class="highlight awk"><table><tr><td class="code"><pre><span class="line">typeof <span class="number">1</span> <span class="regexp">//</span> <span class="string">&#x27;number&#x27;</span></span><br><span class="line"></span><br><span class="line">typeof <span class="string">&#x27;1&#x27;</span> <span class="regexp">//</span> <span class="string">&#x27;string&#x27;</span></span><br><span class="line"></span><br><span class="line">typeof undefined <span class="regexp">//</span> <span class="string">&#x27;undefined&#x27;</span></span><br><span class="line"></span><br><span class="line">typeof true <span class="regexp">//</span> <span class="string">&#x27;boolean&#x27;</span></span><br><span class="line"></span><br><span class="line">typeof Symbol() <span class="regexp">//</span> <span class="string">&#x27;symbol&#x27;</span></span><br><span class="line"></span><br><span class="line">typeof null <span class="regexp">//</span> <span class="string">&#x27;object&#x27;</span></span><br><span class="line"></span><br><span class="line">typeof [] <span class="regexp">//</span> <span class="string">&#x27;object&#x27;</span></span><br><span class="line"></span><br><span class="line">typeof &#123;&#125; <span class="regexp">//</span> <span class="string">&#x27;object&#x27;</span></span><br><span class="line"></span><br><span class="line">typeof console <span class="regexp">//</span> <span class="string">&#x27;object&#x27;</span></span><br><span class="line"></span><br><span class="line">typeof console.log <span class="regexp">//</span> <span class="string">&#x27;function&#x27;</span></span><br></pre></td></tr></table></figure>
<p><code>typeof</code>å¯¹äºåŸºæœ¬ç±»å‹ï¼Œé™¤äº† <code>null</code> éƒ½å¯ä»¥æ˜¾ç¤ºæ­£ç¡®çš„ç±»å‹ï¼Œè™½ç„¶<code>null</code>æ˜¯åŸºæœ¬ç±»å‹ï¼Œä½†æ˜¯ä¼šæ˜¾ç¤º<code>object</code>ï¼Œè¿™æ˜¯ä¸€ä¸ªå­˜åœ¨å¾ˆä¹…çš„Bugï¼Œå› ä¸ºåœ¨ JS çš„æœ€åˆç‰ˆæœ¬ä¸­ï¼Œä½¿ç”¨çš„æ˜¯ <code>32ä½ç³»ç»Ÿ</code>ï¼Œä¸ºäº†æ€§èƒ½è€ƒè™‘ä½¿ç”¨ä½ä½å­˜å‚¨äº†å˜é‡çš„ç±»å‹ä¿¡æ¯ï¼Œ<code>000</code>å¼€å¤´ä»£è¡¨æ˜¯å¯¹è±¡ï¼Œç„¶è€Œ <code>null</code> è¡¨ç¤ºä¸ºå…¨é›¶ï¼Œæ‰€ä»¥å°†å®ƒé”™è¯¯çš„åˆ¤æ–­ä¸º <code>object</code> ã€‚è™½ç„¶ç°åœ¨çš„å†…éƒ¨ç±»å‹åˆ¤æ–­ä»£ç å·²ç»æ”¹å˜äº†ï¼Œä½†æ˜¯å¯¹äºè¿™ä¸ª Bug å´æ˜¯ä¸€ç›´æµä¼ ä¸‹æ¥ã€‚</p>
<h5 id="åˆ¤æ–­æ–¹æ³•2ï¼šinstanceof"><a href="#åˆ¤æ–­æ–¹æ³•2ï¼šinstanceof" class="headerlink" title="åˆ¤æ–­æ–¹æ³•2ï¼šinstanceof"></a>åˆ¤æ–­æ–¹æ³•2ï¼šinstanceof</h5><p>æˆ‘ä»¬<code>new</code>ä¸€ä¸ªå¯¹è±¡ï¼Œé‚£ä¹ˆè¿™ä¸ªæ–°å¯¹è±¡å°±æ˜¯å®ƒåŸå‹é“¾ç»§æ‰¿ä¸Šé¢çš„å¯¹è±¡äº†ï¼Œé€šè¿‡<code>instanceof</code>æˆ‘ä»¬èƒ½åˆ¤æ–­è¿™ä¸ªå¯¹è±¡æ˜¯å¦æ˜¯ä¹‹å‰é‚£ä¸ªæ„é€ å‡½æ•°ç”Ÿæˆçš„å¯¹è±¡ï¼Œè¿™æ ·å°±åŸºæœ¬å¯ä»¥åˆ¤æ–­å‡ºè¿™ä¸ªæ–°å¯¹è±¡çš„æ•°æ®ç±»å‹ã€‚ä¸‹é¢é€šè¿‡ä»£ç æ¥äº†è§£ä¸€ä¸‹ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> <span class="title class_">Car</span> = <span class="keyword">function</span>(<span class="params"></span>) &#123;&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> benz = <span class="keyword">new</span> <span class="title class_">Car</span>()</span><br><span class="line"></span><br><span class="line">benz <span class="keyword">instanceof</span> <span class="title class_">Car</span> <span class="comment">// true</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> car = <span class="keyword">new</span> <span class="title class_">String</span>(<span class="string">&#x27;Mercedes Benz&#x27;</span>)</span><br><span class="line"></span><br><span class="line">car <span class="keyword">instanceof</span> <span class="title class_">String</span> <span class="comment">// true</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> str = <span class="string">&#x27;Covid-19&#x27;</span></span><br><span class="line"></span><br><span class="line">str <span class="keyword">instanceof</span> <span class="title class_">String</span> <span class="comment">// false</span></span><br></pre></td></tr></table></figure>
<p>é‚£ä¹ˆå¦‚ä½•å®ç°ä¸€ä¸ª<code>instanceof</code>çš„åº•å±‚å®ç°å‘¢ï¼Œä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">myInstanceof</span>(<span class="params">left, right</span>) &#123;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// è¿™é‡Œå…ˆç”¨typeofæ¥åˆ¤æ–­åŸºç¡€æ•°æ®ç±»å‹ï¼Œå¦‚æœæ˜¯ï¼Œç›´æ¥è¿”å›false</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span>(<span class="keyword">typeof</span> left !== <span class="string">&#x27;object&#x27;</span> || left === <span class="literal">null</span>) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// getProtypeOfæ˜¯Objectå¯¹è±¡è‡ªå¸¦çš„APIï¼Œèƒ½å¤Ÿæ‹¿åˆ°å‚æ•°çš„åŸå‹å¯¹è±¡</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">let</span> proto = <span class="title class_">Object</span>.<span class="title function_">getPrototypeOf</span>(left);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">while</span>(<span class="literal">true</span>) &#123;                  <span class="comment">//å¾ªç¯å¾€ä¸‹å¯»æ‰¾ï¼Œç›´åˆ°æ‰¾åˆ°ç›¸åŒçš„åŸå‹å¯¹è±¡</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(proto === <span class="literal">null</span>) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(proto === right.<span class="property"><span class="keyword">prototype</span></span>) <span class="keyword">return</span> <span class="literal">true</span>;<span class="comment">//æ‰¾åˆ°ç›¸åŒåŸå‹å¯¹è±¡ï¼Œè¿”å›true</span></span><br><span class="line"></span><br><span class="line">    proto = <span class="title class_">Object</span>.<span class="title function_">getPrototypeof</span>(proto);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// éªŒè¯ä¸€ä¸‹è‡ªå·±å®ç°çš„myInstanceofæ˜¯å¦OK</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title function_">myInstanceof</span>(<span class="keyword">new</span> <span class="title class_">Number</span>(<span class="number">123</span>), <span class="title class_">Number</span>));    <span class="comment">// true</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="title function_">myInstanceof</span>(<span class="number">123</span>, <span class="title class_">Number</span>));                <span class="comment">// false</span></span><br></pre></td></tr></table></figure>
<p>å‰é¢ä¸¤ç§åˆ¤æ–­æ•°æ®ç±»å‹çš„æ–¹æ³•å®ƒä»¬ä¹‹é—´æœ‰ä»€ä¹ˆå·®å¼‚å‘¢ï¼Ÿæˆ‘æ€»ç»“äº†ä¸‹é¢ä¸¤ç‚¹ï¼š</p>
<ul>
<li><p>instanceof å¯ä»¥å‡†ç¡®åœ°åˆ¤æ–­å¤æ‚å¼•ç”¨æ•°æ®ç±»å‹ï¼Œä½†æ˜¯ä¸èƒ½æ­£ç¡®åˆ¤æ–­åŸºç¡€æ•°æ®ç±»å‹ï¼›</p>
</li>
<li><p>è€Œ typeof ä¹Ÿå­˜åœ¨å¼Šç«¯ï¼Œå®ƒè™½ç„¶å¯ä»¥åˆ¤æ–­åŸºç¡€æ•°æ®ç±»å‹ï¼ˆnull é™¤å¤–ï¼‰ï¼Œä½†æ˜¯å¼•ç”¨æ•°æ®ç±»å‹ä¸­ï¼Œé™¤äº† function ç±»å‹ä»¥å¤–ï¼Œå…¶ä»–çš„ä¹Ÿæ— æ³•åˆ¤æ–­ã€‚</p>
</li>
</ul>
<h5 id="åˆ¤æ–­æ–¹æ³•3ï¼šObject-prototype-toString"><a href="#åˆ¤æ–­æ–¹æ³•3ï¼šObject-prototype-toString" class="headerlink" title="åˆ¤æ–­æ–¹æ³•3ï¼šObject.prototype.toString"></a>åˆ¤æ–­æ–¹æ³•3ï¼šObject.prototype.toString</h5><p><code>toString()</code>æ˜¯<code>Object</code>çš„åŸå‹æ–¹æ³•ï¼Œè°ƒç”¨è¯¥æ–¹æ³•ï¼Œå¯ä»¥ç»Ÿä¸€è¿”å›æ ¼å¼ä¸º<code>â€œ[object Xxx]â€</code>çš„å­—ç¬¦ä¸²ï¼Œå…¶ä¸­ <code>Xxx</code> å°±æ˜¯å¯¹è±¡çš„ç±»å‹ã€‚å¯¹äº <code>Object</code> å¯¹è±¡ï¼Œç›´æ¥è°ƒç”¨ <code>toString()</code> å°±èƒ½è¿”å› <code>[object Object]</code>ï¼›è€Œå¯¹äºå…¶ä»–å¯¹è±¡ï¼Œåˆ™éœ€è¦é€šè¿‡ <code>call</code> æ¥è°ƒç”¨ï¼Œæ‰èƒ½è¿”å›æ­£ç¡®çš„ç±»å‹ä¿¡æ¯ã€‚</p>
<figure class="highlight stylus"><table><tr><td class="code"><pre><span class="line">Object<span class="selector-class">.prototype</span><span class="selector-class">.toString</span>(&#123;&#125;)       <span class="comment">// &quot;[object Object]&quot;</span></span><br><span class="line">Object<span class="selector-class">.prototype</span><span class="selector-class">.toString</span><span class="selector-class">.call</span>(&#123;&#125;)  <span class="comment">// åŒä¸Šç»“æœï¼ŒåŠ ä¸Šcallä¹Ÿok</span></span><br><span class="line">Object<span class="selector-class">.prototype</span><span class="selector-class">.toString</span><span class="selector-class">.call</span>(<span class="number">1</span>)    <span class="comment">// &quot;[object Number]&quot;</span></span><br><span class="line">Object<span class="selector-class">.prototype</span><span class="selector-class">.toString</span><span class="selector-class">.call</span>(<span class="string">&#x27;1&#x27;</span>)  <span class="comment">// &quot;[object String]&quot;</span></span><br><span class="line">Object<span class="selector-class">.prototype</span><span class="selector-class">.toString</span><span class="selector-class">.call</span>(true)  <span class="comment">// &quot;[object Boolean]&quot;</span></span><br><span class="line">Object<span class="selector-class">.prototype</span><span class="selector-class">.toString</span><span class="selector-class">.call</span>(<span class="built_in">function</span>()&#123;&#125;)  <span class="comment">// &quot;[object Function]&quot;</span></span><br><span class="line">Object<span class="selector-class">.prototype</span><span class="selector-class">.toString</span><span class="selector-class">.call</span>(null)   <span class="comment">//&quot;[object Null]&quot;</span></span><br><span class="line">Object<span class="selector-class">.prototype</span><span class="selector-class">.toString</span><span class="selector-class">.call</span>(undefined) <span class="comment">//&quot;[object Undefined]&quot;</span></span><br><span class="line">Object<span class="selector-class">.prototype</span><span class="selector-class">.toString</span><span class="selector-class">.call</span>(/<span class="number">123</span>/g)    <span class="comment">//&quot;[object RegExp]&quot;</span></span><br><span class="line">Object<span class="selector-class">.prototype</span><span class="selector-class">.toString</span><span class="selector-class">.call</span>(new <span class="built_in">Date</span>()) <span class="comment">//&quot;[object Date]&quot;</span></span><br><span class="line">Object<span class="selector-class">.prototype</span><span class="selector-class">.toString</span><span class="selector-class">.call</span>(<span class="selector-attr">[]</span>)       <span class="comment">//&quot;[object Array]&quot;</span></span><br><span class="line">Object<span class="selector-class">.prototype</span><span class="selector-class">.toString</span><span class="selector-class">.call</span>(document)  <span class="comment">//&quot;[object HTMLDocument]&quot;</span></span><br><span class="line">Object<span class="selector-class">.prototype</span><span class="selector-class">.toString</span><span class="selector-class">.call</span>(window)   <span class="comment">//&quot;[object Window]&quot;</span></span><br></pre></td></tr></table></figure>
<p>ä¸‹é¢æ¥å®ç°ä¸€ä¸ªå…¨å±€é€šç”¨çš„æ•°æ®ç±»å‹åˆ¤æ–­æ–¹æ³•ï¼Œä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight awk"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span> getType(obj)&#123;</span><br><span class="line">    let type  = typeof obj;</span><br><span class="line">    <span class="keyword">if</span> (type !== <span class="string">&quot;object&quot;</span>) &#123;    <span class="regexp">//</span> å…ˆè¿›è¡Œtypeofåˆ¤æ–­ï¼Œå¦‚æœæ˜¯åŸºç¡€æ•°æ®ç±»å‹ï¼Œç›´æ¥è¿”å›</span><br><span class="line">        return type;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="regexp">//</span> å¯¹äºtypeofè¿”å›ç»“æœæ˜¯objectçš„ï¼Œå†è¿›è¡Œå¦‚ä¸‹çš„åˆ¤æ–­ï¼Œæ­£åˆ™è¿”å›ç»“æœ</span><br><span class="line">    return Object.prototype.toString.call(obj).replace(<span class="regexp">/^\[object (\S+)\]$/</span>, <span class="string">&#x27;$1&#x27;</span>);  <span class="regexp">//</span> æ³¨æ„æ­£åˆ™ä¸­é—´æœ‰ä¸ªç©ºæ ¼</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="regexp">/* ä»£ç éªŒè¯ï¼Œéœ€è¦æ³¨æ„å¤§å°å†™ï¼Œå“ªäº›æ˜¯typeofåˆ¤æ–­ï¼Œå“ªäº›æ˜¯toStringåˆ¤æ–­ï¼Ÿæ€è€ƒä¸‹ */</span></span><br><span class="line">getType([])     <span class="regexp">//</span> <span class="string">&quot;Array&quot;</span> typeof []æ˜¯objectï¼Œå› æ­¤toStringè¿”å›</span><br><span class="line">getType(<span class="string">&#x27;123&#x27;</span>)  <span class="regexp">//</span> <span class="string">&quot;string&quot;</span> typeof ç›´æ¥è¿”å›</span><br><span class="line">getType(window) <span class="regexp">//</span> <span class="string">&quot;Window&quot;</span> toStringè¿”å›</span><br><span class="line">getType(null)   <span class="regexp">//</span> <span class="string">&quot;Null&quot;</span>é¦–å­—æ¯å¤§å†™ï¼Œtypeof nullæ˜¯objectï¼Œéœ€toStringæ¥åˆ¤æ–­</span><br><span class="line">getType(undefined)   <span class="regexp">//</span> <span class="string">&quot;undefined&quot;</span> typeof ç›´æ¥è¿”å›</span><br><span class="line">getType()            <span class="regexp">//</span> <span class="string">&quot;undefined&quot;</span> typeof ç›´æ¥è¿”å›</span><br><span class="line">getType(<span class="keyword">function</span>()&#123;&#125;) <span class="regexp">//</span> <span class="string">&quot;function&quot;</span> typeofèƒ½åˆ¤æ–­ï¼Œå› æ­¤é¦–å­—æ¯å°å†™</span><br><span class="line">getType(<span class="regexp">/123/g</span>)      <span class="regexp">//</span><span class="string">&quot;RegExp&quot;</span> toStringè¿”å›</span><br></pre></td></tr></table></figure>
<h3 id="æ·±æµ…æ‹·è´"><a href="#æ·±æµ…æ‹·è´" class="headerlink" title="æ·±æµ…æ‹·è´"></a>æ·±æµ…æ‹·è´</h3><h4 id="æµ…æ‹·è´"><a href="#æµ…æ‹·è´" class="headerlink" title="æµ…æ‹·è´"></a>æµ…æ‹·è´</h4><p>åˆ›å»ºä¸€ä¸ªæ–°çš„å¯¹è±¡ï¼Œæ¥æ¥æ”¶ä½ è¦é‡æ–°å¤åˆ¶æˆ–å¼•ç”¨çš„å¯¹è±¡å€¼ã€‚å¦‚æœå¯¹è±¡å±æ€§æ˜¯åŸºæœ¬çš„æ•°æ®ç±»å‹ï¼Œå¤åˆ¶çš„å°±æ˜¯åŸºæœ¬ç±»å‹çš„å€¼ç»™æ–°å¯¹è±¡ï¼›ä½†å¦‚æœå±æ€§æ˜¯å¼•ç”¨æ•°æ®ç±»å‹ï¼Œå¤åˆ¶çš„å°±æ˜¯å†…å­˜ä¸­çš„åœ°å€ï¼Œå¦‚æœå…¶ä¸­ä¸€ä¸ªå¯¹è±¡æ”¹å˜äº†è¿™ä¸ªå†…å­˜ä¸­çš„åœ°å€ï¼Œè‚¯å®šä¼šå½±å“åˆ°å¦ä¸€ä¸ªå¯¹è±¡ã€‚</p>
<figure class="highlight stylus"><table><tr><td class="code"><pre><span class="line">let <span class="selector-tag">a</span> = &#123;</span><br><span class="line">    age: <span class="number">1</span></span><br><span class="line">&#125;</span><br><span class="line">let <span class="selector-tag">b</span> = <span class="selector-tag">a</span></span><br><span class="line"><span class="selector-tag">a</span><span class="selector-class">.age</span> = <span class="number">2</span></span><br><span class="line">console<span class="selector-class">.log</span>(<span class="selector-tag">b</span>.age) <span class="comment">// 2</span></span><br></pre></td></tr></table></figure>
<p>ä¸Šè¿°ä¾‹å­çœ‹å‡ºï¼Œç»™ä¸€ä¸ªå˜é‡èµ‹å€¼ä¸€ä¸ªå¯¹è±¡ï¼Œé‚£ä¹ˆä¸¤è€…çš„å€¼ä¼šæ˜¯åŒä¸€ä¸ªå¼•ç”¨ï¼Œå…¶ä¸­ä¸€æ–¹æ”¹å˜ï¼Œå¦ä¸€æ–¹ä¹Ÿä¼šç›¸åº”æ”¹å˜ï¼Œå¦‚æœä¸æƒ³è¦æ”¹å˜ï¼Œå¯ä»¥ç”¨æµ…æ‹·è´çš„æ–¹å¼ï¼Œä¸‹é¢å°±æ˜¯æµ…æ‹·è´çš„å‡ ç§æ–¹æ³•ï¼š</p>
<h5 id="æ–¹æ³•1ï¼šobject-assign"><a href="#æ–¹æ³•1ï¼šobject-assign" class="headerlink" title="æ–¹æ³•1ï¼šobject.assign"></a>æ–¹æ³•1ï¼š<code>object.assign</code></h5><p><code>object.assign</code>æ˜¯ ES6 ä¸­ object çš„ä¸€ä¸ªæ–¹æ³•ï¼Œè¯¥æ–¹æ³•å¯ä»¥ç”¨äº JS å¯¹è±¡çš„åˆå¹¶ç­‰å¤šä¸ªç”¨é€”ï¼Œè¯¥æ–¹æ³•æœ‰ä¸¤ä¸ªå‚æ•°ï¼š<br>å‚æ•°1ï¼š<code>æ‹·è´çš„ç›®æ ‡å¯¹è±¡</code>ï¼Œ<br>å‚æ•°2ï¼š<code>æ‹·è´çš„æ¥æºå¯¹è±¡ï¼ˆä¹Ÿå¯ä»¥æ˜¯å¤šä¸ªæ¥æºï¼‰</code>ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> a = &#123;</span><br><span class="line">    <span class="attr">age</span>: <span class="number">1</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> b = <span class="title class_">Object</span>.<span class="title function_">assign</span>(&#123;&#125;,a)</span><br><span class="line">a.<span class="property">age</span> = <span class="number">10</span>;</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(b.<span class="property">age</span>)  <span class="comment">// 1</span></span><br></pre></td></tr></table></figure>
<p>ä½¿ç”¨ <code>object.assign</code> æ–¹æ³•æœ‰å‡ ç‚¹éœ€è¦æ³¨æ„ï¼š</p>
<ul>
<li>å®ƒä¸ä¼šæ‹·è´å¯¹è±¡çš„ç»§æ‰¿å±æ€§ï¼›</li>
<li>å®ƒä¸ä¼šæ‹·è´å¯¹è±¡çš„ä¸å¯æšä¸¾çš„å±æ€§ï¼›</li>
<li>å¯ä»¥æ‹·è´ Symbol ç±»å‹çš„å±æ€§ã€‚</li>
</ul>
<h5 id="æ–¹æ³•2ï¼š-æ‰©å±•è¿ç®—ç¬¦æ–¹å¼"><a href="#æ–¹æ³•2ï¼š-æ‰©å±•è¿ç®—ç¬¦æ–¹å¼" class="headerlink" title="æ–¹æ³•2ï¼š...æ‰©å±•è¿ç®—ç¬¦æ–¹å¼"></a>æ–¹æ³•2ï¼š<code>...</code>æ‰©å±•è¿ç®—ç¬¦æ–¹å¼</h5><figure class="highlight stylus"><table><tr><td class="code"><pre><span class="line">let <span class="selector-tag">a</span> = &#123;</span><br><span class="line">    age: <span class="number">1</span></span><br><span class="line">&#125;</span><br><span class="line">let <span class="selector-tag">b</span> = &#123;...a&#125;</span><br><span class="line"><span class="selector-tag">a</span><span class="selector-class">.age</span> = <span class="number">2</span></span><br><span class="line">console<span class="selector-class">.log</span>(<span class="selector-tag">b</span>.age) <span class="comment">// 1</span></span><br></pre></td></tr></table></figure>
<p><code>æ‰©å±•è¿ç®—ç¬¦</code>å’Œ<code>object.assign</code>æœ‰åŒæ ·çš„ç¼ºé™·ï¼Œä¹Ÿå°±æ˜¯å®ç°çš„æµ…æ‹·è´çš„åŠŸèƒ½å·®ä¸å¤šï¼Œä½†æ˜¯å¦‚æœå±æ€§éƒ½æ˜¯<code>åŸºæœ¬ç±»å‹</code>çš„å€¼ï¼Œä½¿ç”¨æ‰©å±•è¿ç®—ç¬¦è¿›è¡Œæµ…æ‹·è´ä¼šæ›´åŠ æ–¹ä¾¿ã€‚</p>
<h5 id="æ–¹æ³•3ï¼šconcatæ‹·è´æ•°ç»„"><a href="#æ–¹æ³•3ï¼šconcatæ‹·è´æ•°ç»„" class="headerlink" title="æ–¹æ³•3ï¼šconcatæ‹·è´æ•°ç»„"></a>æ–¹æ³•3ï¼š<code>concat</code>æ‹·è´æ•°ç»„</h5><p>è¯­æ³•ï¼š</p>
<figure class="highlight angelscript"><table><tr><td class="code"><pre><span class="line"><span class="built_in">array</span>Object.concat(<span class="built_in">array</span>X,<span class="built_in">array</span>X,......,<span class="built_in">array</span>X)</span><br></pre></td></tr></table></figure>
<p>concat() æ–¹æ³•ç”¨äºè¿æ¥ä¸¤ä¸ªæˆ–å¤šä¸ªæ•°ç»„ï¼Œè¯¥æ–¹æ³•ä¸ä¼šæ”¹å˜ç°æœ‰çš„æ•°ç»„ï¼Œè€Œä»…ä»…ä¼šè¿”å›è¢«è¿æ¥æ•°ç»„çš„ä¸€ä¸ªå‰¯æœ¬ã€‚æ³¨æ„ï¼šconcatåªèƒ½ç”¨äºæ•°ç»„çš„æµ…æ‹·è´ï¼Œä½¿ç”¨åœºæ™¯æ¯”è¾ƒå±€é™ã€‚ä»£ç å¦‚ä¸‹æ‰€ç¤ºã€‚</p>
<figure class="highlight haxe"><table><tr><td class="code"><pre><span class="line">let arr = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>];</span><br><span class="line">let <span class="keyword">new</span><span class="type">Arr</span> = arr.concat();</span><br><span class="line"><span class="keyword">new</span><span class="type">Arr</span>[<span class="number">1</span>] = <span class="number">100</span>;</span><br><span class="line">console.log(arr);  <span class="comment">// [ 1, 2, 3 ]</span></span><br><span class="line">console.log(<span class="keyword">new</span><span class="type">Arr</span>); <span class="comment">// [ 1, 100, 3 ]</span></span><br></pre></td></tr></table></figure>
<h5 id="æ–¹æ³•4ï¼šsliceæ‹·è´æ•°ç»„"><a href="#æ–¹æ³•4ï¼šsliceæ‹·è´æ•°ç»„" class="headerlink" title="æ–¹æ³•4ï¼šsliceæ‹·è´æ•°ç»„"></a>æ–¹æ³•4ï¼š<code>slice</code>æ‹·è´æ•°ç»„</h5><p>è¯­æ³•ï¼š</p>
<figure class="highlight pgsql"><table><tr><td class="code"><pre><span class="line">arrayObject.<span class="keyword">slice</span>(<span class="keyword">begin</span>, <span class="keyword">end</span>);</span><br></pre></td></tr></table></figure>
<p>slice()æ–¹æ³•å¯ä»å·²æœ‰çš„æ•°ç»„ä¸­è¿”å›é€‰å®šçš„å…ƒç´ ï¼Œè¯¥æ–¹æ³•å¹¶ä¸ä¼šä¿®æ”¹æ•°ç»„ï¼Œè€Œæ˜¯è¿”å›ä¸€ä¸ªæ–°çš„æ•°ç»„ï¼ŒåŒ…å«ä» start åˆ° end ï¼ˆä¸åŒ…æ‹¬è¯¥å…ƒç´ ï¼‰çš„ arrayObject ä¸­çš„å…ƒç´ ï¼Œä¸‹é¢æ˜¯å®ç°æµ…æ‹·è´çš„ä»£ç ç¤ºä¾‹ï¼š</p>
<figure class="highlight fsharp"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> arr <span class="operator">=</span> [<span class="number">1</span>, <span class="number">2</span>, &#123;<span class="keyword">val</span><span class="operator">:</span> 4&#125;];</span><br><span class="line"><span class="keyword">let</span> newArr <span class="operator">=</span> arr.slice();</span><br><span class="line">newArr[<span class="number">2</span>].<span class="keyword">val</span> <span class="operator">=</span> <span class="number">1000</span>;</span><br><span class="line">console.log(arr);  <span class="comment">//[ 1, 2, &#123; val: 1000 &#125; ]</span></span><br></pre></td></tr></table></figure>
<p>ä»ä¸Šé¢çš„ä»£ç ä¸­å¯ä»¥çœ‹å‡ºï¼Œæµ…æ‹·è´åªèƒ½æ‹·è´ä¸€å±‚å¯¹è±¡ã€‚å¦‚æœå­˜åœ¨å¯¹è±¡çš„åµŒå¥—ï¼Œé‚£ä¹ˆæµ…æ‹·è´å°†æ— èƒ½ä¸ºåŠ›ï¼Œä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œè¿™ä¸ªæ—¶å€™å°±å¯ä»¥é‡‡ç”¨æ·±æ‹·è´ï¼Œå®ƒèƒ½è§£å†³å¤šå±‚å¯¹è±¡åµŒå¥—é—®é¢˜ï¼Œå½»åº•å®ç°æ‹·è´ã€‚</p>
<h5 id="æ‰‹å·¥å®ç°æµ…æ‹·è´"><a href="#æ‰‹å·¥å®ç°æµ…æ‹·è´" class="headerlink" title="æ‰‹å·¥å®ç°æµ…æ‹·è´"></a>æ‰‹å·¥å®ç°æµ…æ‹·è´</h5><p>å®ç°æ€è·¯ï¼š</p>
<ul>
<li>å¯¹åŸºç¡€ç±»å‹åšä¸€ä¸ªæœ€åŸºæœ¬çš„ä¸€ä¸ªæ‹·è´ï¼›</li>
<li>å¯¹å¼•ç”¨ç±»å‹å¼€è¾Ÿä¸€ä¸ªæ–°çš„å­˜å‚¨ï¼Œå¹¶ä¸”æ‹·è´ä¸€å±‚å¯¹è±¡å±æ€§ã€‚</li>
</ul>
<figure class="highlight aspectj"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> shallowClone = (<span class="keyword">target</span>) =&gt; &#123;</span><br><span class="line">   <span class="comment">// ç±»å‹åˆ¤æ–­ï¼ŒåŸºæœ¬ç±»å‹ç›´æ¥è¿”å›ï¼Œé’ˆå¯¹å¼•ç”¨ç±»å‹çš„å¯¹è±¡è¿›è¡Œ for å¾ªç¯éå†å¯¹è±¡å±æ€§èµ‹å€¼ç»™ç›®æ ‡å¯¹è±¡çš„å±æ€§</span></span><br><span class="line">  <span class="keyword">if</span> (typeof <span class="keyword">target</span> === <span class="string">&#x27;object&#x27;</span> &amp;&amp; <span class="keyword">target</span> !== <span class="keyword">null</span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> cloneTarget = Array.isArray(<span class="keyword">target</span>) ? []: &#123;&#125;;</span><br><span class="line">    <span class="keyword">for</span> (let prop in <span class="keyword">target</span>) &#123;</span><br><span class="line">      <span class="keyword">if</span> (<span class="keyword">target</span>.hasOwnProperty(prop)) &#123;</span><br><span class="line">          cloneTarget[prop] = <span class="keyword">target</span>[prop];</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> cloneTarget;</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">target</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p><code>hasOwnProperty()</code>æ–¹æ³•ç”¨æ¥æ£€æµ‹ä¸€ä¸ªå±æ€§æ˜¯å¦æ˜¯å¯¹è±¡çš„è‡ªæœ‰å±æ€§ï¼Œè€Œä¸æ˜¯ä»åŸå‹é“¾ç»§æ‰¿çš„ã€‚å¦‚æœè¯¥å±æ€§æ˜¯è‡ªæœ‰å±æ€§ï¼Œé‚£ä¹ˆè¿”å›<code>true</code>ï¼Œå¦åˆ™è¿”å› <code>false</code>ã€‚æ¢å¥è¯è¯´ï¼Œ<code>hasOwnProperty()</code>æ–¹æ³•ä¸ä¼šæ£€æµ‹å¯¹è±¡çš„åŸå‹é“¾ï¼Œåªä¼šæ£€æµ‹å½“å‰å¯¹è±¡æœ¬èº«ï¼Œåªæœ‰å½“å‰å¯¹è±¡æœ¬èº«å­˜åœ¨è¯¥å±æ€§æ—¶æ‰è¿”å›<code>true</code>ã€‚</p>
</blockquote>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> obj = &#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&#x27;zs&#x27;</span>,</span><br><span class="line">    <span class="attr">age</span>: <span class="number">12</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> prop <span class="keyword">in</span> obj) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(obj.<span class="title function_">hasOwnProperty</span>(prop)) <span class="comment">// true</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="æ·±æ‹·è´"><a href="#æ·±æ‹·è´" class="headerlink" title="æ·±æ‹·è´"></a>æ·±æ‹·è´</h4><p>å°†ä¸€ä¸ªå¯¹è±¡ä»å†…å­˜ä¸­å®Œæ•´åœ°æ‹·è´å‡ºæ¥ä¸€ä»½ç»™ç›®æ ‡å¯¹è±¡ï¼Œå¹¶ä»å †å†…å­˜ä¸­å¼€è¾Ÿä¸€ä¸ªå…¨æ–°çš„ç©ºé—´å­˜æ”¾æ–°å¯¹è±¡ï¼Œä¸”æ–°å¯¹è±¡çš„ä¿®æ”¹å¹¶ä¸ä¼šæ”¹å˜åŸå¯¹è±¡ï¼ŒäºŒè€…å®ç°çœŸæ­£çš„åˆ†ç¦»ã€‚</p>
<h5 id="æ–¹æ³•1ï¼šJSON-stringfy"><a href="#æ–¹æ³•1ï¼šJSON-stringfy" class="headerlink" title="æ–¹æ³•1ï¼šJSON.stringfy"></a>æ–¹æ³•1ï¼š<code>JSON.stringfy</code></h5><p>JSON.stringify()æ˜¯ç›®å‰å¼€å‘è¿‡ç¨‹ä¸­æœ€ç®€å•çš„æ·±æ‹·è´æ–¹æ³•ï¼Œå…¶å®å°±æ˜¯æŠŠä¸€ä¸ªå¯¹è±¡åºåˆ—åŒ–æˆä¸ºJSONçš„å­—ç¬¦ä¸²ï¼Œå¹¶å°†å¯¹è±¡é‡Œé¢çš„å†…å®¹è½¬æ¢æˆå­—ç¬¦ä¸²ï¼Œæœ€åå†ç”¨<code>JSON.parse()</code>çš„æ–¹æ³•å°†<code>JSONå­—ç¬¦ä¸²</code>ç”Ÿæˆä¸€ä¸ªæ–°çš„å¯¹è±¡ã€‚ç¤ºä¾‹ä»£ç å¦‚ä¸‹æ‰€ç¤º:</p>
<figure class="highlight apache"><table><tr><td class="code"><pre><span class="line"><span class="attribute">let</span> obj1 = &#123; a:<span class="number">1</span>, b:[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>] &#125;</span><br><span class="line"><span class="attribute">let</span> str = JSON.stringify(obj1)ï¼›</span><br><span class="line"><span class="attribute">let</span> obj2 = JSON.parse(str)ï¼›</span><br><span class="line"><span class="attribute">console</span>.log(obj2);   //&#123;a:<span class="number">1</span>,b:[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>]&#125; </span><br><span class="line"><span class="attribute">obj1</span>.a = <span class="number">2</span>ï¼›</span><br><span class="line"><span class="attribute">obj1</span>.b.push(<span class="number">4</span>);</span><br><span class="line"><span class="attribute">console</span>.log(obj1);   //&#123;a:<span class="number">2</span>,b:[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>]&#125;</span><br><span class="line"><span class="attribute">console</span>.log(obj2);   //&#123;a:<span class="number">1</span>,b:[<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>]&#125;</span><br></pre></td></tr></table></figure>
<p>è¯¥æ–¹æ³•ä¹Ÿæ˜¯æœ‰å±€é™æ€§çš„ï¼š</p>
<ul>
<li>æ‹·è´çš„å¯¹è±¡çš„å€¼ä¸­å¦‚æœæœ‰<code>å‡½æ•°</code>ã€<code>undefined</code>ã€<code>symbol</code>è¿™å‡ ç§ç±»å‹ï¼Œç»è¿‡<code>JSON.stringifyåºåˆ—åŒ–</code>ä¹‹åçš„å­—ç¬¦ä¸²ä¸­è¿™ä¸ª<code>é”®å€¼å¯¹ä¼šæ¶ˆå¤±</code>ï¼›</li>
<li>æ‹·è´ Date å¼•ç”¨ç±»å‹ä¼šå˜æˆå­—ç¬¦ä¸²ï¼›</li>
<li>æ— æ³•æ‹·è´ä¸å¯æšä¸¾çš„å±æ€§ï¼›</li>
<li>æ— æ³•æ‹·è´å¯¹è±¡çš„åŸå‹é“¾ï¼›</li>
<li>æ‹·è´ RegExp å¼•ç”¨ç±»å‹ä¼šå˜æˆç©ºå¯¹è±¡ï¼›</li>
<li>å¯¹è±¡ä¸­å«æœ‰ NaNã€Infinity ä»¥åŠ -Infinityï¼ŒJSON åºåˆ—åŒ–çš„ç»“æœä¼šå˜æˆ nullï¼›</li>
<li>æ— æ³•æ‹·è´å¯¹è±¡çš„å¾ªç¯å¼•ç”¨</li>
</ul>
<figure class="highlight qml"><table><tr><td class="code"><pre><span class="line"><span class="comment">// é’ˆå¯¹ä¸Šé¢è¯´æ³•ç¤ºä¾‹ï¼š</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">Obj</span>(<span class="params"></span>) </span>&#123; </span><br><span class="line">  <span class="keyword">this</span>.func = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123; alert(<span class="number">1</span>) &#125;; </span><br><span class="line">  <span class="keyword">this</span>.obj = &#123;<span class="attribute">a</span>:<span class="number">1</span>&#125;;</span><br><span class="line">  <span class="keyword">this</span>.arr = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>];</span><br><span class="line">  <span class="keyword">this</span>.und = <span class="literal">undefined</span>; </span><br><span class="line">  <span class="keyword">this</span>.reg = <span class="regexp">/123/</span>; </span><br><span class="line">  <span class="keyword">this</span>.date = <span class="keyword">new</span> <span class="built_in">Date</span>(<span class="number">0</span>); </span><br><span class="line">  <span class="keyword">this</span>.NaN = <span class="literal">NaN</span>;</span><br><span class="line">  <span class="keyword">this</span>.infinity = <span class="literal">Infinity</span>;</span><br><span class="line">  <span class="keyword">this</span>.sym = <span class="built_in">Symbol</span>(<span class="number">1</span>);</span><br><span class="line">&#125; </span><br><span class="line"><span class="keyword">let</span> obj1 = <span class="keyword">new</span> Obj();</span><br><span class="line"><span class="built_in">Object</span>.defineProperty(obj1,<span class="string">&#x27;innumerable&#x27;</span>,&#123; </span><br><span class="line">  <span class="attribute">enumerable</span>:<span class="attribute">false,</span></span><br><span class="line"><span class="attribute">  value</span>:<span class="string">&#x27;innumerable&#x27;</span></span><br><span class="line">&#125;);</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">&#x27;obj1&#x27;</span>,obj1);</span><br><span class="line"><span class="keyword">let</span> str = <span class="built_in">JSON</span>.stringify(obj1);</span><br><span class="line"><span class="keyword">let</span> obj2 = <span class="built_in">JSON</span>.parse(str);</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">&#x27;obj2&#x27;</span>,obj2);</span><br></pre></td></tr></table></figure>
<p>ä»¥ä¸Šä»£ç çš„æ‰“å°ç»“æœï¼š<br><img src="/posts/2541eeff/2.png" alt="æ‰“å°ç»“æœ"><br>ä½¿ç”¨ JSON.stringify æ–¹æ³•å®ç°æ·±æ‹·è´å¯¹è±¡ï¼Œè™½ç„¶åˆ°ç›®å‰ä¸ºæ­¢è¿˜æœ‰å¾ˆå¤šæ— æ³•å®ç°çš„åŠŸèƒ½ï¼Œä½†æ˜¯è¿™ç§æ–¹æ³•è¶³ä»¥æ»¡è¶³æ—¥å¸¸çš„å¼€å‘éœ€æ±‚ï¼Œå¹¶ä¸”æ˜¯æœ€ç®€å•å’Œå¿«æ·çš„ã€‚è€Œå¯¹äºå…¶ä»–çš„ä¹Ÿè¦å®ç°æ·±æ‹·è´çš„ï¼Œæ¯”è¾ƒéº»çƒ¦çš„å±æ€§å¯¹åº”çš„æ•°æ®ç±»å‹ï¼ŒJSON.stringify æš‚æ—¶è¿˜æ˜¯æ— æ³•æ»¡è¶³çš„ï¼Œé‚£ä¹ˆå°±éœ€è¦ä¸‹é¢çš„å‡ ç§æ–¹æ³•äº†ã€‚</p>
<h5 id="æ–¹æ³•2ï¼šåŸºç¡€ç‰ˆï¼ˆæ‰‹å†™é€’å½’å®ç°ï¼‰"><a href="#æ–¹æ³•2ï¼šåŸºç¡€ç‰ˆï¼ˆæ‰‹å†™é€’å½’å®ç°ï¼‰" class="headerlink" title="æ–¹æ³•2ï¼šåŸºç¡€ç‰ˆï¼ˆæ‰‹å†™é€’å½’å®ç°ï¼‰"></a>æ–¹æ³•2ï¼šåŸºç¡€ç‰ˆï¼ˆæ‰‹å†™é€’å½’å®ç°ï¼‰</h5><p>ä¸‹é¢æ˜¯ä¸€ä¸ªå®ç° deepClone å‡½æ•°å°è£…çš„ä¾‹å­ï¼Œé€šè¿‡ for in éå†ä¼ å…¥å‚æ•°çš„å±æ€§å€¼ï¼Œå¦‚æœå€¼æ˜¯å¼•ç”¨ç±»å‹åˆ™å†æ¬¡é€’å½’è°ƒç”¨è¯¥å‡½æ•°ï¼Œå¦‚æœæ˜¯åŸºç¡€æ•°æ®ç±»å‹å°±ç›´æ¥å¤åˆ¶ï¼Œä»£ç å¦‚ä¸‹æ‰€ç¤ºã€‚</p>
<figure class="highlight reasonml"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> obj1 = &#123;</span><br><span class="line">  a:&#123;</span><br><span class="line">    b:<span class="number">1</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">function</span> deep<span class="constructor">Clone(<span class="params">obj</span>)</span> &#123; </span><br><span class="line">  <span class="keyword">let</span> cloneObj = &#123;&#125;</span><br><span class="line">  <span class="keyword">for</span>(<span class="keyword">let</span> key <span class="keyword">in</span> obj) &#123;                 <span class="comment">//éå†</span></span><br><span class="line">    <span class="keyword">if</span>(typeof obj<span class="literal">[<span class="identifier">key</span>]</span> ===&#x27;<span class="keyword">object</span>&#x27;) &#123; </span><br><span class="line">      cloneObj<span class="literal">[<span class="identifier">key</span>]</span> = deep<span class="constructor">Clone(<span class="params">obj</span>[<span class="params">key</span>])</span>  <span class="comment">//æ˜¯å¯¹è±¡å°±å†æ¬¡è°ƒç”¨è¯¥å‡½æ•°é€’å½’</span></span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      cloneObj<span class="literal">[<span class="identifier">key</span>]</span> = obj<span class="literal">[<span class="identifier">key</span>]</span>  <span class="comment">//åŸºæœ¬ç±»å‹çš„è¯ç›´æ¥å¤åˆ¶å€¼</span></span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  return cloneObj</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> obj2 = deep<span class="constructor">Clone(<span class="params">obj1</span>)</span>;</span><br><span class="line">obj1.a.b = <span class="number">2</span>;</span><br><span class="line">console.log(obj2);   <span class="comment">//  &#123;a:&#123;b:1&#125;&#125;</span></span><br></pre></td></tr></table></figure>
<p>è™½ç„¶åˆ©ç”¨é€’å½’èƒ½å®ç°ä¸€ä¸ªæ·±æ‹·è´ï¼Œä½†æ˜¯åŒä¸Šé¢çš„ JSON.stringfy ä¸€æ ·ï¼Œè¿˜æ˜¯æœ‰ä¸€äº›é—®é¢˜æ²¡æœ‰å®Œå…¨è§£å†³ï¼Œä¾‹å¦‚ï¼š</p>
<ul>
<li>è¿™ä¸ªæ·±æ‹·è´å‡½æ•°å¹¶ä¸èƒ½å¤åˆ¶ä¸å¯æšä¸¾çš„å±æ€§ä»¥åŠ Symbol ç±»å‹ï¼›</li>
<li>è¿™ç§æ–¹æ³•åªæ˜¯é’ˆå¯¹æ™®é€šçš„å¼•ç”¨ç±»å‹çš„å€¼åšé€’å½’å¤åˆ¶ï¼Œè€Œå¯¹äº Arrayã€Dateã€RegExpã€Errorã€Function è¿™æ ·çš„å¼•ç”¨ç±»å‹å¹¶ä¸èƒ½æ­£ç¡®åœ°æ‹·è´ï¼›</li>
<li>å¯¹è±¡çš„å±æ€§é‡Œé¢æˆç¯ï¼Œå³å¾ªç¯å¼•ç”¨æ²¡æœ‰è§£å†³ã€‚</li>
</ul>
<p>è¿™ç§åŸºç¡€ç‰ˆæœ¬çš„å†™æ³•ä¹Ÿæ¯”è¾ƒç®€å•ï¼Œå¯ä»¥åº”å¯¹å¤§éƒ¨åˆ†çš„åº”ç”¨æƒ…å†µã€‚</p>
<h5 id="æ–¹æ³•3ï¼šæ”¹è¿›ç‰ˆï¼ˆæ”¹è¿›åé€’å½’å®ç°ï¼‰"><a href="#æ–¹æ³•3ï¼šæ”¹è¿›ç‰ˆï¼ˆæ”¹è¿›åé€’å½’å®ç°ï¼‰" class="headerlink" title="æ–¹æ³•3ï¼šæ”¹è¿›ç‰ˆï¼ˆæ”¹è¿›åé€’å½’å®ç°ï¼‰"></a>æ–¹æ³•3ï¼šæ”¹è¿›ç‰ˆï¼ˆæ”¹è¿›åé€’å½’å®ç°ï¼‰</h5><p>é’ˆå¯¹ä¸Šé¢å‡ ä¸ªå¾…è§£å†³é—®é¢˜ï¼Œæˆ‘å…ˆé€šè¿‡å››ç‚¹ç›¸å…³çš„ç†è®ºå‘Šè¯‰ä½ åˆ†åˆ«åº”è¯¥æ€ä¹ˆåšã€‚</p>
<ul>
<li>é’ˆå¯¹èƒ½å¤Ÿéå†å¯¹è±¡çš„ä¸å¯æšä¸¾å±æ€§ä»¥åŠ Symbol ç±»å‹ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ Reflect.ownKeys æ–¹æ³•ï¼›</li>
<li>å½“å‚æ•°ä¸º Dateã€RegExp ç±»å‹ï¼Œåˆ™ç›´æ¥ç”Ÿæˆä¸€ä¸ªæ–°çš„å®ä¾‹è¿”å›ï¼›</li>
<li>åˆ©ç”¨ Object çš„ getOwnPropertyDescriptors æ–¹æ³•å¯ä»¥è·å¾—å¯¹è±¡çš„æ‰€æœ‰å±æ€§ï¼Œä»¥åŠå¯¹åº”çš„ç‰¹æ€§ï¼Œé¡ºä¾¿ç»“åˆ Object çš„ create æ–¹æ³•åˆ›å»ºä¸€ä¸ªæ–°å¯¹è±¡ï¼Œå¹¶ç»§æ‰¿ä¼ å…¥åŸå¯¹è±¡çš„åŸå‹é“¾ï¼›</li>
<li>åˆ©ç”¨ WeakMap ç±»å‹ä½œä¸º Hash è¡¨ï¼Œå› ä¸º WeakMap æ˜¯å¼±å¼•ç”¨ç±»å‹ï¼Œå¯ä»¥æœ‰æ•ˆé˜²æ­¢å†…å­˜æ³„æ¼ï¼ˆä½ å¯ä»¥å…³æ³¨ä¸€ä¸‹ Map å’Œ weakMap çš„å…³é”®åŒºåˆ«ï¼Œè¿™é‡Œè¦ç”¨ weakMapï¼‰ï¼Œä½œä¸ºæ£€æµ‹å¾ªç¯å¼•ç”¨å¾ˆæœ‰å¸®åŠ©ï¼Œå¦‚æœå­˜åœ¨å¾ªç¯ï¼Œåˆ™å¼•ç”¨ç›´æ¥è¿”å› WeakMap å­˜å‚¨çš„å€¼ã€‚</li>
</ul>
<p>é‚£ä¹ˆé’ˆå¯¹ä¸Šé¢è¿™å‡ ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬æ¥çœ‹ä¸‹æ”¹è¿›åçš„é€’å½’å®ç°çš„æ·±æ‹·è´ä»£ç åº”è¯¥æ˜¯ä»€ä¹ˆæ ·å­çš„ï¼Œå¦‚ä¸‹æ‰€ç¤ºã€‚</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title function_">isComplexDataType</span> = obj =&gt; (<span class="keyword">typeof</span> obj === <span class="string">&#x27;object&#x27;</span> || <span class="keyword">typeof</span> obj === <span class="string">&#x27;function&#x27;</span>) &amp;&amp; (obj !== <span class="literal">null</span>)</span><br><span class="line"><span class="keyword">const</span> deepClone = <span class="keyword">function</span> (<span class="params">obj, hash = <span class="keyword">new</span> <span class="built_in">WeakMap</span>()</span>) &#123;</span><br><span class="line">  <span class="keyword">if</span> (obj.<span class="property">constructor</span> === <span class="title class_">Date</span>) </span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Date</span>(obj)       <span class="comment">// æ—¥æœŸå¯¹è±¡ç›´æ¥è¿”å›ä¸€ä¸ªæ–°çš„æ—¥æœŸå¯¹è±¡</span></span><br><span class="line">  <span class="keyword">if</span> (obj.<span class="property">constructor</span> === <span class="title class_">RegExp</span>)</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">RegExp</span>(obj)     <span class="comment">//æ­£åˆ™å¯¹è±¡ç›´æ¥è¿”å›ä¸€ä¸ªæ–°çš„æ­£åˆ™å¯¹è±¡</span></span><br><span class="line">  <span class="comment">//å¦‚æœå¾ªç¯å¼•ç”¨äº†å°±ç”¨ weakMap æ¥è§£å†³</span></span><br><span class="line">  <span class="keyword">if</span> (hash.<span class="title function_">has</span>(obj)) <span class="keyword">return</span> hash.<span class="title function_">get</span>(obj)</span><br><span class="line">  <span class="keyword">let</span> allDesc = <span class="title class_">Object</span>.<span class="title function_">getOwnPropertyDescriptors</span>(obj)</span><br><span class="line">  <span class="comment">//éå†ä¼ å…¥å‚æ•°æ‰€æœ‰é”®çš„ç‰¹æ€§</span></span><br><span class="line">  <span class="keyword">let</span> cloneObj = <span class="title class_">Object</span>.<span class="title function_">create</span>(<span class="title class_">Object</span>.<span class="title function_">getPrototypeOf</span>(obj), allDesc)</span><br><span class="line">  <span class="comment">//ç»§æ‰¿åŸå‹é“¾</span></span><br><span class="line">  hash.<span class="title function_">set</span>(obj, cloneObj)</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> key <span class="keyword">of</span> <span class="title class_">Reflect</span>.<span class="title function_">ownKeys</span>(obj)) &#123; </span><br><span class="line">    cloneObj[key] = (<span class="title function_">isComplexDataType</span>(obj[key]) &amp;&amp; <span class="keyword">typeof</span> obj[key] !== <span class="string">&#x27;function&#x27;</span>) ? <span class="title function_">deepClone</span>(obj[key], hash) : obj[key]</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> cloneObj</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// ä¸‹é¢æ˜¯éªŒè¯ä»£ç </span></span><br><span class="line"><span class="keyword">let</span> obj = &#123;</span><br><span class="line">  <span class="attr">num</span>: <span class="number">0</span>,</span><br><span class="line">  <span class="attr">str</span>: <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">  <span class="attr">boolean</span>: <span class="literal">true</span>,</span><br><span class="line">  <span class="attr">unf</span>: <span class="literal">undefined</span>,</span><br><span class="line">  <span class="attr">nul</span>: <span class="literal">null</span>,</span><br><span class="line">  <span class="attr">obj</span>: &#123; <span class="attr">name</span>: <span class="string">&#x27;æˆ‘æ˜¯ä¸€ä¸ªå¯¹è±¡&#x27;</span>, <span class="attr">id</span>: <span class="number">1</span> &#125;,</span><br><span class="line">  <span class="attr">arr</span>: [<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>],</span><br><span class="line">  <span class="attr">func</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123; <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;æˆ‘æ˜¯ä¸€ä¸ªå‡½æ•°&#x27;</span>) &#125;,</span><br><span class="line">  <span class="attr">date</span>: <span class="keyword">new</span> <span class="title class_">Date</span>(<span class="number">0</span>),</span><br><span class="line">  <span class="attr">reg</span>: <span class="keyword">new</span> <span class="title class_">RegExp</span>(<span class="string">&#x27;/æˆ‘æ˜¯ä¸€ä¸ªæ­£åˆ™/ig&#x27;</span>),</span><br><span class="line">  [<span class="title class_">Symbol</span>(<span class="string">&#x27;1&#x27;</span>)]: <span class="number">1</span>,</span><br><span class="line">&#125;;</span><br><span class="line"><span class="title class_">Object</span>.<span class="title function_">defineProperty</span>(obj, <span class="string">&#x27;innumerable&#x27;</span>, &#123;</span><br><span class="line">  <span class="attr">enumerable</span>: <span class="literal">false</span>, <span class="attr">value</span>: <span class="string">&#x27;ä¸å¯æšä¸¾å±æ€§&#x27;</span> &#125;</span><br><span class="line">);</span><br><span class="line">obj = <span class="title class_">Object</span>.<span class="title function_">create</span>(obj, <span class="title class_">Object</span>.<span class="title function_">getOwnPropertyDescriptors</span>(obj))</span><br><span class="line">obj.<span class="property">loop</span> = obj    <span class="comment">// è®¾ç½®loopæˆå¾ªç¯å¼•ç”¨çš„å±æ€§</span></span><br><span class="line"><span class="keyword">let</span> cloneObj = <span class="title function_">deepClone</span>(obj)</span><br><span class="line">cloneObj.<span class="property">arr</span>.<span class="title function_">push</span>(<span class="number">4</span>)</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;obj&#x27;</span>, obj)</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;cloneObj&#x27;</span>, cloneObj)</span><br></pre></td></tr></table></figure>
<p>æˆ‘ä»¬çœ‹ä¸€ä¸‹ç»“æœï¼ŒcloneObj åœ¨ obj çš„åŸºç¡€ä¸Šè¿›è¡Œäº†ä¸€æ¬¡æ·±æ‹·è´ï¼ŒcloneObj é‡Œçš„ arr æ•°ç»„è¿›è¡Œäº†ä¿®æ”¹ï¼Œå¹¶æœªå½±å“åˆ° obj.arr çš„å˜åŒ–ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚<br><img src="/posts/2541eeff/3.png" alt="å±•ç¤ºç»“æœ"><br>ä»è¿™å¼ æˆªå›¾çš„ç»“æœå¯ä»¥çœ‹å‡ºï¼Œæ”¹è¿›ç‰ˆçš„ deepClone å‡½æ•°å·²ç»å¯¹åŸºç¡€ç‰ˆçš„é‚£å‡ ä¸ªé—®é¢˜è¿›è¡Œäº†æ”¹è¿›ï¼Œä¹ŸéªŒè¯äº†æˆ‘ä¸Šé¢æåˆ°çš„é‚£å››ç‚¹ç†è®ºã€‚</p>
<h3 id="JSå¸¸è§çš„6ç§ç»§æ‰¿æ–¹å¼"><a href="#JSå¸¸è§çš„6ç§ç»§æ‰¿æ–¹å¼" class="headerlink" title="JSå¸¸è§çš„6ç§ç»§æ‰¿æ–¹å¼"></a>JSå¸¸è§çš„6ç§ç»§æ‰¿æ–¹å¼</h3><p>åœ¨å­¦ä¹ ç»§æ‰¿ä¹‹å‰ï¼Œå…ˆäº†è§£åŸå‹é“¾ï¼Œä¾¿äºæ›´å¥½çš„ç†è§£<br><img src="/posts/2541eeff/4.png" alt="åŸå‹é“¾"></p>
<h4 id="åŸå‹é“¾ç»§æ‰¿"><a href="#åŸå‹é“¾ç»§æ‰¿" class="headerlink" title="åŸå‹é“¾ç»§æ‰¿"></a>åŸå‹é“¾ç»§æ‰¿</h4><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="comment">// åŸå‹é“¾ç»§æ‰¿</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">Person</span> ()&#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">name</span> = <span class="string">&quot;zs&quot;</span>;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">age</span> = <span class="number">20</span>;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">play</span> = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">Child</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">type</span>= <span class="string">&#x27;child2&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title class_">Child</span>.<span class="property"><span class="keyword">prototype</span></span> = <span class="keyword">new</span> <span class="title class_">Person</span>();</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="keyword">new</span> <span class="title class_">Child</span>())</span><br></pre></td></tr></table></figure>
<p>åŸå‹é“¾ç»§æ‰¿æ–¹å¼ä¹Ÿæ˜¯æœ‰ç¼ºç‚¹çš„ï¼Œå¦‚ä¸‹ä»£ç ï¼š</p>
<figure class="highlight arcade"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> s1 = <span class="keyword">new</span> Child();</span><br><span class="line"><span class="keyword">var</span> s2 = <span class="keyword">new</span> Child();</span><br><span class="line">s1.play.<span class="built_in">push</span>(<span class="number">4</span>);</span><br><span class="line"><span class="built_in">console</span>.<span class="built_in">log</span>(s1.play, s2.play); <span class="comment">// [1,2,3,4]  [1,2,3,4]</span></span><br></pre></td></tr></table></figure>
<p>å› ä¸ºä¸¤ä¸ªå®ä¾‹ä½¿ç”¨çš„æ˜¯åŒä¸€ä¸ªåŸå‹å¯¹è±¡ã€‚å®ƒä»¬çš„å†…å­˜ç©ºé—´æ˜¯å…±äº«çš„ï¼Œå½“ä¸€ä¸ªå‘ç”Ÿå˜åŒ–çš„æ—¶å€™ï¼Œå¦å¤–ä¸€ä¸ªä¹Ÿéšä¹‹è¿›è¡Œäº†å˜åŒ–</p>
<h4 id="æ„é€ å‡½æ•°ç»§æ‰¿ï¼ˆå€ŸåŠ©-callï¼‰"><a href="#æ„é€ å‡½æ•°ç»§æ‰¿ï¼ˆå€ŸåŠ©-callï¼‰" class="headerlink" title="æ„é€ å‡½æ•°ç»§æ‰¿ï¼ˆå€ŸåŠ© callï¼‰"></a>æ„é€ å‡½æ•°ç»§æ‰¿ï¼ˆå€ŸåŠ© callï¼‰</h4><figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">Person</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">name</span> = <span class="string">&#x27;zs&#x27;</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">type</span>= [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>]</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">getAge</span> = <span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">`20å²`</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title class_">Person</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">getName</span> = <span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">name</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">Child</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="title class_">Person</span>.<span class="title function_">call</span>(<span class="variable language_">this</span>)</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">age</span> = <span class="number">100</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> s = <span class="keyword">new</span> <span class="title class_">Child</span>()</span><br><span class="line"><span class="keyword">let</span> s2 = <span class="keyword">new</span> <span class="title class_">Child</span>()</span><br><span class="line">s.<span class="property">type</span>.<span class="title function_">push</span>(<span class="number">4</span>)</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(s,s2)</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(s.<span class="title function_">getName</span>())  <span class="comment">// æŠ¥é”™ s.getName is not a function</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(s.<span class="title function_">getAge</span>())  <span class="comment">// 20å²</span></span><br></pre></td></tr></table></figure>
<p>ä»ä¸Šé¢çš„ç»“æœå°±å¯ä»¥çœ‹åˆ°æ„é€ å‡½æ•°å®ç°ç»§æ‰¿çš„ä¼˜ç¼ºç‚¹ï¼Œå®ƒä½¿çˆ¶ç±»çš„å¼•ç”¨å±æ€§ä¸ä¼šè¢«å…±äº«ï¼Œä¼˜åŒ–äº†ç¬¬ä¸€ç§ç»§æ‰¿æ–¹å¼çš„å¼Šç«¯ï¼›ä½†æ˜¯éšä¹‹è€Œæ¥çš„ç¼ºç‚¹ä¹Ÿæ¯”è¾ƒæ˜æ˜¾â€”â€”<code>åªèƒ½</code>ç»§æ‰¿çˆ¶ç±»çš„å®ä¾‹å±æ€§å’Œæ–¹æ³•ï¼Œ<code>ä¸èƒ½</code>ç»§æ‰¿åŸå‹å±æ€§æˆ–è€…æ–¹æ³•</p>
<h4 id="ç»„åˆç»§æ‰¿ï¼ˆå‰ä¸¤ç§ç»„åˆï¼‰"><a href="#ç»„åˆç»§æ‰¿ï¼ˆå‰ä¸¤ç§ç»„åˆï¼‰" class="headerlink" title="ç»„åˆç»§æ‰¿ï¼ˆå‰ä¸¤ç§ç»„åˆï¼‰"></a>ç»„åˆç»§æ‰¿ï¼ˆå‰ä¸¤ç§ç»„åˆï¼‰</h4><p>è¿™ç§æ–¹å¼ç»“åˆäº†å‰ä¸¤ç§ç»§æ‰¿æ–¹å¼çš„ä¼˜ç¼ºç‚¹ï¼Œç»“åˆèµ·æ¥çš„ç»§æ‰¿</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">Person</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">name</span> = <span class="string">&#x27;zs&#x27;</span>,</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">arr</span> = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>]</span><br><span class="line">&#125;</span><br><span class="line"><span class="title class_">Person</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">getName</span> = <span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">name</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">Child</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="comment">// ç¬¬äºŒæ¬¡è°ƒç”¨ Person()</span></span><br><span class="line">    <span class="title class_">Person</span>.<span class="title function_">call</span>(<span class="variable language_">this</span>)</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">type</span> = <span class="string">&quot;child&quot;</span></span><br><span class="line">&#125;</span><br><span class="line">  <span class="comment">// ç¬¬ä¸€æ¬¡è°ƒç”¨ Person()</span></span><br><span class="line"><span class="title class_">Child</span>.<span class="property"><span class="keyword">prototype</span></span> = <span class="keyword">new</span> <span class="title class_">Person</span>()</span><br><span class="line"><span class="comment">// æ‰‹åŠ¨æŒ‚ä¸Šæ„é€ å™¨ï¼ŒæŒ‡å‘è‡ªå·±çš„æ„é€ å‡½æ•°</span></span><br><span class="line"><span class="title class_">Child</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">constructor</span> = <span class="title class_">Child</span></span><br><span class="line"><span class="keyword">let</span> s = <span class="keyword">new</span> <span class="title class_">Child</span>()</span><br><span class="line"><span class="keyword">let</span> s2 = <span class="keyword">new</span> <span class="title class_">Child</span>()</span><br><span class="line">s.<span class="property">arr</span>.<span class="title function_">push</span>(<span class="number">4</span>)</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(s.<span class="property">arr</span>,s2.<span class="property">arr</span>) <span class="comment">// [1, 2, 3, 4]  Â [1, 2, 3]</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(s.<span class="title function_">getName</span>());  <span class="comment">// zs</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(s2.<span class="title function_">getName</span>()); <span class="comment">// zs</span></span><br></pre></td></tr></table></figure>
<p>ä»<code>ç»„åˆç»§æ‰¿</code>æ‰“å°çš„ç»“æœå¯ä»¥çœ‹å‡ºï¼Œä¸Šé¢<code>åŸå‹é“¾ç»§æ‰¿</code>å’Œ<code>æ„é€ å‡½æ•°ç»§æ‰¿</code>çš„é—®é¢˜éƒ½å¾—ä»¥è§£å†³ï¼Œä½†æ˜¯æœ‰ä¸ªæ–°çš„é—®é¢˜æ˜¯ï¼Œ<code>Person</code>æ‰§è¡Œäº†ä¸¤æ¬¡ï¼Œ<code>ç¬¬ä¸€æ¬¡</code>æ”¹å˜<code>Child</code>çš„<code>prototype</code>çš„æ—¶å€™ï¼Œ<code>ç¬¬äºŒæ¬¡</code>æ˜¯é€šè¿‡<code>call</code>è°ƒç”¨<code>Person</code>çš„æ—¶å€™ï¼Œ<code>Person</code>å¤šæ„é€ ä¸€æ¬¡å°±å¤šè¿›è¡Œä¸€æ¬¡æ€§èƒ½å¼€é”€ï¼Œè¿™æ˜¯ä¸€ä¸ªç¼ºç‚¹ã€‚</p>
<h4 id="åŸå‹å¼ç»§æ‰¿"><a href="#åŸå‹å¼ç»§æ‰¿" class="headerlink" title="åŸå‹å¼ç»§æ‰¿"></a>åŸå‹å¼ç»§æ‰¿</h4><p>é€šè¿‡ES5 é‡Œé¢çš„ <code>Object.create</code>æ–¹æ³•ï¼Œè¿™ä¸ªæ–¹æ³•æ¥æ”¶ä¸¤ä¸ªå‚æ•°ï¼š<code>å‚æ•°1</code>ï¼šç”¨ä½œæ–°å¯¹è±¡åŸå‹çš„å¯¹è±¡ã€<code>å‚æ•°2</code>ï¼šä¸ºæ–°å¯¹è±¡å®šä¹‰é¢å¤–å±æ€§çš„å¯¹è±¡ï¼ˆå¯é€‰å‚æ•°ï¼‰</p>
<figure class="highlight pgsql"><table><tr><td class="code"><pre><span class="line">let parent4 = &#123;</span><br><span class="line">  <span class="type">name</span>: &quot;parent4&quot;,</span><br><span class="line">  friends: [&quot;p1&quot;, &quot;p2&quot;, &quot;p3&quot;],</span><br><span class="line">  getName: <span class="keyword">function</span> () &#123;</span><br><span class="line">      <span class="keyword">return</span> this.name;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">let p = <span class="keyword">Object</span>.<span class="keyword">create</span>(parent4);</span><br><span class="line">p.name = &quot;tom&quot;;</span><br><span class="line">p.friends.push(&quot;jerry&quot;);</span><br><span class="line"></span><br><span class="line">let p2 = <span class="keyword">Object</span>.<span class="keyword">create</span>(parent4);</span><br><span class="line">p2.friends.push(&quot;lucy&quot;);</span><br><span class="line"></span><br><span class="line">console.log(p.name);  // tom</span><br><span class="line">console.log(p.name === p.getName());  // <span class="keyword">true</span></span><br><span class="line">console.log(p.name);  // parent4</span><br><span class="line">console.log(p.friends); // Â [&quot;p1&quot;, &quot;p2&quot;, &quot;p3&quot;, &quot;jerry&quot;, &quot;lucy&quot;]</span><br><span class="line">console.log(p2.friends); // Â [&quot;p1&quot;, &quot;p2&quot;, &quot;p3&quot;, &quot;jerry&quot;, &quot;lucy&quot;] </span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>åä¸¤ä¸ªè¾“å‡ºç»“æœæ˜¯ä¸€æ ·çš„ï¼Œå¯ä»¥è”æƒ³åˆ°ä¸Šé¢çš„æµ…æ‹·è´çš„çŸ¥è¯†ç‚¹ï¼Œå…³äºå¼•ç”¨æ•°æ®ç±»å‹<code>â€œå…±äº«â€</code>çš„é—®é¢˜ï¼Œå…¶å®<code>Object.create</code>æ–¹æ³•æ˜¯å¯ä»¥ä¸ºä¸€äº›å¯¹è±¡å®ç°æµ…æ‹·è´çš„ï¼Œå…³äºè¿™ç§ç»§æ‰¿æ–¹å¼çš„ç¼ºç‚¹ä¹Ÿå¾ˆæ˜æ˜¾ï¼Œå¤šä¸ªå®ä¾‹çš„å¼•ç”¨ç±»å‹å±æ€§æŒ‡å‘ç›¸åŒçš„å†…å­˜ï¼Œå­˜åœ¨ç¯¡æ”¹çš„å¯èƒ½ã€‚</p>
<h4 id="å¯„ç”Ÿå¼ç»§æ‰¿"><a href="#å¯„ç”Ÿå¼ç»§æ‰¿" class="headerlink" title="å¯„ç”Ÿå¼ç»§æ‰¿"></a>å¯„ç”Ÿå¼ç»§æ‰¿</h4><p>ä¸Šé¢ä½¿ç”¨åŸå‹å¼ç»§æ‰¿å¯ä»¥è·å¾—ä¸€ä»½ç›®æ ‡å¯¹è±¡çš„æµ…æ‹·è´ï¼Œç„¶ååˆ©ç”¨è¿™ä¸ªæµ…æ‹·è´çš„èƒ½åŠ›å†è¿›è¡Œå¢å¼ºï¼Œæ·»åŠ ä¸€äº›æ–¹æ³•ï¼Œè¿™æ ·çš„ç»§æ‰¿æ–¹å¼å°±å«ä½œ<code>å¯„ç”Ÿå¼ç»§æ‰¿</code></p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">let</span> parent5 = &#123;</span><br><span class="line">    <span class="attr">name</span>: <span class="string">&quot;parent5&quot;</span>,</span><br><span class="line">    <span class="attr">friends</span>: [<span class="string">&quot;p1&quot;</span>, <span class="string">&quot;p2&quot;</span>, <span class="string">&quot;p3&quot;</span>],</span><br><span class="line">    <span class="attr">getName</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">name</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">clone</span>(<span class="params">original</span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> clone = <span class="title class_">Object</span>.<span class="title function_">create</span>(original);</span><br><span class="line">    clone.<span class="property">getFriends</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">friends</span>;</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="keyword">return</span> clone;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> p = <span class="title function_">clone</span>(parent5);</span><br><span class="line"></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(p.<span class="title function_">getName</span>());    <span class="comment">// parent5</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(p.<span class="title function_">getFriends</span>()); <span class="comment">// [&quot;p1&quot;, &quot;p2&quot;, &quot;p3&quot;]</span></span><br></pre></td></tr></table></figure>
<p>é€šè¿‡ä¸Šé¢è¿™æ®µä»£ç å¯ä»¥çœ‹åˆ° p æ˜¯é€šè¿‡å¯„ç”Ÿå¼ç»§æ‰¿ç”Ÿæˆçš„å®ä¾‹ï¼Œå®ƒä¸ä»…ä»…æœ‰ getName çš„æ–¹æ³•ï¼Œè€Œä¸”å¯ä»¥çœ‹åˆ°å®ƒæœ€åä¹Ÿæ‹¥æœ‰äº† getFriends çš„æ–¹æ³•ï¼Œä»æœ€åçš„è¾“å‡ºç»“æœä¸­å¯ä»¥çœ‹åˆ°ï¼Œp é€šè¿‡cloneçš„æ–¹æ³•ï¼Œå¢åŠ äº† getFriends çš„æ–¹æ³•ï¼Œä»è€Œä½¿ p è¿™ä¸ªæ™®é€šå¯¹è±¡åœ¨ç»§æ‰¿è¿‡ç¨‹ä¸­åˆå¢åŠ äº†ä¸€ä¸ªæ–¹æ³•ï¼Œè¿™æ ·çš„ç»§æ‰¿æ–¹å¼å°±æ˜¯å¯„ç”Ÿå¼ç»§æ‰¿ã€‚æˆ‘åœ¨ä¸Šé¢ç¬¬ä¸‰ç§ç»„åˆç»§æ‰¿æ–¹å¼ä¸­æåˆ°äº†ä¸€äº›å¼Šç«¯ï¼Œå³ä¸¤æ¬¡è°ƒç”¨çˆ¶ç±»çš„æ„é€ å‡½æ•°é€ æˆæµªè´¹ï¼Œä¸‹é¢è¦ä»‹ç»çš„å¯„ç”Ÿç»„åˆç»§æ‰¿å°±å¯ä»¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚</p>
<h4 id="å¯„ç”Ÿç»„åˆå¼ç»§æ‰¿"><a href="#å¯„ç”Ÿç»„åˆå¼ç»§æ‰¿" class="headerlink" title="å¯„ç”Ÿç»„åˆå¼ç»§æ‰¿"></a>å¯„ç”Ÿç»„åˆå¼ç»§æ‰¿</h4><p>ç»“åˆä¸Šé¢<code>å¯„ç”Ÿå¼ç»§æ‰¿</code>ä¸­æåŠçš„ç»§æ‰¿æ–¹å¼ï¼Œè§£å†³æ™®é€šå¯¹è±¡çš„ç»§æ‰¿é—®é¢˜çš„<code>Object.create</code>æ–¹æ³•ï¼Œæˆ‘ä»¬åœ¨å‰é¢è¿™å‡ ç§ç»§æ‰¿æ–¹å¼çš„ä¼˜ç¼ºç‚¹åŸºç¡€ä¸Šè¿›è¡Œæ”¹é€ ï¼Œå¾—å‡ºäº†å¯„ç”Ÿç»„åˆå¼çš„ç»§æ‰¿æ–¹å¼ï¼Œ<code>è¿™ä¹Ÿæ˜¯æ‰€æœ‰ç»§æ‰¿æ–¹å¼é‡Œé¢ç›¸å¯¹æœ€ä¼˜çš„ç»§æ‰¿æ–¹å¼</code>ã€‚</p>
<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">clone</span> (parent, child) &#123;</span><br><span class="line">  <span class="comment">// è¿™é‡Œæ”¹ç”¨ Object.create å°±å¯ä»¥å‡å°‘ç»„åˆç»§æ‰¿ä¸­å¤šè¿›è¡Œä¸€æ¬¡æ„é€ çš„è¿‡ç¨‹</span></span><br><span class="line">  child.<span class="property"><span class="keyword">prototype</span></span> = <span class="title class_">Object</span>.<span class="title function_">create</span>(parent.<span class="property"><span class="keyword">prototype</span></span>);</span><br><span class="line">  child.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">constructor</span> = child;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">Parent6</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">name</span> = <span class="string">&#x27;parent6&#x27;</span>;</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">play</span> = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>];</span><br><span class="line">&#125;</span><br><span class="line"><span class="title class_">Parent6</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">getName</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">name</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">Child6</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="title class_">Parent6</span>.<span class="title function_">call</span>(<span class="variable language_">this</span>);</span><br><span class="line">  <span class="variable language_">this</span>.<span class="property">friends</span> = <span class="string">&#x27;child5&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">clone</span>(<span class="title class_">Parent6</span>, <span class="title class_">Child6</span>);</span><br><span class="line"></span><br><span class="line"><span class="title class_">Child6</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">getFriends</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="variable language_">this</span>.<span class="property">friends</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">let</span> person6 = <span class="keyword">new</span> <span class="title class_">Child6</span>();</span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(person6);  <span class="comment">// &#123;friends: &quot;child5&quot;,name: &quot;parent6&quot;,play: (3) [1, 2, 3]&#125;</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(person6.<span class="title function_">getName</span>());  <span class="comment">// parent6</span></span><br><span class="line"><span class="variable language_">console</span>.<span class="title function_">log</span>(person6.<span class="title function_">getFriends</span>()); <span class="comment">// child5</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>é€šè¿‡è¿™æ®µä»£ç å¯ä»¥çœ‹å‡ºæ¥ï¼Œè¿™ç§å¯„ç”Ÿç»„åˆå¼ç»§æ‰¿æ–¹å¼ï¼ŒåŸºæœ¬å¯ä»¥è§£å†³å‰å‡ ç§ç»§æ‰¿æ–¹å¼çš„ç¼ºç‚¹ï¼Œè¾ƒå¥½åœ°å®ç°äº†ç»§æ‰¿æƒ³è¦çš„ç»“æœï¼ŒåŒæ—¶ä¹Ÿå‡å°‘äº†æ„é€ æ¬¡æ•°ï¼Œå‡å°‘äº†æ€§èƒ½çš„å¼€é”€ï¼Œå¯ä»¥çœ‹åˆ° person6 æ‰“å°å‡ºæ¥çš„ç»“æœï¼Œå±æ€§éƒ½å¾—åˆ°äº†ç»§æ‰¿ï¼Œæ–¹æ³•ä¹Ÿæ²¡é—®é¢˜ï¼Œå¯ä»¥è¾“å‡ºé¢„æœŸçš„ç»“æœã€‚<br>æ•´ä½“çœ‹ä¸‹æ¥ï¼Œè¿™å…­ç§ç»§æ‰¿æ–¹å¼ä¸­ï¼Œå¯„ç”Ÿç»„åˆå¼ç»§æ‰¿æ˜¯è¿™å…­ç§é‡Œé¢æœ€ä¼˜çš„ç»§æ‰¿æ–¹å¼ã€‚å¦å¤–ï¼ŒES6 è¿˜æä¾›äº†ç»§æ‰¿çš„å…³é”®å­— extendsï¼Œæˆ‘ä»¬å†çœ‹ä¸‹ extends çš„åº•å±‚å®ç°ç»§æ‰¿çš„é€»è¾‘ã€‚</p>
<h4 id="ES6çš„extendsç»§æ‰¿"><a href="#ES6çš„extendsç»§æ‰¿" class="headerlink" title="ES6çš„extendsç»§æ‰¿"></a>ES6çš„extendsç»§æ‰¿</h4><p>åˆ©ç”¨ ES6 é‡Œçš„ extends çš„è¯­æ³•ç³–ï¼Œä½¿ç”¨å…³é”®è¯å¾ˆå®¹æ˜“ç›´æ¥å®ç° JavaScript çš„ç»§æ‰¿ï¼Œä½†æ˜¯å¦‚æœæƒ³æ·±å…¥äº†è§£ extends è¯­æ³•ç³–æ˜¯æ€ä¹ˆå®ç°çš„ï¼Œå°±å¾—æ·±å…¥ç ”ç©¶ extends çš„åº•å±‚é€»è¾‘ï¼Œæˆ‘ä»¬å…ˆçœ‹ä¸‹ç”¨åˆ©ç”¨ extends å¦‚ä½•ç›´æ¥å®ç°ç»§æ‰¿ã€‚</p>
<figure class="highlight scala"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span> </span>&#123;</span><br><span class="line">  constructor(name) &#123;</span><br><span class="line">    <span class="keyword">this</span>.name = name</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// åŸå‹æ–¹æ³•</span></span><br><span class="line">  <span class="comment">// å³ Person.prototype.getName = function() &#123; &#125;</span></span><br><span class="line">  <span class="comment">// ä¸‹é¢å¯ä»¥ç®€å†™ä¸º getName() &#123;...&#125;</span></span><br><span class="line">  getName = function () &#123;</span><br><span class="line">    console.log(&#x27;<span class="type">Person</span>:&#x27;, <span class="keyword">this</span>.name)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Gamer</span> <span class="keyword">extends</span> <span class="title">Person</span> </span>&#123;</span><br><span class="line">  constructor(name, age) &#123;</span><br><span class="line">    <span class="comment">// å­ç±»ä¸­å­˜åœ¨æ„é€ å‡½æ•°ï¼Œåˆ™éœ€è¦åœ¨ä½¿ç”¨â€œthisâ€ä¹‹å‰é¦–å…ˆè°ƒç”¨ super()ã€‚</span></span><br><span class="line">    <span class="keyword">super</span>(name)</span><br><span class="line">    <span class="keyword">this</span>.age = age</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">const asuna = <span class="keyword">new</span> <span class="type">Gamer</span>(&#x27;<span class="type">Asuna</span>&#x27;, <span class="number">20</span>)</span><br><span class="line">asuna.getName() <span class="comment">// æˆåŠŸè®¿é—®åˆ°çˆ¶ç±»çš„æ–¹æ³•</span></span><br></pre></td></tr></table></figure>
<p>å› ä¸ºæµè§ˆå™¨çš„å…¼å®¹æ€§é—®é¢˜ï¼Œå¦‚æœé‡åˆ°ä¸æ”¯æŒ ES6 çš„æµè§ˆå™¨ï¼Œé‚£ä¹ˆå°±å¾—åˆ©ç”¨ babel è¿™ä¸ªç¼–è¯‘å·¥å…·ï¼Œå°† ES6 çš„ä»£ç ç¼–è¯‘æˆ ES5ï¼Œè®©ä¸€äº›ä¸æ”¯æŒæ–°è¯­æ³•çš„æµè§ˆå™¨ä¹Ÿèƒ½è¿è¡Œã€‚<br>é‚£ä¹ˆæœ€å extends ç¼–è¯‘æˆäº†ä»€ä¹ˆæ ·å­å‘¢ï¼Ÿæˆ‘ä»¬çœ‹ä¸€ä¸‹è½¬è¯‘ä¹‹åçš„ä»£ç ç‰‡æ®µ</p>
<figure class="highlight qml"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">_possibleConstructorReturn</span> (<span class="params">self, call</span>) </span>&#123; </span><br><span class="line">		<span class="comment">// ...</span></span><br><span class="line">		<span class="keyword">return</span> call &amp;&amp; (<span class="keyword">typeof</span> call === <span class="string">&#x27;object&#x27;</span> || <span class="keyword">typeof</span> call === <span class="string">&#x27;function&#x27;</span>) ? <span class="attribute">call</span> : self; </span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">_inherits</span> (<span class="params">subClass, superClass</span>) </span>&#123; </span><br><span class="line">    <span class="comment">// è¿™é‡Œå¯ä»¥çœ‹åˆ°</span></span><br><span class="line">	subClass.prototype = <span class="built_in">Object</span>.create(superClass &amp;&amp; superClass.prototype, &#123; </span><br><span class="line">		<span class="attribute">constructor</span>: &#123; </span><br><span class="line">			<span class="attribute">value</span>: subClass, </span><br><span class="line">			<span class="attribute">enumerable</span>: <span class="literal">false</span>, </span><br><span class="line">			<span class="attribute">writable</span>: <span class="literal">true</span>, </span><br><span class="line">			<span class="attribute">configurable</span>: <span class="literal">true</span> </span><br><span class="line">		&#125; </span><br><span class="line">	&#125;); </span><br><span class="line">	<span class="keyword">if</span> (superClass) <span class="built_in">Object</span>.setPrototypeOf ? <span class="built_in">Object</span>.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> Parent = <span class="function"><span class="keyword">function</span> <span class="title">Parent</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">	<span class="comment">// éªŒè¯æ˜¯å¦æ˜¯ Parent æ„é€ å‡ºæ¥çš„ this</span></span><br><span class="line">	_classCallCheck(<span class="keyword">this</span>, Parent);</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">var</span> Child = (<span class="function"><span class="keyword">function</span> (<span class="params">_Parent</span>) </span>&#123;</span><br><span class="line">	_inherits(Child, _Parent);</span><br><span class="line">	<span class="function"><span class="keyword">function</span> <span class="title">Child</span> (<span class="params"></span>) </span>&#123;</span><br><span class="line">		_classCallCheck(<span class="keyword">this</span>, Child);</span><br><span class="line">		<span class="keyword">return</span> _possibleConstructorReturn(<span class="keyword">this</span>, (Child.__proto__ || <span class="built_in">Object</span>.getPrototypeOf(Child)).apply(<span class="keyword">this</span>, <span class="built_in">arguments</span>));</span><br><span class="line">&#125;</span><br><span class="line">	<span class="keyword">return</span> Child;</span><br><span class="line">&#125;(Parent));</span><br></pre></td></tr></table></figure>
<p>ä»ä¸Šé¢ç¼–è¯‘å®Œæˆçš„æºç ä¸­å¯ä»¥çœ‹åˆ°ï¼Œå®ƒé‡‡ç”¨çš„ä¹Ÿæ˜¯å¯„ç”Ÿç»„åˆç»§æ‰¿æ–¹å¼ï¼Œå› æ­¤ä¹Ÿè¯æ˜äº†è¿™ç§æ–¹å¼æ˜¯è¾ƒä¼˜çš„è§£å†³ç»§æ‰¿çš„æ–¹å¼ã€‚</p>
<h3 id="å®ç°newã€applyã€callã€bindçš„åº•å±‚é€»è¾‘"><a href="#å®ç°newã€applyã€callã€bindçš„åº•å±‚é€»è¾‘" class="headerlink" title="å®ç°newã€applyã€callã€bindçš„åº•å±‚é€»è¾‘"></a>å®ç°newã€applyã€callã€bindçš„åº•å±‚é€»è¾‘</h3><h4 id="newåŸç†ä»‹ç»"><a href="#newåŸç†ä»‹ç»" class="headerlink" title="newåŸç†ä»‹ç»"></a>newåŸç†ä»‹ç»</h4><p>new å…³é”®è¯çš„ä¸»è¦ä½œç”¨å°±æ˜¯æ‰§è¡Œä¸€ä¸ªæ„é€ å‡½æ•°ã€è¿”å›ä¸€ä¸ªå®ä¾‹å¯¹è±¡ï¼Œåœ¨ new çš„è¿‡ç¨‹ä¸­ï¼Œæ ¹æ®æ„é€ å‡½æ•°çš„æƒ…å†µï¼Œæ¥ç¡®å®šæ˜¯å¦å¯ä»¥æ¥å—å‚æ•°çš„ä¼ é€’</p>
<figure class="highlight arcade"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">Person</span>(<span class="params"></span>)&#123;</span><br><span class="line">   this.name = <span class="string">&#x27;Jack&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> p = <span class="keyword">new</span> Person(); </span><br><span class="line"><span class="built_in">console</span>.<span class="built_in">log</span>(p.name)  <span class="comment">// Jack</span></span><br></pre></td></tr></table></figure>
<p>å¤§è‡´åˆ†ä¸ºä»¥ä¸‹å‡ ä¸ªæ­¥éª¤:</p>
<ul>
<li>åˆ›å»ºä¸€ä¸ªæ–°å¯¹è±¡ï¼›</li>
<li>å°†æ„é€ å‡½æ•°çš„ä½œç”¨åŸŸèµ‹ç»™æ–°å¯¹è±¡ï¼ˆthis æŒ‡å‘æ–°å¯¹è±¡ï¼‰ï¼›</li>
<li>æ‰§è¡Œæ„é€ å‡½æ•°ä¸­çš„ä»£ç ï¼ˆä¸ºè¿™ä¸ªæ–°å¯¹è±¡æ·»åŠ å±æ€§ï¼‰ï¼›</li>
<li>è¿”å›æ–°å¯¹è±¡ã€‚</li>
</ul>
<p>ä¸‹é¢å¯¹æ„é€ å‡½æ•°ç¨å¾®æ”¹åŠ¨ä¸€ä¸‹ï¼Œç›´æ¥returnçœ‹ä¸‹ä¼šå‘ç”Ÿä»€ä¹ˆå˜åŒ–</p>
<figure class="highlight arcade"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">Person</span>(<span class="params"></span>)&#123;</span><br><span class="line">   this.name = <span class="string">&#x27;Jack&#x27;</span>; </span><br><span class="line">   <span class="keyword">return</span> &#123;<span class="attr">age</span>: <span class="number">18</span>&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> p = <span class="keyword">new</span> Person(); </span><br><span class="line"><span class="built_in">console</span>.<span class="built_in">log</span>(p)  <span class="comment">// &#123;age: 18&#125;</span></span><br><span class="line"><span class="built_in">console</span>.<span class="built_in">log</span>(p.name) <span class="comment">// undefined</span></span><br><span class="line"><span class="built_in">console</span>.<span class="built_in">log</span>(p.age) <span class="comment">// 18</span></span><br></pre></td></tr></table></figure>
<p>å½“æ„é€ å‡½æ•°æœ€å return å‡ºæ¥çš„æ˜¯ä¸€ä¸ªå’Œ this æ— å…³çš„å¯¹è±¡æ—¶ï¼Œnew å‘½ä»¤ä¼šç›´æ¥è¿”å›è¿™ä¸ªæ–°å¯¹è±¡ï¼Œè€Œä¸æ˜¯é€šè¿‡ new æ‰§è¡Œæ­¥éª¤ç”Ÿæˆçš„ this å¯¹è±¡ã€‚</p>
<figure class="highlight arcade"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">Person</span>(<span class="params"></span>)&#123;</span><br><span class="line">   this.name = <span class="string">&#x27;Jack&#x27;</span>; </span><br><span class="line">   <span class="keyword">return</span> <span class="string">&#x27;tom&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">var</span> p = <span class="keyword">new</span> Person(); </span><br><span class="line"><span class="built_in">console</span>.<span class="built_in">log</span>(p)  <span class="comment">// &#123;name: &#x27;Jack&#x27;&#125;</span></span><br><span class="line"><span class="built_in">console</span>.<span class="built_in">log</span>(p.name) <span class="comment">// Jack</span></span><br></pre></td></tr></table></figure>
<p>å½“æ„é€ å‡½æ•°ä¸­ return çš„ä¸æ˜¯ä¸€ä¸ªå¯¹è±¡æ—¶ï¼Œé‚£ä¹ˆå®ƒè¿˜æ˜¯ä¼šæ ¹æ® new å…³é”®è¯çš„æ‰§è¡Œé€»è¾‘ï¼Œç”Ÿæˆä¸€ä¸ªæ–°çš„å¯¹è±¡ï¼ˆç»‘å®šäº†æœ€æ–° thisï¼‰ï¼Œæœ€åè¿”å›å‡ºæ¥ã€‚</p>
<blockquote>
<p>æ€»ç»“ï¼šnew å…³é”®è¯æ‰§è¡Œä¹‹åæ€»æ˜¯ä¼šè¿”å›ä¸€ä¸ªå¯¹è±¡ï¼Œè¦ä¹ˆæ˜¯å®ä¾‹å¯¹è±¡ï¼Œè¦ä¹ˆæ˜¯ return è¯­å¥æŒ‡å®šçš„å¯¹è±¡ã€‚</p>
</blockquote>
<h4 id="apply-amp-call-amp-bind-åŸç†ä»‹ç»"><a href="#apply-amp-call-amp-bind-åŸç†ä»‹ç»" class="headerlink" title="apply &amp; call &amp; bind åŸç†ä»‹ç»"></a>apply &amp; call &amp; bind åŸç†ä»‹ç»</h4><p>callã€apply å’Œ bind æ˜¯æŒ‚åœ¨ Function å¯¹è±¡ä¸Šçš„ä¸‰ä¸ªæ–¹æ³•ï¼Œè°ƒç”¨è¿™ä¸‰ä¸ªæ–¹æ³•çš„å¿…é¡»æ˜¯ä¸€ä¸ªå‡½æ•°ã€‚</p>
<figure class="highlight awk"><table><tr><td class="code"><pre><span class="line"><span class="regexp">//</span> åŸºæœ¬è¯­æ³•ï¼š</span><br><span class="line"><span class="keyword">func</span>.call(thisArg, param1, param2, ...)</span><br><span class="line"><span class="keyword">func</span>.apply(thisArg, [param1,param2,...])</span><br><span class="line"><span class="keyword">func</span>.bind(thisArg, param1, param2, ...)</span><br></pre></td></tr></table></figure>
<p>å…¶ä¸­ func æ˜¯è¦è°ƒç”¨çš„å‡½æ•°ï¼ŒthisArg ä¸€èˆ¬ä¸º this æ‰€æŒ‡å‘çš„å¯¹è±¡ï¼Œåé¢çš„ param1ã€2 ä¸ºå‡½æ•° func çš„å¤šä¸ªå‚æ•°ï¼Œå¦‚æœ func ä¸éœ€è¦å‚æ•°ï¼Œåˆ™åé¢çš„ param1ã€2 å¯ä»¥ä¸å†™ã€‚<br>è¿™ä¸‰ä¸ªæ–¹æ³•å…±æœ‰çš„ã€æ¯”è¾ƒæ˜æ˜¾çš„ä½œç”¨å°±æ˜¯ï¼Œéƒ½å¯ä»¥æ”¹å˜å‡½æ•° func çš„ this æŒ‡å‘ã€‚call å’Œ apply çš„åŒºåˆ«åœ¨äºï¼Œä¼ å‚çš„å†™æ³•ä¸åŒï¼šapply çš„ç¬¬ 2 ä¸ªå‚æ•°ä¸ºæ•°ç»„ï¼› call åˆ™æ˜¯ä»ç¬¬ 2 ä¸ªè‡³ç¬¬ N ä¸ªéƒ½æ˜¯ç»™ func çš„ä¼ å‚ï¼›è€Œ bind å’Œè¿™ä¸¤ä¸ªï¼ˆcallã€applyï¼‰åˆä¸åŒï¼Œbind è™½ç„¶æ”¹å˜äº† func çš„ this æŒ‡å‘ï¼Œä½†ä¸æ˜¯é©¬ä¸Šæ‰§è¡Œï¼Œè€Œè¿™ä¸¤ä¸ªï¼ˆcallã€applyï¼‰æ˜¯åœ¨æ”¹å˜äº†å‡½æ•°çš„ this æŒ‡å‘ä¹‹åç«‹é©¬æ‰§è¡Œã€‚</p>
<p>ä¸‹é¢ä¾‹å­åˆ†æï¼š</p>
<figure class="highlight arcade"><table><tr><td class="code"><pre><span class="line">let a = &#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="string">&#x27;jack&#x27;</span>,</span><br><span class="line">  <span class="attr">getName</span>: <span class="keyword">function</span>(<span class="params">msg</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> msg + this.name;</span><br><span class="line">  &#125; </span><br><span class="line">&#125;</span><br><span class="line">let b = &#123;</span><br><span class="line">  <span class="attr">name</span>: <span class="string">&#x27;lily&#x27;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">console</span>.<span class="built_in">log</span>(a.getName(<span class="string">&#x27;hello~&#x27;</span>));  <span class="comment">// hello~jack</span></span><br><span class="line"><span class="built_in">console</span>.<span class="built_in">log</span>(a.getName.call(b, <span class="string">&#x27;hi~&#x27;</span>));  <span class="comment">// hi~lily</span></span><br><span class="line"><span class="built_in">console</span>.<span class="built_in">log</span>(a.getName.apply(b, [<span class="string">&#x27;hi~&#x27;</span>]))  <span class="comment">// hi~lily</span></span><br><span class="line">let name = a.getName.bind(b, <span class="string">&#x27;hello~&#x27;</span>);</span><br><span class="line"><span class="built_in">console</span>.<span class="built_in">log</span>(name());  <span class="comment">// hello~lily</span></span><br></pre></td></tr></table></figure>
<p>A å¯¹è±¡æœ‰ä¸ª getName çš„æ–¹æ³•ï¼ŒB å¯¹è±¡ä¹Ÿéœ€è¦ä¸´æ—¶ä½¿ç”¨åŒæ ·çš„æ–¹æ³•ï¼Œé‚£ä¹ˆè¿™æ—¶å€™æˆ‘ä»¬æ˜¯å•ç‹¬ä¸º B å¯¹è±¡æ‰©å±•ä¸€ä¸ªæ–¹æ³•ï¼Œè¿˜æ˜¯å€Ÿç”¨ä¸€ä¸‹ A å¯¹è±¡çš„æ–¹æ³•å‘¢ï¼Ÿå½“ç„¶æ˜¯å¯ä»¥å€Ÿç”¨ A å¯¹è±¡çš„ getName æ–¹æ³•ï¼Œæ—¢è¾¾åˆ°äº†ç›®çš„ï¼ŒåˆèŠ‚çœé‡å¤å®šä¹‰ï¼ŒèŠ‚çº¦å†…å­˜ç©ºé—´ã€‚</p>
<h4 id="newçš„å®ç°"><a href="#newçš„å®ç°" class="headerlink" title="newçš„å®ç°"></a>newçš„å®ç°</h4><p>æ‰§è¡Œ new çš„è¿‡ç¨‹</p>
<ul>
<li>è®©å®ä¾‹å¯ä»¥è®¿é—®åˆ°ç§æœ‰å±æ€§</li>
<li>è®©å®ä¾‹å¯ä»¥è®¿é—®æ„é€ å‡½æ•°åŸå‹ï¼ˆconstructor.prototypeï¼‰æ‰€åœ¨åŸå‹é“¾ä¸Šçš„å±æ€§</li>
<li>æ„é€ å‡½æ•°è¿”å›çš„æœ€åç»“æœæ˜¯å¼•ç”¨æ•°æ®ç±»å‹<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">_new</span>(<span class="params">ctor, ...args</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="keyword">typeof</span> ctor !== <span class="string">&#x27;function&#x27;</span>) &#123;</span><br><span class="line">      <span class="keyword">throw</span> <span class="string">&#x27;ctor must be a function&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">let</span> obj = <span class="keyword">new</span> <span class="title class_">Object</span>();</span><br><span class="line">    obj.<span class="property">__proto__</span> = <span class="title class_">Object</span>.<span class="title function_">create</span>(ctor.<span class="property"><span class="keyword">prototype</span></span>);</span><br><span class="line">    <span class="keyword">let</span> res = ctor.<span class="title function_">apply</span>(obj,  [...args]);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> isObject = <span class="keyword">typeof</span> res === <span class="string">&#x27;object&#x27;</span> &amp;&amp; <span class="keyword">typeof</span> res !== <span class="literal">null</span>;</span><br><span class="line">    <span class="keyword">let</span> isFunction = <span class="keyword">typeof</span> res === <span class="string">&#x27;function&#x27;</span>;</span><br><span class="line">    <span class="keyword">return</span> isObect || isFunction ? res : obj;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h4 id="callçš„å®ç°"><a href="#callçš„å®ç°" class="headerlink" title="callçš„å®ç°"></a>callçš„å®ç°</h4><figure class="highlight actionscript"><table><tr><td class="code"><pre><span class="line">Function.prototype.call = <span class="keyword">function</span> <span class="params">(context, <span class="rest_arg">...args</span>)</span> &#123;</span><br><span class="line">  <span class="keyword">var</span> context = context || window;</span><br><span class="line">  context.fn = <span class="keyword">this</span>;</span><br><span class="line">  <span class="keyword">var</span> result = eval(<span class="string">&#x27;context.fn(...args)&#x27;</span>);</span><br><span class="line">  <span class="keyword">delete</span> context.fn</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="applyçš„å®ç°"><a href="#applyçš„å®ç°" class="headerlink" title="applyçš„å®ç°"></a>applyçš„å®ç°</h4><figure class="highlight actionscript"><table><tr><td class="code"><pre><span class="line">Function.prototype.call = <span class="keyword">function</span> <span class="params">(context, <span class="rest_arg">...args</span>)</span> &#123;</span><br><span class="line">  <span class="keyword">var</span> context = context || window;</span><br><span class="line">  context.fn = <span class="keyword">this</span>;</span><br><span class="line">  <span class="keyword">var</span> result = eval(<span class="string">&#x27;context.fn(...args)&#x27;</span>);</span><br><span class="line">  <span class="keyword">delete</span> context.fn</span><br><span class="line">  <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
å®ç° call å’Œ apply çš„å…³é”®å°±åœ¨ eval è¿™è¡Œä»£ç ã€‚å…¶ä¸­æ˜¾ç¤ºäº†ç”¨ context è¿™ä¸ªä¸´æ—¶å˜é‡æ¥æŒ‡å®šä¸Šä¸‹æ–‡ï¼Œç„¶åè¿˜æ˜¯é€šè¿‡æ‰§è¡Œ eval æ¥æ‰§è¡Œ context.fn è¿™ä¸ªå‡½æ•°ï¼Œæœ€åè¿”å› resultã€‚<h4 id="bindçš„å®ç°"><a href="#bindçš„å®ç°" class="headerlink" title="bindçš„å®ç°"></a>bindçš„å®ç°</h4>bind çš„å®ç°æ€è·¯åŸºæœ¬å’Œ apply ä¸€æ ·ï¼Œä½†æ˜¯åœ¨æœ€åå®ç°è¿”å›ç»“æœè¿™é‡Œï¼Œbind å’Œ apply æœ‰ç€æ¯”è¾ƒå¤§çš„å·®å¼‚ï¼Œbind ä¸éœ€è¦ç›´æ¥æ‰§è¡Œï¼Œå› æ­¤ä¸å†éœ€è¦ç”¨ eval ï¼Œè€Œæ˜¯éœ€è¦é€šè¿‡è¿”å›ä¸€ä¸ªå‡½æ•°çš„æ–¹å¼å°†ç»“æœè¿”å›ï¼Œä¹‹åå†é€šè¿‡æ‰§è¡Œè¿™ä¸ªç»“æœï¼Œå¾—åˆ°æƒ³è¦çš„æ‰§è¡Œæ•ˆæœã€‚<figure class="highlight actionscript"><table><tr><td class="code"><pre><span class="line">Function.prototype.bind = <span class="keyword">function</span> <span class="params">(context, <span class="rest_arg">...args</span>)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">typeof</span> <span class="keyword">this</span> !== <span class="string">&quot;function&quot;</span>) &#123;</span><br><span class="line">      <span class="keyword">throw</span> <span class="keyword">new</span> Error(<span class="string">&quot;this must be a function&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">var</span> self = <span class="keyword">this</span>;</span><br><span class="line">    <span class="keyword">var</span> fbound = <span class="keyword">function</span> <span class="params">()</span> &#123;</span><br><span class="line">        self.apply(<span class="keyword">this</span> <span class="keyword">instanceof</span> self ? <span class="keyword">this</span> : context, args.concat(Array.prototype.slice.call(arguments)));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(<span class="keyword">this</span>.prototype) &#123;</span><br><span class="line">      fbound.prototype = Object.create(<span class="keyword">this</span>.prototype);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> fbound;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
ä»ä¸Šé¢çš„ä»£ç ä¸­å¯ä»¥çœ‹åˆ°ï¼Œå®ç° bind çš„æ ¸å¿ƒåœ¨äºè¿”å›çš„æ—¶å€™éœ€è¦è¿”å›ä¸€ä¸ªå‡½æ•°ï¼Œæ•…è¿™é‡Œçš„ fbound éœ€è¦è¿”å›ï¼Œä½†æ˜¯åœ¨è¿”å›çš„è¿‡ç¨‹ä¸­åŸå‹é“¾å¯¹è±¡ä¸Šçš„å±æ€§ä¸èƒ½ä¸¢å¤±ã€‚å› æ­¤è¿™é‡Œéœ€è¦ç”¨Object.create æ–¹æ³•ï¼Œå°† this.prototype ä¸Šé¢çš„å±æ€§æŒ‚åˆ° fbound çš„åŸå‹ä¸Šé¢ï¼Œæœ€åå†è¿”å› fboundã€‚è¿™æ ·è°ƒç”¨ bind æ–¹æ³•æ¥æ”¶åˆ°å‡½æ•°çš„å¯¹è±¡ï¼Œå†é€šè¿‡æ‰§è¡Œæ¥æ”¶çš„å‡½æ•°ï¼Œå³å¯å¾—åˆ°æƒ³è¦çš„ç»“æœã€‚</li>
</ul>
<h3 id="é—­åŒ…"><a href="#é—­åŒ…" class="headerlink" title="é—­åŒ…"></a>é—­åŒ…</h3><h4 id="ä»€ä¹ˆæ˜¯é—­åŒ…ï¼Ÿ"><a href="#ä»€ä¹ˆæ˜¯é—­åŒ…ï¼Ÿ" class="headerlink" title="ä»€ä¹ˆæ˜¯é—­åŒ…ï¼Ÿ"></a>ä»€ä¹ˆæ˜¯é—­åŒ…ï¼Ÿ</h4><blockquote>
<p>çº¢å®ä¹¦é—­åŒ…çš„å®šä¹‰ï¼šé—­åŒ…æ˜¯æŒ‡æœ‰æƒè®¿é—®å¦å¤–ä¸€ä¸ªå‡½æ•°ä½œç”¨åŸŸä¸­çš„å˜é‡çš„å‡½æ•°ã€‚<br>MDNï¼šä¸€ä¸ªå‡½æ•°å’Œå¯¹å…¶å‘¨å›´çŠ¶æ€çš„å¼•ç”¨æ†ç»‘åœ¨ä¸€èµ·ï¼ˆæˆ–è€…è¯´å‡½æ•°è¢«å¼•ç”¨åŒ…å›´ï¼‰ï¼Œè¿™æ ·çš„ç»„åˆå°±æ˜¯é—­åŒ…ï¼ˆclosureï¼‰ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œé—­åŒ…è®©ä½ å¯ä»¥åœ¨ä¸€ä¸ªå†…å±‚å‡½æ•°ä¸­è®¿é—®åˆ°å…¶å¤–å±‚å‡½æ•°çš„ä½œç”¨åŸŸã€‚</p>
</blockquote>
<h4 id="é—­åŒ…åŸºæœ¬æ¦‚å¿µ"><a href="#é—­åŒ…åŸºæœ¬æ¦‚å¿µ" class="headerlink" title="é—­åŒ…åŸºæœ¬æ¦‚å¿µ"></a>é—­åŒ…åŸºæœ¬æ¦‚å¿µ</h4><p>é€šä¿—åœ°è®²è§£ä¸€ä¸‹ï¼šé—­åŒ…å…¶å®å°±æ˜¯ä¸€ä¸ªå¯ä»¥è®¿é—®å…¶ä»–å‡½æ•°å†…éƒ¨å˜é‡çš„å‡½æ•°ã€‚å³ä¸€ä¸ªå®šä¹‰åœ¨å‡½æ•°å†…éƒ¨çš„å‡½æ•°ï¼Œæˆ–è€…ç›´æ¥è¯´é—­åŒ…æ˜¯ä¸ªå†…åµŒå‡½æ•°ä¹Ÿå¯ä»¥ã€‚ï¼ˆå‡½æ•° A è¿”å›äº†ä¸€ä¸ªå‡½æ•° Bï¼Œå¹¶ä¸”å‡½æ•° B ä¸­ä½¿ç”¨äº†å‡½æ•° A çš„å˜é‡ï¼Œå‡½æ•° B å°±è¢«ç§°ä¸ºé—­åŒ…ã€‚ï¼‰<br>å› ä¸ºé€šå¸¸æƒ…å†µä¸‹ï¼Œå‡½æ•°å†…éƒ¨å˜é‡æ˜¯æ— æ³•åœ¨å¤–éƒ¨è®¿é—®çš„ï¼ˆå³å…¨å±€å˜é‡å’Œå±€éƒ¨å˜é‡çš„åŒºåˆ«ï¼‰ï¼Œå› æ­¤ä½¿ç”¨é—­åŒ…çš„ä½œç”¨ï¼Œå°±å…·å¤‡å®ç°äº†èƒ½åœ¨å¤–éƒ¨è®¿é—®æŸä¸ªå‡½æ•°å†…éƒ¨å˜é‡çš„åŠŸèƒ½ï¼Œè®©è¿™äº›å†…éƒ¨å˜é‡çš„å€¼å§‹ç»ˆå¯ä»¥ä¿å­˜åœ¨å†…å­˜ä¸­ã€‚ä¸‹é¢æˆ‘ä»¬é€šè¿‡ä»£ç å…ˆæ¥çœ‹ä¸€ä¸ªç®€å•çš„ä¾‹å­ã€‚</p>
<figure class="highlight arcade"><table><tr><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">fun1</span>(<span class="params"></span>) &#123;</span><br><span class="line">	<span class="keyword">var</span> a = <span class="number">1</span>;</span><br><span class="line">	<span class="keyword">return</span> <span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">		<span class="built_in">console</span>.<span class="built_in">log</span>(a);</span><br><span class="line">	&#125;;</span><br><span class="line">&#125;</span><br><span class="line">fun1();</span><br><span class="line"><span class="keyword">var</span> result = fun1();</span><br><span class="line">result();  <span class="comment">// 1</span></span><br></pre></td></tr></table></figure>
<h4 id="é—­åŒ…çš„è¡¨ç°å½¢å¼"><a href="#é—­åŒ…çš„è¡¨ç°å½¢å¼" class="headerlink" title="é—­åŒ…çš„è¡¨ç°å½¢å¼"></a>é—­åŒ…çš„è¡¨ç°å½¢å¼</h4><ul>
<li>è¿”å›ä¸€ä¸ªå‡½æ•°</li>
<li>åœ¨å®šæ—¶å™¨ã€äº‹ä»¶ç›‘å¬ã€Ajax è¯·æ±‚ã€Web Workers æˆ–è€…ä»»ä½•å¼‚æ­¥ä¸­ï¼Œåªè¦ä½¿ç”¨äº†å›è°ƒå‡½æ•°ï¼Œå®é™…ä¸Šå°±æ˜¯åœ¨ä½¿ç”¨é—­åŒ…ã€‚è¯·çœ‹ä¸‹é¢è¿™æ®µä»£ç ï¼Œè¿™äº›éƒ½æ˜¯å¹³å¸¸å¼€å‘ä¸­ç”¨åˆ°çš„å½¢å¼ã€‚<figure class="highlight arcade"><table><tr><td class="code"><pre><span class="line"><span class="comment">// å®šæ—¶å™¨</span></span><br><span class="line">setTimeout(<span class="keyword">function</span> <span class="title function_">handler</span>(<span class="params"></span>)&#123;</span><br><span class="line">  <span class="built_in">console</span>.<span class="built_in">log</span>(<span class="string">&#x27;1&#x27;</span>);</span><br><span class="line">&#125;ï¼Œ<span class="number">1000</span>);</span><br><span class="line"><span class="comment">// äº‹ä»¶ç›‘å¬</span></span><br><span class="line">$(<span class="string">&#x27;#app&#x27;</span>).click(<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">  <span class="built_in">console</span>.<span class="built_in">log</span>(<span class="string">&#x27;Event Listener&#x27;</span>);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></li>
<li>ä½œä¸ºå‡½æ•°å‚æ•°ä¼ é€’çš„å½¢å¼<figure class="highlight arcade"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> a = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">foo</span>(<span class="params"></span>)&#123;</span><br><span class="line">  <span class="keyword">var</span> a = <span class="number">2</span>;</span><br><span class="line">  <span class="keyword">function</span> <span class="title function_">baz</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="built_in">console</span>.<span class="built_in">log</span>(a);</span><br><span class="line">  &#125;</span><br><span class="line">  bar(baz);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">bar</span>(<span class="params">fn</span>)&#123;</span><br><span class="line">  <span class="comment">// è¿™å°±æ˜¯é—­åŒ…</span></span><br><span class="line">  fn();</span><br><span class="line">&#125;</span><br><span class="line">foo();  <span class="comment">// è¾“å‡º2ï¼Œè€Œä¸æ˜¯1</span></span><br></pre></td></tr></table></figure></li>
<li>IIFEï¼ˆç«‹å³æ‰§è¡Œå‡½æ•°ï¼‰ï¼Œåˆ›å»ºäº†é—­åŒ…ï¼Œä¿å­˜äº†å…¨å±€ä½œç”¨åŸŸï¼ˆwindowï¼‰å’Œå½“å‰å‡½æ•°çš„ä½œç”¨åŸŸï¼Œå› æ­¤å¯ä»¥è¾“å‡ºå…¨å±€çš„å˜é‡<figure class="highlight arcade"><table><tr><td class="code"><pre><span class="line"><span class="keyword">var</span> a = <span class="number">2</span>;</span><br><span class="line">(<span class="keyword">function</span> <span class="title function_">IIFE</span>(<span class="params"></span>)&#123;</span><br><span class="line">  <span class="built_in">console</span>.<span class="built_in">log</span>(a);  <span class="comment">// è¾“å‡º2</span></span><br><span class="line">&#125;)();</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h4 id="å¾ªç¯ä¸­ä½¿ç”¨é—­åŒ…è§£å†³-var-å®šä¹‰å‡½æ•°çš„é—®é¢˜"><a href="#å¾ªç¯ä¸­ä½¿ç”¨é—­åŒ…è§£å†³-var-å®šä¹‰å‡½æ•°çš„é—®é¢˜" class="headerlink" title="å¾ªç¯ä¸­ä½¿ç”¨é—­åŒ…è§£å†³ var å®šä¹‰å‡½æ•°çš„é—®é¢˜"></a>å¾ªç¯ä¸­ä½¿ç”¨é—­åŒ…è§£å†³ var å®šä¹‰å‡½æ•°çš„é—®é¢˜</h4><figure class="highlight stylus"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="title">for</span><span class="params">(var i = <span class="number">1</span>; i &lt;= <span class="number">5</span>; i ++)</span></span>&#123;</span><br><span class="line">  <span class="built_in">setTimeout</span>(<span class="built_in">function</span>() &#123;</span><br><span class="line">    console<span class="selector-class">.log</span>(i)</span><br><span class="line">  &#125;, <span class="number">0</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ä»æ§åˆ¶å°æ‰§è¡Œçš„ç»“æœå¯ä»¥çœ‹å‡ºæ¥ï¼Œç»“æœè¾“å‡ºçš„æ˜¯ 5 ä¸ª 6ï¼Œé‚£ä¹ˆä¸ºä»€ä¹ˆéƒ½æ˜¯ 6 ï¼Ÿ</p>
<blockquote>
<p>1.setTimeout ä¸ºå®ä»»åŠ¡ï¼Œç”±äº JS ä¸­å•çº¿ç¨‹ eventLoop æœºåˆ¶ï¼Œåœ¨ä¸»çº¿ç¨‹åŒæ­¥ä»»åŠ¡æ‰§è¡Œå®Œåæ‰å»æ‰§è¡Œå®ä»»åŠ¡ï¼Œå› æ­¤å¾ªç¯ç»“æŸå setTimeout ä¸­çš„å›è°ƒæ‰ä¾æ¬¡æ‰§è¡Œã€‚<br>2.å› ä¸º setTimeout å‡½æ•°ä¹Ÿæ˜¯ä¸€ç§é—­åŒ…ï¼Œå¾€ä¸Šæ‰¾å®ƒçš„çˆ¶çº§ä½œç”¨åŸŸé“¾å°±æ˜¯ windowï¼Œå˜é‡ i ä¸º window ä¸Šçš„å…¨å±€å˜é‡ï¼Œå¼€å§‹æ‰§è¡Œ setTimeout ä¹‹å‰å˜é‡ i å·²ç»å°±æ˜¯ 6 äº†ï¼Œå› æ­¤æœ€åè¾“å‡ºçš„è¿ç»­å°±éƒ½æ˜¯ 6ã€‚</p>
</blockquote>
<h5 id="å¦‚ä½•å®ç°è¾“å‡º1-2-3-4-5ï¼Ÿ"><a href="#å¦‚ä½•å®ç°è¾“å‡º1-2-3-4-5ï¼Ÿ" class="headerlink" title="å¦‚ä½•å®ç°è¾“å‡º1,2,3,4,5ï¼Ÿ"></a>å¦‚ä½•å®ç°è¾“å‡º1,2,3,4,5ï¼Ÿ</h5><ul>
<li>åˆ©ç”¨ IIFEï¼ˆç«‹å³æ‰§è¡Œå‡½æ•°ï¼‰<figure class="highlight arcade"><table><tr><td class="code"><pre><span class="line"><span class="keyword">for</span>(<span class="keyword">var</span> i = <span class="number">1</span>;i &lt;= <span class="number">5</span>;i++)&#123;</span><br><span class="line">  (<span class="keyword">function</span>(<span class="params">j</span>)&#123;</span><br><span class="line">    setTimeout(<span class="keyword">function</span> <span class="title function_">timer</span>(<span class="params"></span>)&#123;</span><br><span class="line">      <span class="built_in">console</span>.<span class="built_in">log</span>(j)</span><br><span class="line">    &#125;, <span class="number">0</span>)</span><br><span class="line">  &#125;)(i)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
å½“æ¯æ¬¡ for å¾ªç¯æ—¶ï¼ŒæŠŠæ­¤æ—¶çš„å˜é‡ i ä¼ é€’åˆ°å®šæ—¶å™¨ä¸­ï¼Œç„¶åæ‰§è¡Œï¼Œæ”¹é€ ä¹‹åçš„ä»£ç å¦‚ä¸‹ã€‚</li>
<li>ä½¿ç”¨ ES6 ä¸­çš„ let<figure class="highlight javascript"><table><tr><td class="code"><pre><span class="line"><span class="keyword">for</span>(<span class="keyword">let</span> i = <span class="number">1</span>; i &lt;= <span class="number">5</span>; i++)&#123;</span><br><span class="line">  <span class="built_in">setTimeout</span>(<span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(i);</span><br><span class="line">  &#125;,<span class="number">0</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
ES6 ä¸­æ–°å¢çš„ let å®šä¹‰å˜é‡çš„æ–¹å¼ï¼Œä½¿å¾— ES6 ä¹‹å JS å‘ç”Ÿé©å‘½æ€§çš„å˜åŒ–ï¼Œè®© JS æœ‰äº†å—çº§ä½œç”¨åŸŸï¼Œä»£ç çš„ä½œç”¨åŸŸä»¥å—çº§ä¸ºå•ä½è¿›è¡Œæ‰§è¡Œ</li>
<li>å®šæ—¶å™¨ä¼ å…¥ç¬¬ä¸‰ä¸ªå‚æ•°<figure class="highlight stylus"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="title">for</span><span class="params">(var i=<span class="number">1</span>;i&lt;=<span class="number">5</span>;i++)</span></span>&#123;</span><br><span class="line">  <span class="built_in">setTimeout</span>(<span class="built_in">function</span>(j) &#123;</span><br><span class="line">    console<span class="selector-class">.log</span>(j)</span><br><span class="line">  &#125;, <span class="number">0</span>, i)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
setTimeout ä½œä¸ºç»å¸¸ä½¿ç”¨çš„å®šæ—¶å™¨ï¼Œå®ƒæ˜¯å­˜åœ¨ç¬¬ä¸‰ä¸ªå‚æ•°çš„ï¼Œæ—¥å¸¸å·¥ä½œä¸­æˆ‘ä»¬ç»å¸¸ä½¿ç”¨çš„ä¸€èˆ¬æ˜¯å‰ä¸¤ä¸ªï¼Œä¸€ä¸ªæ˜¯å›è°ƒå‡½æ•°ï¼Œå¦å¤–ä¸€ä¸ªæ˜¯æ—¶é—´ï¼Œè€Œç¬¬ä¸‰ä¸ªå‚æ•°ç”¨å¾—æ¯”è¾ƒå°‘ã€‚é‚£ä¹ˆç»“åˆç¬¬ä¸‰ä¸ªå‚æ•°ï¼Œè°ƒæ•´å®Œä¹‹åçš„ä»£ç å¦‚ä¸‹ã€‚<figure class="highlight stylus"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="title">for</span><span class="params">(var i=<span class="number">1</span>;i&lt;=<span class="number">5</span>;i++)</span></span>&#123;</span><br><span class="line">  <span class="built_in">setTimeout</span>(<span class="built_in">function</span>(j) &#123;</span><br><span class="line">    console<span class="selector-class">.log</span>(j)</span><br><span class="line">  &#125;, <span class="number">0</span>, i)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
ä»ä¸­å¯ä»¥çœ‹åˆ°ï¼Œç¬¬ä¸‰ä¸ªå‚æ•°çš„ä¼ é€’ï¼Œå¯ä»¥æ”¹å˜ setTimeout çš„æ‰§è¡Œé€»è¾‘ï¼Œä»è€Œå®ç°æˆ‘ä»¬æƒ³è¦çš„ç»“æœï¼Œè¿™ä¹Ÿæ˜¯ä¸€ç§è§£å†³å¾ªç¯è¾“å‡ºé—®é¢˜çš„é€”å¾„ã€‚</li>
</ul>
<h3 id="JSON-stringify"><a href="#JSON-stringify" class="headerlink" title="JSON.stringify"></a>JSON.stringify</h3><p>â€”â€”â€”â€”â€”â€” è¯¥ç¯‡æ–‡ç« ç»§ç»­å­¦ä¹ ä¸­ï¼Œæœªå®Œå¾…ç»­ â€”â€”â€”â€”â€”â€”</p>
]]></content>
      <categories>
        <category>webå‰ç«¯</category>
      </categories>
      <tags>
        <tag>javascript</tag>
      </tags>
  </entry>
</search>
